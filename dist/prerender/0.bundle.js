exports.ids=[0],exports.modules={40:function(t,e){const n=/[&<>"']/,r=/[&<>"']/g,i=/[<>"']|&(?!#?\w+;)/,o=/[<>"']|&(?!#?\w+;)/g,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},s=t=>a[t];const u=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function c(t){return t.replace(u,(t,e)=>"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):"")}const h=/(^|[^\[])\^/g;const l=/[^\w:]/g,f=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;const p={},d=/^[^:]+:\/*[^/]*$/,m=/^([^:]+:)[\s\S]*$/,g=/^([^:]+:\/*[^/]*)[\s\S]*$/;function y(t,e){p[" "+t]||(d.test(t)?p[" "+t]=t+"/":p[" "+t]=v(t,"/",!0));const n=-1===(t=p[" "+t]).indexOf(":");return"//"===e.substring(0,2)?n?e:t.replace(m,"$1")+e:"/"===e.charAt(0)?n?e:t.replace(g,"$1")+e:t+e}function v(t,e,n){const r=t.length;if(0===r)return"";let i=0;for(;i<r;){const o=t.charAt(r-i-1);if(o!==e||n){if(o===e||!n)break;i++}else i++}return t.substr(0,r-i)}t.exports={escape:function(t,e){if(e){if(n.test(t))return t.replace(r,s)}else if(i.test(t))return t.replace(o,s);return t},unescape:c,edit:function(t,e){t=t.source||t,e=e||"";const n={replace:(e,r)=>(r=(r=r.source||r).replace(h,"$1"),t=t.replace(e,r),n),getRegex:()=>new RegExp(t,e)};return n},cleanUrl:function(t,e,n){if(t){let t;try{t=decodeURIComponent(c(n)).replace(l,"").toLowerCase()}catch(t){return null}if(0===t.indexOf("javascript:")||0===t.indexOf("vbscript:")||0===t.indexOf("data:"))return null}e&&!f.test(n)&&(n=y(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(t){return null}return n},resolveUrl:y,noopTest:{exec:function(){}},merge:function(t){let e,n,r=1;for(;r<arguments.length;r++)for(n in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},splitCells:function(t,e){const n=t.replace(/\|/g,(t,e,n)=>{let r=!1,i=e;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/);let r=0;if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n},rtrim:v,findClosingBracket:function(t,e){if(-1===t.indexOf(e[1]))return-1;const n=t.length;let r=0,i=0;for(;i<n;i++)if("\\"===t[i])i++;else if(t[i]===e[0])r++;else if(t[i]===e[1]&&(r--,r<0))return i;return-1},checkSanitizeDeprecation:function(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}}},41:function(t,e){function n(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,xhtml:!1}}t.exports={defaults:{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,xhtml:!1},getDefaults:n,changeDefaults:function(e){t.exports.defaults=e}}},42:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var r=JSON.parse('{\n\t"apiKey": "AIzaSyDZpNEsHUILTJSJixyoGzaB04K8Kcp6CPU",\n\t"authDomain": "remtori.firebaseapp.com",\n\t"databaseURL": "https://remtori.firebaseio.com",\n\t"projectId": "remtori",\n\t"storageBucket": "remtori.appspot.com",\n\t"messagingSenderId": "65013389724",\n\t"appId": "1:65013389724:web:bf3e07dfb003f314"\n}'),i=function(t){return"https://storage.googleapis.com/".concat(r.storageBucket,"/").concat(t)}},43:function(t,e,n){const{defaults:r}=n(41),{cleanUrl:i,escape:o}=n(40);t.exports=class{constructor(t){this.options=t||r}code(t,e,n){const r=(e||"").match(/\S*/)[0];if(this.options.highlight){const e=this.options.highlight(t,r);null!=e&&e!==t&&(n=!0,t=e)}return r?'<pre><code class="'+this.options.langPrefix+o(r,!0)+'">'+(n?t:o(t,!0))+"</code></pre>\n":"<pre><code>"+(n?t:o(t,!0))+"</code></pre>"}blockquote(t){return"<blockquote>\n"+t+"</blockquote>\n"}html(t){return t}heading(t,e,n,r){return this.options.headerIds?"<h"+e+' id="'+this.options.headerPrefix+r.slug(n)+'">'+t+"</h"+e+">\n":"<h"+e+">"+t+"</h"+e+">\n"}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(t,e,n){const r=e?"ol":"ul";return"<"+r+(e&&1!==n?' start="'+n+'"':"")+">\n"+t+"</"+r+">\n"}listitem(t){return"<li>"+t+"</li>\n"}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return"<p>"+t+"</p>\n"}table(t,e){return e&&(e="<tbody>"+e+"</tbody>"),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"}tablerow(t){return"<tr>\n"+t+"</tr>\n"}tablecell(t,e){const n=e.header?"th":"td";return(e.align?"<"+n+' align="'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"}strong(t){return"<strong>"+t+"</strong>"}em(t){return"<em>"+t+"</em>"}codespan(t){return"<code>"+t+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return"<del>"+t+"</del>"}link(t,e,n){if(null===(t=i(this.options.sanitize,this.options.baseUrl,t)))return n;let r='<a href="'+o(t)+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>",r}image(t,e,n){if(null===(t=i(this.options.sanitize,this.options.baseUrl,t)))return n;let r='<img src="'+t+'" alt="'+n+'"';return e&&(r+=' title="'+e+'"'),r+=this.options.xhtml?"/>":">",r}text(t){return t}}},46:function(t,e,n){const{noopTest:r,edit:i,merge:o}=n(40),a={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}|~{3,})([^`~\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:r,table:r,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};a.def=i(a.def).replace("label",a._label).replace("title",a._title).getRegex(),a.bullet=/(?:[*+-]|\d{1,9}\.)/,a.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,a.item=i(a.item,"gm").replace(/bull/g,a.bullet).getRegex(),a.list=i(a.list).replace(/bull/g,a.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+a.def.source+")").getRegex(),a._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",a._comment=/<!--(?!-?>)[\s\S]*?-->/,a.html=i(a.html,"i").replace("comment",a._comment).replace("tag",a._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),a.paragraph=i(a._paragraph).replace("hr",a.hr).replace("heading"," {0,3}#{1,6} +").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}|~{3,})[^`\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",a._tag).getRegex(),a.blockquote=i(a.blockquote).replace("paragraph",a.paragraph).getRegex(),a.normal=o({},a),a.gfm=o({},a.normal,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),a.pedantic=o({},a.normal,{html:i("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",a._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:r,paragraph:i(a.normal._paragraph).replace("hr",a.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",a.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const s={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:r,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s_])__(?!_)|^\*\*([^\s*])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*<\[])\*(?!\*)|^_([^\s<][\s\S]*?[^\s_])_(?!_|[^\spunctuation])|^_([^\s_<][\s\S]*?[^\s])_(?!_|[^\spunctuation])|^\*([^\s<"][\s\S]*?[^\s\*])\*(?!\*|[^\spunctuation])|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:r,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/,_punctuation:"!\"#$%&'()*+,\\-./:;<=>?@\\[^_{|}~"};s.em=i(s.em).replace(/punctuation/g,s._punctuation).getRegex(),s._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,s._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,s._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,s.autolink=i(s.autolink).replace("scheme",s._scheme).replace("email",s._email).getRegex(),s._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,s.tag=i(s.tag).replace("comment",a._comment).replace("attribute",s._attribute).getRegex(),s._label=/(?:\[[^\[\]]*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,s._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,s._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,s.link=i(s.link).replace("label",s._label).replace("href",s._href).replace("title",s._title).getRegex(),s.reflink=i(s.reflink).replace("label",s._label).getRegex(),s.normal=o({},s),s.pedantic=o({},s.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:i(/^!?\[(label)\]\((.*?)\)/).replace("label",s._label).getRegex(),reflink:i(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",s._label).getRegex()}),s.gfm=o({},s.normal,{escape:i(s.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),s.gfm.url=i(s.gfm.url,"i").replace("email",s.gfm._extended_email).getRegex(),s.breaks=o({},s.gfm,{br:i(s.br).replace("{2,}","*").getRegex(),text:i(s.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),t.exports={block:a,inline:s}},47:function(t,e){t.exports=class{constructor(){this.seen={}}slug(t){let e=t.toLowerCase().trim().replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(e)){const t=e;do{this.seen[t]++,e=t+"-"+this.seen[t]}while(this.seen.hasOwnProperty(e))}return this.seen[e]=0,e}}},48:function(t,e,n){const r=n(43),{defaults:i}=n(41),{inline:o}=n(46),{findClosingBracket:a,escape:s}=n(40);t.exports=class t{constructor(t,e){if(this.options=e||i,this.links=t,this.rules=o.normal,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=o.pedantic:this.options.gfm&&(this.options.breaks?this.rules=o.breaks:this.rules=o.gfm)}static get rules(){return o}static output(e,n,r){return new t(n,r).output(e)}output(e){let n,r,i,o,u,c,h="";for(;e;)if(u=this.rules.escape.exec(e))e=e.substring(u[0].length),h+=s(u[1]);else if(u=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(u[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(u[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(u[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(u[0])&&(this.inRawBlock=!1),e=e.substring(u[0].length),h+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):s(u[0]):u[0];else if(u=this.rules.link.exec(e)){const r=a(u[2],"()");if(r>-1){const t=(0===u[0].indexOf("!")?5:4)+u[1].length+r;u[2]=u[2].substring(0,r),u[0]=u[0].substring(0,t).trim(),u[3]=""}e=e.substring(u[0].length),this.inLink=!0,i=u[2],this.options.pedantic?(n=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i),n?(i=n[1],o=n[3]):o=""):o=u[3]?u[3].slice(1,-1):"",i=i.trim().replace(/^<([\s\S]*)>$/,"$1"),h+=this.outputLink(u,{href:t.escapes(i),title:t.escapes(o)}),this.inLink=!1}else if((u=this.rules.reflink.exec(e))||(u=this.rules.nolink.exec(e))){if(e=e.substring(u[0].length),n=(u[2]||u[1]).replace(/\s+/g," "),n=this.links[n.toLowerCase()],!n||!n.href){h+=u[0].charAt(0),e=u[0].substring(1)+e;continue}this.inLink=!0,h+=this.outputLink(u,n),this.inLink=!1}else if(u=this.rules.strong.exec(e))e=e.substring(u[0].length),h+=this.renderer.strong(this.output(u[4]||u[3]||u[2]||u[1]));else if(u=this.rules.em.exec(e))e=e.substring(u[0].length),h+=this.renderer.em(this.output(u[6]||u[5]||u[4]||u[3]||u[2]||u[1]));else if(u=this.rules.code.exec(e))e=e.substring(u[0].length),h+=this.renderer.codespan(s(u[2].trim(),!0));else if(u=this.rules.br.exec(e))e=e.substring(u[0].length),h+=this.renderer.br();else if(u=this.rules.del.exec(e))e=e.substring(u[0].length),h+=this.renderer.del(this.output(u[1]));else if(u=this.rules.autolink.exec(e))e=e.substring(u[0].length),"@"===u[2]?(r=s(this.mangle(u[1])),i="mailto:"+r):(r=s(u[1]),i=r),h+=this.renderer.link(i,null,r);else if(this.inLink||!(u=this.rules.url.exec(e))){if(u=this.rules.text.exec(e))e=e.substring(u[0].length),this.inRawBlock?h+=this.renderer.text(this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):s(u[0]):u[0]):h+=this.renderer.text(s(this.smartypants(u[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===u[2])r=s(u[0]),i="mailto:"+r;else{do{c=u[0],u[0]=this.rules._backpedal.exec(u[0])[0]}while(c!==u[0]);r=s(u[0]),i="www."===u[1]?"http://"+r:r}e=e.substring(u[0].length),h+=this.renderer.link(i,null,r)}return h}static escapes(e){return e?e.replace(t.rules._escapes,"$1"):e}outputLink(t,e){const n=e.href,r=e.title?s(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,r,this.output(t[1])):this.renderer.image(n,r,s(t[1]))}smartypants(t){return this.options.smartypants?t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t}mangle(t){if(!this.options.mangle)return t;const e=t.length;let n,r="",i=0;for(;i<e;i++)n=t.charCodeAt(i),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}}},49:function(t,e){t.exports=class{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}}},50:function(t,e,n){t.exports=JSON.parse('{"loginBtn":"_2JBd","editor":"_1vLE"}')},53:function(t,e,n){const r=n(54),i=n(55),o=n(43),a=n(49),s=n(48),u=n(47),{merge:c,checkSanitizeDeprecation:h,escape:l}=n(40),{getDefaults:f,changeDefaults:p,defaults:d}=n(41);function m(t,e,n){if(null==t)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof t)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if(n||"function"==typeof e){n||(n=e,e=null),e=c({},m.defaults,e||{}),h(e);const o=e.highlight;let a,s,u=0;try{a=r.lex(t,e)}catch(t){return n(t)}s=a.length;const l=function(t){if(t)return e.highlight=o,n(t);let r;try{r=i.parse(a,e)}catch(e){t=e}return e.highlight=o,t?n(t):n(null,r)};if(!o||o.length<3)return l();if(delete e.highlight,!s)return l();for(;u<a.length;u++)!function(t){"code"!==t.type?--s||l():o(t.text,t.lang,(function(e,n){return e?l(e):null==n||n===t.text?--s||l():(t.text=n,t.escaped=!0,void(--s||l()))}))}(a[u])}else try{return e=c({},m.defaults,e||{}),h(e),i.parse(r.lex(t,e),e)}catch(t){if(t.message+="\nPlease report this to https://github.com/markedjs/marked.",(e||m.defaults).silent)return"<p>An error occurred:</p><pre>"+l(t.message+"",!0)+"</pre>";throw t}}m.options=m.setOptions=function(t){return c(m.defaults,t),p(m.defaults),m},m.getDefaults=f,m.defaults=d,m.Parser=i,m.parser=i.parse,m.Renderer=o,m.TextRenderer=a,m.Lexer=r,m.lexer=r.lex,m.InlineLexer=s,m.inlineLexer=s.output,m.Slugger=u,m.parse=m,t.exports=m},54:function(t,e,n){const{defaults:r}=n(41),{block:i}=n(46),{rtrim:o,splitCells:a,escape:s}=n(40);t.exports=class t{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||r,this.rules=i.normal,this.options.pedantic?this.rules=i.pedantic:this.options.gfm&&(this.rules=i.gfm)}static get rules(){return i}static lex(e,n){return new t(n).lex(e)}lex(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.token(t,!0)}token(t,e){let n,r,u,c,h,l,f,p,d,m,g,y,v,b,w,T;for(t=t.replace(/^ +$/gm,"");t;)if((u=this.rules.newline.exec(t))&&(t=t.substring(u[0].length),u[0].length>1&&this.tokens.push({type:"space"})),u=this.rules.code.exec(t)){const e=this.tokens[this.tokens.length-1];t=t.substring(u[0].length),e&&"paragraph"===e.type?e.text+="\n"+u[0].trimRight():(u=u[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",codeBlockStyle:"indented",text:this.options.pedantic?u:o(u,"\n")}))}else if(u=this.rules.fences.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"code",lang:u[2]?u[2].trim():u[2],text:u[3]||""});else if(u=this.rules.heading.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"heading",depth:u[1].length,text:u[2]});else if((u=this.rules.nptable.exec(t))&&(l={type:"table",header:a(u[1].replace(/^ *| *\| *$/g,"")),align:u[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:u[3]?u[3].replace(/\n$/,"").split("\n"):[]},l.header.length===l.align.length)){for(t=t.substring(u[0].length),g=0;g<l.align.length;g++)/^ *-+: *$/.test(l.align[g])?l.align[g]="right":/^ *:-+: *$/.test(l.align[g])?l.align[g]="center":/^ *:-+ *$/.test(l.align[g])?l.align[g]="left":l.align[g]=null;for(g=0;g<l.cells.length;g++)l.cells[g]=a(l.cells[g],l.header.length);this.tokens.push(l)}else if(u=this.rules.hr.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"hr"});else if(u=this.rules.blockquote.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"blockquote_start"}),u=u[0].replace(/^ *> ?/gm,""),this.token(u,e),this.tokens.push({type:"blockquote_end"});else if(u=this.rules.list.exec(t)){for(t=t.substring(u[0].length),c=u[2],b=c.length>1,f={type:"list_start",ordered:b,start:b?+c:"",loose:!1},this.tokens.push(f),u=u[0].match(this.rules.item),p=[],n=!1,v=u.length,g=0;g<v;g++)l=u[g],m=l.length,l=l.replace(/^ *([*+-]|\d+\.) */,""),~l.indexOf("\n ")&&(m-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+m+"}","gm"),"")),g!==v-1&&(h=i.bullet.exec(u[g+1])[0],(c.length>1?1===h.length:h.length>1||this.options.smartLists&&h!==c)&&(t=u.slice(g+1).join("\n")+t,g=v-1)),r=n||/\n\n(?!\s*$)/.test(l),g!==v-1&&(n="\n"===l.charAt(l.length-1),r||(r=n)),r&&(f.loose=!0),w=/^\[[ xX]\] /.test(l),T=void 0,w&&(T=" "!==l[1],l=l.replace(/^\[[ xX]\] +/,"")),d={type:"list_item_start",task:w,checked:T,loose:r},p.push(d),this.tokens.push(d),this.token(l,!1),this.tokens.push({type:"list_item_end"});if(f.loose)for(v=p.length,g=0;g<v;g++)p[g].loose=!0;this.tokens.push({type:"list_end"})}else if(u=this.rules.html.exec(t))t=t.substring(u[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===u[1]||"script"===u[1]||"style"===u[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(u[0]):s(u[0]):u[0]});else if(e&&(u=this.rules.def.exec(t)))t=t.substring(u[0].length),u[3]&&(u[3]=u[3].substring(1,u[3].length-1)),y=u[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[y]||(this.tokens.links[y]={href:u[2],title:u[3]});else if((u=this.rules.table.exec(t))&&(l={type:"table",header:a(u[1].replace(/^ *| *\| *$/g,"")),align:u[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:u[3]?u[3].replace(/\n$/,"").split("\n"):[]},l.header.length===l.align.length)){for(t=t.substring(u[0].length),g=0;g<l.align.length;g++)/^ *-+: *$/.test(l.align[g])?l.align[g]="right":/^ *:-+: *$/.test(l.align[g])?l.align[g]="center":/^ *:-+ *$/.test(l.align[g])?l.align[g]="left":l.align[g]=null;for(g=0;g<l.cells.length;g++)l.cells[g]=a(l.cells[g].replace(/^ *\| *| *\| *$/g,""),l.header.length);this.tokens.push(l)}else if(u=this.rules.lheading.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"heading",depth:"="===u[2].charAt(0)?1:2,text:u[1]});else if(e&&(u=this.rules.paragraph.exec(t)))t=t.substring(u[0].length),this.tokens.push({type:"paragraph",text:"\n"===u[1].charAt(u[1].length-1)?u[1].slice(0,-1):u[1]});else if(u=this.rules.text.exec(t))t=t.substring(u[0].length),this.tokens.push({type:"text",text:u[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens}}},55:function(t,e,n){const r=n(43),i=n(47),o=n(48),a=n(49),{defaults:s}=n(41),{merge:u,unescape:c}=n(40);t.exports=class t{constructor(t){this.tokens=[],this.token=null,this.options=t||s,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options,this.slugger=new i}static parse(e,n){return new t(n).parse(e)}parse(t){this.inline=new o(t.links,this.options),this.inlineText=new o(t.links,u({},this.options,{renderer:new a})),this.tokens=t.reverse();let e="";for(;this.next();)e+=this.tok();return e}next(){return this.token=this.tokens.pop(),this.token}peek(){return this.tokens[this.tokens.length-1]||0}parseText(){let t=this.token.text;for(;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)}tok(){let t="";switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,c(this.inlineText.output(this.token.text)),this.slugger);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":{let e,n,r,i,o="";for(r="",e=0;e<this.token.header.length;e++)r+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(r),e=0;e<this.token.cells.length;e++){for(n=this.token.cells[e],r="",i=0;i<n.length;i++)r+=this.renderer.tablecell(this.inline.output(n[i]),{header:!1,align:this.token.align[i]});t+=this.renderer.tablerow(r)}return this.renderer.table(o,t)}case"blockquote_start":for(t="";"blockquote_end"!==this.next().type;)t+=this.tok();return this.renderer.blockquote(t);case"list_start":{t="";const e=this.token.ordered,n=this.token.start;for(;"list_end"!==this.next().type;)t+=this.tok();return this.renderer.list(t,e,n)}case"list_item_start":{t="";const e=this.token.loose,n=this.token.checked,r=this.token.task;if(this.token.task)if(e)if("text"===this.peek().type){const t=this.peek();t.text=this.renderer.checkbox(n)+" "+t.text}else this.tokens.push({type:"text",text:this.renderer.checkbox(n)});else t+=this.renderer.checkbox(n);for(;"list_item_end"!==this.next().type;)t+=e||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(t,r,n)}case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText());default:{const t='Token with "'+this.token.type+'" type was not found.';if(!this.options.silent)throw new Error(t);console.log(t)}}}}},56:function(t,e,n){var r,i,o;i=function(t){var e,n=[],r=Object.keys,i={},o={},a=!0,s=/^(no-?highlight|plain|text)$/i,u=/\blang(?:uage)?-([\w-]+)\b/i,c=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,h="</span>",l="Could not find the language '{}', did you forget to load/include a language module?",f={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},p="of and for in not or if then".split(" ");function d(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(t){return t.nodeName.toLowerCase()}function g(t){return s.test(t)}function y(t){var e,n={},r=Array.prototype.slice.call(arguments,1);for(e in t)n[e]=t[e];return r.forEach((function(t){for(e in t)n[e]=t[e]})),n}function v(t){var e=[];return function t(n,r){for(var i=n.firstChild;i;i=i.nextSibling)3===i.nodeType?r+=i.nodeValue.length:1===i.nodeType&&(e.push({event:"start",offset:r,node:i}),r=t(i,r),m(i).match(/br|hr|img|input/)||e.push({event:"stop",offset:r,node:i}));return r}(t,0),e}function b(t){return t.variants&&!t.cached_variants&&(t.cached_variants=t.variants.map((function(e){return y(t,{variants:null},e)}))),t.cached_variants?t.cached_variants:function t(e){return!!e&&(e.endsWithParent||t(e.starts))}(t)?[y(t,{starts:t.starts?y(t.starts):null})]:Object.isFrozen(t)?[y(t)]:[t]}function w(t){if(e&&!t.langApiRestored){for(var n in t.langApiRestored=!0,e)t[n]&&(t[e[n]]=t[n]);(t.contains||[]).concat(t.variants||[]).forEach(w)}}function T(t,e){return e?Number(e):(n=t,-1!=p.indexOf(n.toLowerCase())?0:1);var n}function E(t){function e(t){return t&&t.source||t}function n(n,r){return new RegExp(e(n),"m"+(t.case_insensitive?"i":"")+(r?"g":""))}function i(t){var r,i,o={},a=[],s={},u=1;function c(t,e){o[u]=t,a.push([t,e]),u+=function(t){return new RegExp(t.toString()+"|").exec("").length-1}(e)+1}for(var h=0;h<t.contains.length;h++)c(i=t.contains[h],i.beginKeywords?"\\.?(?:"+i.begin+")\\.?":i.begin);t.terminator_end&&c("end",t.terminator_end),t.illegal&&c("illegal",t.illegal);var l=a.map((function(t){return t[1]}));return r=n(function(t,n){for(var r=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,i=0,o="",a=0;a<t.length;a++){var s=i+=1,u=e(t[a]);for(a>0&&(o+=n),o+="(";u.length>0;){var c=r.exec(u);if(null==c){o+=u;break}o+=u.substring(0,c.index),u=u.substring(c.index+c[0].length),"\\"==c[0][0]&&c[1]?o+="\\"+String(Number(c[1])+s):(o+=c[0],"("==c[0]&&i++)}o+=")"}return o}(l,"|"),!0),s.lastIndex=0,s.exec=function(e){var n;if(0===a.length)return null;r.lastIndex=s.lastIndex;var i=r.exec(e);if(!i)return null;for(var u=0;u<i.length;u++)if(null!=i[u]&&null!=o[""+u]){n=o[""+u];break}return"string"==typeof n?(i.type=n,i.extra=[t.illegal,t.terminator_end]):(i.type="begin",i.rule=n),i},s}if(t.contains&&-1!=t.contains.indexOf("self")){if(!a)throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");t.contains=t.contains.filter((function(t){return"self"!=t}))}!function o(a,s){a.compiled||(a.compiled=!0,a.keywords=a.keywords||a.beginKeywords,a.keywords&&(a.keywords=function(t,e){var n={};return"string"==typeof t?i("keyword",t):r(t).forEach((function(e){i(e,t[e])})),n;function i(t,r){e&&(r=r.toLowerCase()),r.split(" ").forEach((function(e){var r=e.split("|");n[r[0]]=[t,T(r[0],r[1])]}))}}(a.keywords,t.case_insensitive)),a.lexemesRe=n(a.lexemes||/\w+/,!0),s&&(a.beginKeywords&&(a.begin="\\b("+a.beginKeywords.split(" ").join("|")+")\\b"),a.begin||(a.begin=/\B|\b/),a.beginRe=n(a.begin),a.endSameAsBegin&&(a.end=a.begin),a.end||a.endsWithParent||(a.end=/\B|\b/),a.end&&(a.endRe=n(a.end)),a.terminator_end=e(a.end)||"",a.endsWithParent&&s.terminator_end&&(a.terminator_end+=(a.end?"|":"")+s.terminator_end)),a.illegal&&(a.illegalRe=n(a.illegal)),null==a.relevance&&(a.relevance=1),a.contains||(a.contains=[]),a.contains=Array.prototype.concat.apply([],a.contains.map((function(t){return b("self"===t?a:t)}))),a.contains.forEach((function(t){o(t,a)})),a.starts&&o(a.starts,s),a.terminators=i(a))}(t)}function I(t,e,n,r){function o(t,e){var n=v.case_insensitive?e[0].toLowerCase():e[0];return t.keywords.hasOwnProperty(n)&&t.keywords[n]}function s(t,e,n,r){if(!n&&""===e)return"";if(!t)return e;var i='<span class="'+(r?"":f.classPrefix);return(i+=t+'">')+e+(n?"":h)}function u(){N+=null!=w.subLanguage?function(){var t="string"==typeof w.subLanguage;if(t&&!i[w.subLanguage])return d(A);var e=t?I(w.subLanguage,A,!0,T[w.subLanguage]):S(A,w.subLanguage.length?w.subLanguage:void 0);return w.relevance>0&&(C+=e.relevance),t&&(T[w.subLanguage]=e.top),s(e.language,e.value,!1,!0)}():function(){var t,e,n,r;if(!w.keywords)return d(A);for(r="",e=0,w.lexemesRe.lastIndex=0,n=w.lexemesRe.exec(A);n;)r+=d(A.substring(e,n.index)),(t=o(w,n))?(C+=t[1],r+=s(t[0],d(n[0]))):r+=d(n[0]),e=w.lexemesRe.lastIndex,n=w.lexemesRe.exec(A);return r+d(A.substr(e))}(),A=""}function c(t){N+=t.className?s(t.className,"",!0):"",w=Object.create(t,{parent:{value:w}})}function p(t){var e=t[0],n=t.rule;return n&&n.endSameAsBegin&&(n.endRe=function(t){return new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(e)),n.skip?A+=e:(n.excludeBegin&&(A+=e),u(),n.returnBegin||n.excludeBegin||(A=e)),c(n),n.returnBegin?0:e.length}function m(t){var n=t[0],r=e.substr(t.index),i=function t(e,n){if(function(t,e){var n=t&&t.exec(e);return n&&0===n.index}(e.endRe,n)){for(;e.endsParent&&e.parent;)e=e.parent;return e}if(e.endsWithParent)return t(e.parent,n)}(w,r);if(i){var o=w;o.skip?A+=n:(o.returnEnd||o.excludeEnd||(A+=n),u(),o.excludeEnd&&(A=n));do{w.className&&(N+=h),w.skip||w.subLanguage||(C+=w.relevance),w=w.parent}while(w!==i.parent);return i.starts&&(i.endSameAsBegin&&(i.starts.endRe=i.endRe),c(i.starts)),o.returnEnd?0:n.length}}var g={};function y(t,r){var i=r&&r[0];if(A+=t,null==i)return u(),0;if("begin"==g.type&&"end"==r.type&&g.index==r.index&&""===i)return A+=e.slice(r.index,r.index+1),1;if(g=r,"begin"===r.type)return p(r);if("illegal"===r.type&&!n)throw new Error('Illegal lexeme "'+i+'" for mode "'+(w.className||"<unnamed>")+'"');if("end"===r.type){var o=m(r);if(null!=o)return o}return A+=i,i.length}var v=k(t);if(!v)throw console.error(l.replace("{}",t)),new Error('Unknown language: "'+t+'"');E(v);var b,w=r||v,T={},N="";for(b=w;b!==v;b=b.parent)b.className&&(N=s(b.className,"",!0)+N);var A="",C=0;try{for(var D,_,R=0;w.terminators.lastIndex=R,D=w.terminators.exec(e);)_=y(e.substring(R,D.index),D),R=D.index+_;for(y(e.substr(R)),b=w;b.parent;b=b.parent)b.className&&(N+=h);return{relevance:C,value:N,illegal:!1,language:t,top:w}}catch(n){if(n.message&&-1!==n.message.indexOf("Illegal"))return{illegal:!0,relevance:0,value:d(e)};if(a)return{relevance:0,value:d(e),language:t,top:w,errorRaised:n};throw n}}function S(t,e){e=e||f.languages||r(i);var n={relevance:0,value:d(t)},o=n;return e.filter(k).filter(_).forEach((function(e){var r=I(e,t,!1);r.language=e,r.relevance>o.relevance&&(o=r),r.relevance>n.relevance&&(o=n,n=r)})),o.language&&(n.second_best=o),n}function N(t){return f.tabReplace||f.useBR?t.replace(c,(function(t,e){return f.useBR&&"\n"===t?"<br>":f.tabReplace?e.replace(/\t/g,f.tabReplace):""})):t}function A(t){var e,r,i,a,s,c=function(t){var e,n,r,i,o=t.className+" ";if(o+=t.parentNode?t.parentNode.className:"",n=u.exec(o)){var a=k(n[1]);return a||(console.warn(l.replace("{}",n[1])),console.warn("Falling back to no-highlight mode for this block.",t)),a?n[1]:"no-highlight"}for(e=0,r=(o=o.split(/\s+/)).length;e<r;e++)if(g(i=o[e])||k(i))return i}(t);g(c)||(f.useBR?(e=document.createElement("div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):e=t,s=e.textContent,i=c?I(c,s,!0):S(s),(r=v(e)).length&&((a=document.createElement("div")).innerHTML=i.value,i.value=function(t,e,r){var i=0,o="",a=[];function s(){return t.length&&e.length?t[0].offset!==e[0].offset?t[0].offset<e[0].offset?t:e:"start"===e[0].event?t:e:t.length?t:e}function u(t){o+="<"+m(t)+n.map.call(t.attributes,(function(t){return" "+t.nodeName+'="'+d(t.value).replace(/"/g,"&quot;")+'"'})).join("")+">"}function c(t){o+="</"+m(t)+">"}function h(t){("start"===t.event?u:c)(t.node)}for(;t.length||e.length;){var l=s();if(o+=d(r.substring(i,l[0].offset)),i=l[0].offset,l===t){a.reverse().forEach(c);do{h(l.splice(0,1)[0]),l=s()}while(l===t&&l.length&&l[0].offset===i);a.reverse().forEach(u)}else"start"===l[0].event?a.push(l[0].node):a.pop(),h(l.splice(0,1)[0])}return o+d(r.substr(i))}(r,v(a),s)),i.value=N(i.value),t.innerHTML=i.value,t.className=function(t,e,n){var r=e?o[e]:n,i=[t.trim()];return t.match(/\bhljs\b/)||i.push("hljs"),-1===t.indexOf(r)&&i.push(r),i.join(" ").trim()}(t.className,c,i.language),t.result={language:i.language,re:i.relevance},i.second_best&&(t.second_best={language:i.second_best.language,re:i.second_best.relevance}))}function C(){if(!C.called){C.called=!0;var t=document.querySelectorAll("pre code");n.forEach.call(t,A)}}var D={disableAutodetect:!0};function k(t){return t=(t||"").toLowerCase(),i[t]||i[o[t]]}function _(t){var e=k(t);return e&&!e.disableAutodetect}return t.highlight=I,t.highlightAuto=S,t.fixMarkup=N,t.highlightBlock=A,t.configure=function(t){f=y(f,t)},t.initHighlighting=C,t.initHighlightingOnLoad=function(){window.addEventListener("DOMContentLoaded",C,!1),window.addEventListener("load",C,!1)},t.registerLanguage=function(e,n){var r;try{r=n(t)}catch(t){if(console.error("Language definition for '{}' could not be registered.".replace("{}",e)),!a)throw t;console.error(t),r=D}i[e]=r,w(r),r.rawDefinition=n.bind(null,t),r.aliases&&r.aliases.forEach((function(t){o[t]=e}))},t.listLanguages=function(){return r(i)},t.getLanguage=k,t.requireLanguage=function(t){var e=k(t);if(e)return e;throw new Error("The '{}' language is required, but not loaded.".replace("{}",t))},t.autoDetection=_,t.inherit=y,t.debugMode=function(){a=!1},t.IDENT_RE="[a-zA-Z]\\w*",t.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",t.NUMBER_RE="\\b\\d+(\\.\\d+)?",t.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",t.BINARY_NUMBER_RE="\\b(0b[01]+)",t.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",t.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},t.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},t.COMMENT=function(e,n,r){var i=t.inherit({className:"comment",begin:e,end:n,contains:[]},r||{});return i.contains.push(t.PHRASAL_WORDS_MODE),i.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),i},t.C_LINE_COMMENT_MODE=t.COMMENT("//","$"),t.C_BLOCK_COMMENT_MODE=t.COMMENT("/\\*","\\*/"),t.HASH_COMMENT_MODE=t.COMMENT("#","$"),t.NUMBER_MODE={className:"number",begin:t.NUMBER_RE,relevance:0},t.C_NUMBER_MODE={className:"number",begin:t.C_NUMBER_RE,relevance:0},t.BINARY_NUMBER_MODE={className:"number",begin:t.BINARY_NUMBER_RE,relevance:0},t.CSS_NUMBER_MODE={className:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},t.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[t.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[t.BACKSLASH_ESCAPE]}]},t.TITLE_MODE={className:"title",begin:t.IDENT_RE,relevance:0},t.UNDERSCORE_TITLE_MODE={className:"title",begin:t.UNDERSCORE_IDENT_RE,relevance:0},t.METHOD_GUARD={begin:"\\.\\s*"+t.UNDERSCORE_IDENT_RE,relevance:0},[t.BACKSLASH_ESCAPE,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,t.PHRASAL_WORDS_MODE,t.COMMENT,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,t.HASH_COMMENT_MODE,t.NUMBER_MODE,t.C_NUMBER_MODE,t.BINARY_NUMBER_MODE,t.CSS_NUMBER_MODE,t.REGEXP_MODE,t.TITLE_MODE,t.UNDERSCORE_TITLE_MODE,t.METHOD_GUARD].forEach((function(t){!function t(e){Object.freeze(e);var n="function"==typeof e;return Object.getOwnPropertyNames(e).forEach((function(r){!e.hasOwnProperty(r)||null===e[r]||"object"!=typeof e[r]&&"function"!=typeof e[r]||n&&("caller"===r||"callee"===r||"arguments"===r)||Object.isFrozen(e[r])||t(e[r])})),e}(t)})),t},o="object"==typeof window&&window||"object"==typeof self&&self,e.nodeType?o&&(o.hljs=i({}),void 0===(r=function(){return o.hljs}.apply(e,[]))||(t.exports=r)):i(e)},57:function(t,e){t.exports=function(t){var e="[A-Za-z$_][0-9A-Za-z$_]*",n={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},r={className:"number",variants:[{begin:"\\b(0[bB][01]+)n?"},{begin:"\\b(0[oO][0-7]+)n?"},{begin:t.C_NUMBER_RE+"n?"}],relevance:0},i={className:"subst",begin:"\\$\\{",end:"\\}",keywords:n,contains:[]},o={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,i],subLanguage:"xml"}},a={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,i],subLanguage:"css"}},s={className:"string",begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE,i]};i.contains=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,o,a,s,r,t.REGEXP_MODE];var u=i.contains.concat([t.C_BLOCK_COMMENT_MODE,t.C_LINE_COMMENT_MODE]);return{aliases:["js","jsx","mjs","cjs"],keywords:n,contains:[{className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},{className:"meta",begin:/^#!/,end:/$/},t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,o,a,s,t.C_LINE_COMMENT_MODE,t.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+",contains:[{className:"type",begin:"\\{",end:"\\}",relevance:0},{className:"variable",begin:e+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),t.C_BLOCK_COMMENT_MODE,r,{begin:/[{,\n]\s*/,relevance:0,contains:[{begin:e+"\\s*:",returnBegin:!0,relevance:0,contains:[{className:"attr",begin:e,relevance:0}]}]},{begin:"("+t.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",contains:[t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,t.REGEXP_MODE,{className:"function",begin:"(\\(.*?\\)|"+e+")\\s*=>",returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e},{begin:/\(\s*\)/},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:n,contains:u}]}]},{className:"",begin:/\s/,end:/\s*/,skip:!0},{begin:/</,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,subLanguage:"xml",contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},{begin:/<[A-Za-z0-9\\._:-]+/,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,skip:!0,contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},"self"]}]}],relevance:0},{className:"function",beginKeywords:"function",end:/\{/,excludeEnd:!0,contains:[t.inherit(t.TITLE_MODE,{begin:e}),{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,contains:u}],illegal:/\[|%/},{begin:/\$[(.]/},t.METHOD_GUARD,{className:"class",beginKeywords:"class",end:/[{;=]/,excludeEnd:!0,illegal:/[:"\[\]]/,contains:[{beginKeywords:"extends"},t.UNDERSCORE_TITLE_MODE]},{beginKeywords:"constructor get set",end:/\{/,excludeEnd:!0}],illegal:/#(?!!)/}}},60:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return a}));var r=n(0),i=n(50),o=n.n(i);function a(t){var e=t.id;return Object(r.h)("div",{class:o.a.editor},Object(r.h)("div",null,"Editing: ",e))}},61:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"default",(function(){return at}));var i=n(0),o=n(4),a=n(20),s=n(53),u=n(56);Object(u.registerLanguage)("javascript",n(57));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function f(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function p(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function d(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function m(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var y=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=v(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var b=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function T(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var E="FirebaseError",I=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=E,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,S.prototype.create),i}return h(e,t),e}(Error),S=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?N(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new I(i,s),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();function N(t,e){return t.replace(A,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}var A=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();function D(t,e){var n=new k(t,e);return n.subscribe.bind(n)}var k=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=_),void 0===r.error&&(r.error=_),void 0===r.complete&&(r.complete=_);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function _(){}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var R=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),O="[DEFAULT]",M=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=O);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new b;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=l({identifier:O,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService(O)}catch(t){}try{for(var r=d(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=m(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=O),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return f(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===O?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:O:t},t}();var L=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new M(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function x(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var P,U=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(P||(P={}));var F,V=P.INFO,B=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case P.DEBUG:case P.VERBOSE:console.log.apply(console,x(["["+i+"]  "+t.name+":"],n));break;case P.INFO:console.info.apply(console,x(["["+i+"]  "+t.name+":"],n));break;case P.WARN:console.warn.apply(console,x(["["+i+"]  "+t.name+":"],n));break;case P.ERROR:console.error.apply(console,x(["["+i+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},q=function(){function t(t){this.name=t,this._logLevel=V,this._logHandler=B,U.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in P))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,x([this,P.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,x([this,P.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,x([this,P.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,x([this,P.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,x([this,P.ERROR],t))},t}();var j,z=((F={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",F["bad-app-name"]="Illegal App name: '{$appName}",F["duplicate-app"]="Firebase App named '{$appName}' already exists",F["app-deleted"]="Firebase App named '{$appName}' already deleted",F["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",F),K=new S("app","Firebase",z),G="@firebase/app",W="0.5.0",Q="[DEFAULT]",H=((j={})[G]="fire-core",j["@firebase/analytics"]="fire-analytics",j["@firebase/auth"]="fire-auth",j["@firebase/database"]="fire-rtdb",j["@firebase/functions"]="fire-fn",j["@firebase/installations"]="fire-iid",j["@firebase/messaging"]="fire-fcm",j["@firebase/performance"]="fire-perf",j["@firebase/remote-config"]="fire-rc",j["@firebase/storage"]="fire-gcs",j["@firebase/firestore"]="fire-fst",j["fire-js"]="fire-js",j["firebase-wrapper"]="fire-js-all",j),Y=new q("@firebase/app"),X=function(){function t(t,e,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=v(void 0,t),this.container=new L(e.name),this._addComponent(new R("app",(function(){return o}),"PUBLIC"));try{for(var a=d(this.firebase_.INTERNAL.components.values()),s=a.next();!s.done;s=a.next()){var u=s.value;this._addComponent(u)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=Q),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Q),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){Y.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw K.create("app-deleted",{appName:this.name_})},t}();X.prototype.name&&X.prototype.options||X.prototype.delete||console.log("dc");var J="7.6.0";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $=
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Q);var a=o.name;if("string"!=typeof a||!a)throw K.create("bad-app-name",{appName:String(a)});if(C(e,a))throw K.create("duplicate-app",{appName:a});var s=new t(n,o,r);return e[a]=s,s},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=H[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),s=e.match(/\s|\//);if(a||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Y.warn(u.join(" "))}o(new R(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},apps:null,SDK_VERSION:J,INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!C(e,t=t||Q))throw K.create("no-app",{appName:t});return e[t]}function o(o){var a,s,u=o.name;if(n.has(u))return Y.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===o.type?r[u]:null;if(n.set(u,o),"PUBLIC"===o.type){var c=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[u])throw K.create("invalid-app-argument",{appName:u});return t[u]()};void 0!==o.serviceProps&&v(c,o.serviceProps),r[u]=c,t.prototype[u]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,u);return n.apply(this,o.multipleInstances?t:[])}}try{for(var h=d(Object.keys(e)),l=h.next();!l.done;l=h.next()){var f=l.value;e[f]._addComponent(o)}}catch(t){a={error:t}}finally{try{l&&!l.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}return"PUBLIC"===o.type?r[u]:null}return(r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r)}(X);return e.INTERNAL=l(l({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){v(e,t)},createSubscribe:D,ErrorFactory:S,deepExtend:v}),e}(),Z=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e,n=t.getComponent();return"VERSION"===(null===(e=n)||void 0===e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Y.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var tt=self.firebase.SDK_VERSION;tt&&tt.indexOf("LITE")>=0&&Y.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var et=$.initializeApp;$.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T()&&Y.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),et.apply(void 0,t)};var nt,rt,it=$;(nt=it).INTERNAL.registerComponent(new R("platform-logger",(function(t){return new Z(t)}),"PRIVATE")),nt.registerVersion(G,W,rt),nt.registerVersion("fire-js","");var ot=it;
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
ot.registerVersion("firebase","7.6.1","app");var at=ot,st=(void 0)(n(42).a);var ut,ct="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ht=ht||{},lt=ct;function ft(t){return"string"==typeof t}function pt(t){return"number"==typeof t}function dt(t,e){t=t.split("."),e=e||lt;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function mt(){}function gt(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function yt(t){return"array"==gt(t)}function vt(t){var e=gt(t);return"array"==e||"object"==e&&"number"==typeof t.length}function bt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var wt="closure_uid_"+(1e9*Math.random()>>>0),Tt=0;function Et(t,e,n){return t.call.apply(t.bind,arguments)}function It(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function St(t,e,n){return(St=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Et:It).apply(null,arguments)}function Nt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var At=Date.now||function(){return+new Date};function Ct(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.xb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Dt(){this.j=this.j,this.i=this.i}Dt.prototype.j=!1,Dt.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[wt]||(this[wt]=++Tt)},Dt.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var kt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(ft(t))return ft(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},_t=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=ft(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Rt(t){return Array.prototype.concat.apply([],arguments)}function Ot(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Mt(t){return/^[\s\xa0]*$/.test(t)}var Lt,xt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Pt(t,e){return-1!=t.indexOf(e)}function Ut(t,e){return t<e?-1:t>e?1:0}t:{var Ft=lt.navigator;if(Ft){var Vt=Ft.userAgent;if(Vt){Lt=Vt;break t}}Lt=""}function Bt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function qt(t){var e,n={};for(e in t)n[e]=t[e];return n}var jt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<jt.length;o++)n=jt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Kt(t){return Kt[" "](t),t}Kt[" "]=mt;var Gt,Wt,Qt=Pt(Lt,"Opera"),Ht=Pt(Lt,"Trident")||Pt(Lt,"MSIE"),Yt=Pt(Lt,"Edge"),Xt=Yt||Ht,Jt=Pt(Lt,"Gecko")&&!(Pt(Lt.toLowerCase(),"webkit")&&!Pt(Lt,"Edge"))&&!(Pt(Lt,"Trident")||Pt(Lt,"MSIE"))&&!Pt(Lt,"Edge"),$t=Pt(Lt.toLowerCase(),"webkit")&&!Pt(Lt,"Edge");function Zt(){var t=lt.document;return t?t.documentMode:void 0}t:{var te="",ee=(Wt=Lt,Jt?/rv:([^\);]+)(\)|;)/.exec(Wt):Yt?/Edge\/([\d\.]+)/.exec(Wt):Ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Wt):$t?/WebKit\/(\S+)/.exec(Wt):Qt?/(?:Version)[ \/]?(\S+)/.exec(Wt):void 0);if(ee&&(te=ee?ee[1]:""),Ht){var ne=Zt();if(null!=ne&&ne>parseFloat(te)){Gt=String(ne);break t}}Gt=te}var re,ie={};function oe(t){return function(t,e){var n=ie;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=xt(String(Gt)).split("."),r=xt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Ut(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Ut(0==a[2].length,0==s[2].length)||Ut(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var ae=lt.document;re=ae&&Ht?Zt()||("CSS1Compat"==ae.compatMode?parseInt(Gt,10):5):void 0;var se=!Ht||9<=Number(re),ue=Ht&&!oe("9"),ce=function(){if(!lt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{lt.addEventListener("test",mt,e),lt.removeEventListener("test",mt,e)}catch(t){}return t}();function he(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function le(t,e){if(he.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Jt){t:{try{Kt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=ft(t.pointerType)?t.pointerType:fe[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}he.prototype.b=function(){this.Ia=!1},Ct(le,he);var fe={2:"touch",3:"pen",4:"mouse"};le.prototype.b=function(){le.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ue)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var pe="closure_listenable_"+(1e6*Math.random()|0),de=0;function me(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++de,this.X=this.Z=!1}function ge(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ye(t){this.src=t,this.a={},this.b=0}function ve(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=kt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ge(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function be(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ye.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=be(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new me(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var we="closure_lm_"+(1e6*Math.random()|0),Te={};function Ee(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(yt(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=_e(r),e&&e[pe]?e.Aa(n,r,bt(i)?!!i.capture:!!i,o):Ie(e,n,r,!0,i,o)}(t,e,n,r,i);if(yt(e)){for(var o=0;o<e.length;o++)Ee(t,e[o],n,r,i);return null}return n=_e(n),t&&t[pe]?t.za(e,n,bt(r)?!!r.capture:!!r,i):Ie(t,e,n,!1,r,i)}function Ie(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=bt(i)?!!i.capture:!!i;if(a&&!se)return null;var s=De(t);if(s||(t[we]=s=new ye(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Ce,e=se?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ce||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ne(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Se(t){if(!pt(t)&&t&&!t.X){var e=t.src;if(e&&e[pe])ve(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ne(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=De(e))?(ve(n,t),0==n.b&&(n.src=null,e[we]=null)):ge(t)}}}function Ne(t){return t in Te?Te[t]:Te[t]="on"+t}function Ae(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&Se(t),n.call(r,e)}function Ce(t,e){return!!t.X||(se?Ae(t,new le(e,this)):Ae(t,e=new le(e||dt("window.event"),this)))}function De(t){return(t=t[we])instanceof ye?t:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(t){return"function"==gt(t)?t:(t[ke]||(t[ke]=function(e){return t.handleEvent(e)}),t[ke])}function Re(){Dt.call(this),this.c=new ye(this),this.J=this,this.B=null}function Oe(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&ve(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ia}Ct(Re,Dt),Re.prototype[pe]=!0,(ut=Re.prototype).addEventListener=function(t,e,n,r){Ee(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(yt(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=bt(i)?!!i.capture:!!i,r=_e(r),e&&e[pe]?(e=e.c,(n=String(n).toString())in e.a&&(-1<(r=be(a=e.a[n],r,i,o))&&(ge(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--)))):e&&(e=De(e))&&(n=e.a[n.toString()],e=-1,n&&(e=be(n,r,i,o)),(r=-1<e?n[e]:null)&&Se(r))}(this,t,e,n,r)},ut.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(ft(t))t=new he(t,n);else if(t instanceof he)t.target=t.target||n;else{var i=t;zt(t=new he(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Oe(a,r,!0,t)&&i}if(i=Oe(a=t.a=n,r,!0,t)&&i,i=Oe(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Oe(a=t.a=e[o],r,!1,t)&&i;return i},ut.G=function(){if(Re.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ge(n[r]);delete e.a[t],e.b--}}this.B=null},ut.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Me=lt.JSON.stringify;function Le(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function xe(){this.b=this.a=null}Le.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Pe,Ue=new Le((function(){return new Ve}),(function(t){t.reset()}));function Fe(){var t=ze,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ve(){this.next=this.b=this.a=null}function Be(t){lt.setTimeout((function(){throw t}),0)}function qe(t,e){Pe||function(){var t=lt.Promise.resolve(void 0);Pe=function(){t.then(Ke)}}(),je||(Pe(),je=!0),ze.add(t,e)}xe.prototype.add=function(t,e){var n=Ue.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ve.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ve.prototype.reset=function(){this.next=this.b=this.a=null};var je=!1,ze=new xe;function Ke(){for(var t;t=Fe();){try{t.a.call(t.b)}catch(t){Be(t)}var e=Ue;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}je=!1}function Ge(t,e){Re.call(this),this.b=t||1,this.a=e||lt,this.f=St(this.fb,this),this.g=At()}function We(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Qe(t,e,n){if("function"==gt(t))n&&(t=St(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=St(t.handleEvent,t)}return 2147483647<Number(e)?-1:lt.setTimeout(t,e||0)}function He(t,e,n){Dt.call(this),this.f=null!=n?St(t,n):t,this.c=e,this.b=St(this.$a,this),this.a=[]}function Ye(t){t.U=Qe(t.b,t.c),t.f.apply(null,t.a)}function Xe(t){Dt.call(this),this.b=t,this.a={}}Ct(Ge,Re),(ut=Ge.prototype).ba=!1,ut.L=null,ut.fb=function(){if(this.ba){var t=At()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(We(this),this.start()))}},ut.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=At())},ut.G=function(){Ge.N.G.call(this),We(this),delete this.a},Ct(He,Dt),(ut=He.prototype).ea=!1,ut.U=null,ut.Ta=function(t){this.a=arguments,this.U?this.ea=!0:Ye(this)},ut.G=function(){He.N.G.call(this),this.U&&(lt.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},ut.$a=function(){this.U=null,this.ea&&(this.ea=!1,Ye(this))},Ct(Xe,Dt);var Je=[];function $e(t,e,n,r){yt(n)||(n&&(Je[0]=n.toString()),n=Je);for(var i=0;i<n.length;i++){var o=Ee(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ze(t){Bt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Se(t)}),t),t.a={}}function tn(){}Xe.prototype.G=function(){Xe.N.G.call(this),Ze(this)},Xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var en=new Re;function nn(t){he.call(this,"serverreachability",t)}function rn(t){en.dispatchEvent(new nn(en,t))}function on(t){he.call(this,"statevent",t)}function an(t){en.dispatchEvent(new on(en,t))}function sn(t){he.call(this,"timingevent",t)}function un(t,e){if("function"!=gt(t))throw Error("Fn must not be null and must be a function");return lt.setTimeout((function(){t()}),e)}Ct(nn,he),Ct(on,he),Ct(sn,he);var cn={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},hn={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function ln(){}function fn(t){var e;return(e=t.a)||(e=t.a={}),e}function pn(){}ln.prototype.a=null;var dn,mn={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function gn(){he.call(this,"d")}function yn(){he.call(this,"c")}function vn(){}function bn(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Xe(this),this.O=wn,t=Xt?125:void 0,this.P=new Ge(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}Ct(gn,he),Ct(yn,he),Ct(vn,ln),dn=new vn;var wn=45e3,Tn={},En={};function In(t,e,n){t.F=1,t.f=Hn(qn(e)),t.l=n,t.H=!0,Nn(t,null)}function Sn(t,e,n,r){t.F=1,t.f=Hn(qn(e)),t.l=null,t.H=n,Nn(t,r)}function Nn(t,e){t.v=At(),Dn(t),t.D=qn(t.f),Qn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new He(St(t.Ja,t,t.a),t.J)),$e(t.I,t.a,"readystatechange",t.cb),e=t.h?qt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),rn(1)}function An(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Cn(t,n);if(i==En){4==e&&(t.c=4,an(14),r=!1);break}if(i==Tn){t.c=4,an(15),r=!1;break}Mn(t,i)}4==e&&0==n.length&&(t.c=1,an(16),r=!1),t.b=t.b&&r,r||(On(t),Rn(t))}function Cn(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?En:(n=Number(e.substring(n,r)),isNaN(n)?Tn:(r+=1)+n>e.length?En:(e=e.substr(r,n),t.A=r+n,e))}function Dn(t){t.R=At()+t.O,kn(t,t.O)}function kn(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=un(St(t.ab,t),e)}function _n(t){t.i&&(lt.clearTimeout(t.i),t.i=null)}function Rn(t){t.g.Ca()||t.m||t.g.na(t)}function On(t){_n(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,We(t.P),Ze(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Mn(t,e){try{t.g.Fa(t,e),rn(4)}catch(t){}}function Ln(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(vt(t)||ft(t))_t(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(vt(t)||ft(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(ft(t))return t.split("");if(vt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function xn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof xn)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Pn(t,e){Fn(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Un(t))}function Un(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Fn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Fn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=bn.prototype).setTimeout=function(t){this.O=t},ut.cb=function(t){t=t.target;var e=this.B;e&&3==Br(t)?e.Ta():this.Ja(t)},ut.Ja=function(t){try{if(t==this.a)t:{var e=Br(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!Xt&&!this.a.aa())){this.m||4!=e||7==n||rn(8==n||0>=r?3:2),_n(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=qr(this.a,"X-HTTP-Initial-Response");if(a&&!Mt(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,an(12),On(this),Rn(this);break t}this.s=!0,Mn(this,s)}this.H?(An(this,e,o),Xt&&this.b&&3==e&&($e(this.I,this.P,"tick",this.bb),this.P.start())):Mn(this,o),4==e&&On(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Dn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,an(12)):(this.c=0,an(13)),On(this),Rn(this)}}}catch(t){}},ut.bb=function(){if(this.a){var t=Br(this.a),e=this.a.aa();this.A<e.length&&(_n(this),An(this,t,e),this.b&&4!=t&&Dn(this))}},ut.cancel=function(){this.m=!0,On(this)},ut.ab=function(){this.i=null;var t=At();0<=t-this.R?(2!=this.F&&(rn(3),an(17)),On(this),this.c=2,Rn(this)):kn(this,this.R-t)},(ut=xn.prototype).C=function(){Un(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.K=function(){return Un(this),this.a.concat()},ut.get=function(t,e){return Fn(this.b,t)?this.b[t]:e},ut.set=function(t,e){Fn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Vn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Bn(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Bn?(this.h=void 0!==e?e:t.h,jn(this,t.f),this.j=t.j,zn(this,t.b),Kn(this,t.i),this.a=t.a,Gn(this,ur(t.c)),this.g=t.g):t&&(n=String(t).match(Vn))?(this.h=!!e,jn(this,n[1]||"",!0),this.j=Yn(n[2]||""),zn(this,n[3]||"",!0),Kn(this,n[4]),this.a=Yn(n[5]||"",!0),Gn(this,n[6]||"",!0),this.g=Yn(n[7]||"")):(this.h=!!e,this.c=new rr(null,this.h))}function qn(t){return new Bn(t)}function jn(t,e,n){t.f=n?Yn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function zn(t,e,n){t.b=n?Yn(e,!0):e}function Kn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Gn(t,e,n){e instanceof rr?(t.c=e,function(t,e){e&&!t.f&&(ir(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(or(this,e),sr(this,n,t))}),t)),t.f=e}(t.c,t.h)):(n||(e=Xn(e,er)),t.c=new rr(e,t.h))}function Wn(t,e,n){t.c.set(e,n)}function Qn(t,e,n){yt(n)||(n=[String(n)]),sr(t.c,e,n)}function Hn(t){return Wn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^At()).toString(36)),t}function Yn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Xn(t,e,n){return ft(t)?(t=encodeURI(t).replace(e,Jn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Jn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Bn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Xn(e,$n,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Xn(e,$n,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Xn(n,"/"==n.charAt(0)?tr:Zn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Xn(n,nr)),t.join("")},Bn.prototype.resolve=function(t){var e=qn(this),n=!!t.f;n?jn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?zn(e,t.b):n=null!=t.i;var r=t.a;if(n)Kn(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(Pt(i,"./")||Pt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Gn(e,ur(t.c)):n=!!t.g,n&&(e.g=t.g),e};var $n=/[#\/\?@]/g,Zn=/[#\?:]/g,tr=/[#\?]/g,er=/[#\?@]/g,nr=/#/g;function rr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ir(t){t.a||(t.a=new xn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function or(t,e){ir(t),e=cr(t,e),Fn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Pn(t.a,e))}function ar(t,e){return ir(t),e=cr(t,e),Fn(t.a.b,e)}function sr(t,e,n){or(t,e),0<n.length&&(t.c=null,t.a.set(cr(t,e),Ot(n)),t.b+=n.length)}function ur(t){var e=new rr;return e.c=t.c,t.a&&(e.a=new xn(t.a),e.b=t.b),e}function cr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function hr(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function lr(t){var e=t.a.F.a;if(null!=e)an(4),e?(an(10),Zr(t.a,t,!1)):(an(11),Zr(t.a,t,!0));else{t.b=new bn(t,void 0,void 0),t.b.h=t.h,e=ii(e=t.a,e.Y()?t.f:null,t.i),an(4),Qn(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Wn(e,n,r),Sn(t.b,e,!1,t.f)}}function fr(){this.a=this.b=null}function pr(){this.a=new xn}function dr(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[wt]||(t[wt]=++Tt)):e.charAt(0)+t}function mr(t,e){this.b=t,this.a=e}function gr(t){this.g=t||yr,lt.PerformanceNavigationTiming?t=0<(t=lt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(lt.ka&&lt.ka.Da&&lt.ka.Da()&&lt.ka.Da().yb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new pr),this.b=null,this.c=[]}(ut=rr.prototype).add=function(t,e){ir(this),this.c=null,t=cr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(t,e){ir(this),this.a.forEach((function(n,r){_t(n,(function(n){t.call(e,n,r,this)}),this)}),this)},ut.K=function(){ir(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.C=function(t){ir(this);var e=[];if(ft(t))ar(this,t)&&(e=Rt(e,this.a.get(cr(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Rt(e,t[n])}return e},ut.set=function(t,e){return ir(this),this.c=null,ar(this,t=cr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},Ct((function(){}),(function(){})),(ut=hr.prototype).M=null,ut.$=function(t){return this.a.$(t)},ut.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},ut.Ca=function(){return!1},ut.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=qr(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=qr(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void ni(e,2)}this.f=r[0]}else(e=this.a).m=this.c,ni(e,2)}else 1==this.M&&(this.g?an(6):"11111"==e?(an(5),this.g=!0,(!Ht||10<=Number(re))&&(this.c=200,this.b.cancel(),an(11),Zr(this.a,this,!0))):(an(7),this.g=!1))},ut.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,lr(this)):1==this.M&&(this.g?(an(11),Zr(this.a,this,!0)):(an(10),Zr(this.a,this,!1)));else{0==this.M?an(8):1==this.M&&an(9);var t=this.a;t.m=this.c,ni(t,2)}},ut.Y=function(){return this.a.Y()},ut.ma=function(){return this.a.ma()},pr.prototype.add=function(t){this.a.set(dr(t),t)},pr.prototype.C=function(){return this.a.C()};var yr=10;function vr(t,e){!t.a&&(Pt(e,"spdy")||Pt(e,"quic")||Pt(e,"h2"))&&(t.f=t.g,t.a=new pr,t.b&&(Er(t,t.b),t.b=null))}function br(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function wr(t){return t.b?1:t.a?t.a.a.c:0}function Tr(t,e){return t.b?t=t.b==e:t.a?(e=dr(e),t=Fn(t.a.a.b,e)):t=!1,t}function Er(t,e){t.a?t.a.add(e):t.b=e}function Ir(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=dr(e),n=Fn(t.a.a.b,n)),n&&Pn(t.a.a,dr(e)))}function Sr(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return _t(t.a.C(),(function(t){e=e.concat(t.j)})),e}return Ot(t.c)}function Nr(){}function Ar(){this.a=new Nr}function Cr(t,e,n){var r=n||"";try{Ln(t,(function(t,n){var i=t;bt(t)&&(i=Me(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Dr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gr.prototype.cancel=function(){this.c=Sr(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(_t(this.a.C(),(function(t){t.cancel()})),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},Nr.prototype.stringify=function(t){return lt.JSON.stringify(t,void 0)},Nr.prototype.parse=function(t){return lt.JSON.parse(t,void 0)};var kr=lt.JSON.parse;function _r(t){Re.call(this),this.headers=new xn,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Rr,this.D=this.F=!1}Ct(_r,Re);var Rr="",Or=/^https?$/i,Mr=["POST","PUT"];function Lr(t){return"content-type"==t.toLowerCase()}function xr(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pr(t),Fr(t)}function Pr(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ur(t){if(t.b&&void 0!==ht&&(!t.s[1]||4!=Br(t)||2!=t.T()))if(t.l&&4==Br(t))Qe(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==Br(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(Vn)[1]||null;if(!o&&lt.self&&lt.self.location){var a=lt.self.location.protocol;o=a.substr(0,a.length-1)}i=!Or.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var s=2<Br(t)?t.a.statusText:""}catch(t){s=""}t.f=s+" ["+t.T()+"]",Pr(t)}}finally{Fr(t)}}}function Fr(t,e){if(t.a){Vr(t);var n=t.a,r=t.s[0]?mt:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Vr(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(lt.clearTimeout(t.m),t.m=null)}function Br(t){return t.a?t.a.readyState:0}function qr(t,e){return t.a?t.a.getResponseHeader(e):null}function jr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return Bt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),ft(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Wn(t,e,n),t}function zr(t){this.f=[],this.F=new fr,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!dt("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=dt("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=dt("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=dt("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=dt("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.zb||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new gr(t&&t.concurrentRequestLimit),this.ja=new Ar,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Kr(t){if(Gr(t),3==t.u){var e=t.P++,n=qn(t.B);Wn(n,"SID",t.H),Wn(n,"RID",e),Wn(n,"TYPE","terminate"),Yr(t,n),(e=new bn(t,e,void 0)).F=2,e.f=Hn(qn(n)),n=!1,lt.navigator&&lt.navigator.sendBeacon&&(n=lt.navigator.sendBeacon(e.f.toString(),"")),!n&&lt.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=At(),Dn(e)}ri(t)}function Gr(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(lt.clearTimeout(t.l),t.l=null),ti(t),t.b.cancel(),t.h&&(pt(t.h)&&lt.clearTimeout(t.h),t.h=null)}function Wr(t,e){t.f.push(new mr(t.Qa++,e)),3==t.u&&Qr(t)}function Qr(t){br(t.b)||t.h||(t.h=!0,qe(t.Ha,t),t.A=0)}function Hr(t,e){var n;n=e?e.W:t.P++;var r=qn(t.B);Wn(r,"SID",t.H),Wn(r,"RID",n),Wn(r,"AID",t.O),Yr(t,r),t.g&&t.i&&jr(r,t.g,t.i),n=new bn(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Xr(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Er(t.b,n),In(n,r,e)}function Yr(t,e){t.c&&Ln({},(function(t,n){Wn(e,n,t)}))}function Xr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?St(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{Cr(h,a,"req"+c+"_")}catch(t){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Jr(t){t.a||t.l||(t.S=1,qe(t.Ga,t),t.v=0)}function $r(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=un(St(t.Ga,t),ei(t,t.v)),t.v++,!0)}function Zr(t,e,n){var r=e.l;r&&vr(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=ii(t,null,t.ha),Qr(t)}function ti(t){null!=t.s&&(lt.clearTimeout(t.s),t.s=null)}function ei(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function ni(t,e){if(2==e){var n=null;t.c&&(n=null);var r=St(t.eb,t);n||(n=new Bn("//www.google.com/images/cleardot.gif"),lt.location&&"http"==lt.location.protocol||jn(n,"https"),Hn(n)),function(t,e){var n=new tn;if(lt.Image){var r=new Image;r.onload=Nt(Dr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Nt(Dr,n,r,"TestLoadImage: error",!1,e),r.onabort=Nt(Dr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Nt(Dr,n,r,"TestLoadImage: timeout",!1,e),lt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else an(2);t.u=0,t.c&&t.c.ta(e),ri(t),Gr(t)}function ri(t){t.u=0,t.m=-1,t.c&&(0==Sr(t.b).length&&0==t.f.length||(t.b.c.length=0,Ot(t.f),t.f.length=0),t.c.sa())}function ii(t,e,n){var r=function(t){return t instanceof Bn?qn(t):new Bn(t,void 0)}(n);if(""!=r.b)e&&zn(r,e+"."+r.b),Kn(r,r.i);else{var i,o=lt.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Bn(null,void 0);return t&&jn(i,t),e&&zn(i,e),n&&Kn(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&Bt(t.V,(function(t,e){Wn(r,e,t)})),e=t.j,n=t.I,e&&n&&Wn(r,e,n),Wn(r,"VER",t.wa),Yr(t,r),r}function oi(){}function ai(){if(Ht&&!(10<=Number(re)))throw Error("Environmental error: no available transport.")}function si(t,e){Re.call(this),this.a=new zr(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!Mt(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Mt(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new hi(this)}function ui(t){gn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ci(){yn.call(this),this.status=1}function hi(t){this.a=t}(ut=_r.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fn(this.H):fn(dn),this.a.onreadystatechange=St(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void xr(this,t)}t=n||"";var i=new xn(this.headers);r&&Ln(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Lr,n=t.length,r=ft(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:ft(t)?t.charAt(e):t[e]}(i.K()),n=lt.FormData&&t instanceof lt.FormData,!(0<=kt(Mr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Vr(this),0<this.o&&((this.D=function(t){return Ht&&oe(9)&&pt(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=St(this.Ba,this)):this.m=Qe(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xr(this,t)}},ut.Ba=function(){void 0!==ht&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fr(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fr(this,!0)),_r.N.G.call(this)},ut.Ea=function(){this.j||(this.w||this.l||this.g?Ur(this):this.Za())},ut.Za=function(){Ur(this)},ut.T=function(){try{return 2<Br(this)?this.a.status:-1}catch(t){return-1}},ut.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kr(e)}},ut.ya=function(){return this.h},ut.Xa=function(){return ft(this.f)?this.f:String(this.f)},(ut=zr.prototype).wa=8,ut.u=1,ut.Ca=function(){return 0==this.u},ut.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new bn(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?zt(r=qt(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&ft(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xr(this,n,e),Wn(i=qn(this.B),"RID",t),Wn(i,"CVER",22),this.o&&this.j&&Wn(i,"X-HTTP-Session-Id",this.j),Yr(this,i),this.g&&r&&jr(i,this.g,r),Er(this.b,n),this.W?(Wn(i,"$req",e),Wn(i,"SID","null"),n.S=!0,In(n,i,null)):In(n,i,e),this.u=2}}else 3==this.u&&(t?Hr(this,t):0==this.f.length||br(this.b)||Hr(this))},ut.Ga=function(){this.l=null,this.a=new bn(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=qn(this.pa);Wn(t,"RID","rpc"),Wn(t,"SID",this.H),Wn(t,"CI",this.ia?"0":"1"),Wn(t,"AID",this.O),Yr(this,t),Wn(t,"TYPE","xmlhttp"),this.g&&this.i&&jr(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Sn(this.a,t,!0,this.ga)},ut.Fa=function(t,e){if(0!=this.u&&(this.a==t||Tr(this.b,t)))if(this.m=t.o,!t.s&&Tr(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(yt(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;ti(this),this.a.cancel(),this.a=null}$r(this),an(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=un(St(this.Ya,this),6e3));if(1>=wr(this.b)&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else ni(this,11)}else if((t.s||this.a==t)&&ti(this),!Mt(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&pt(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=qr(r,"X-Client-Wire-Protocol"))&&vr(this.b,i),this.j&&(r=qr(r,"X-HTTP-Session-Id")))&&(this.I=r,Wn(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=ii(this,this.Y()?this.ga:null,this.ha),r.s?(Ir(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(_n(r),Dn(r)),this.a=r):Jr(this),0<this.f.length&&Qr(this)}else"stop"!=r[0]&&"close"!=r[0]||ni(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?ni(this,7):Kr(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},ut.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,$r(this),an(19))},ut.na=function(t){var e=null;if(this.a==t){ti(this),this.a=null;var n=2}else{if(!Tr(this.b,t))return;e=t.j,Ir(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=At()-t.v,en.dispatchEvent(new sn(en,t.l?t.l.length:0,e,this.A)),Qr(this)):Jr(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(wr(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=un(St(t.Ha,t,e),ei(t,t.A)),t.A++,!0))}(this,t)||2==n&&$r(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:ni(this,5);break;case 4:ni(this,10);break;case 3:ni(this,6);break;default:ni(this,2)}}},ut.eb=function(t){an(t?2:1)},ut.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new _r(this.Ka)).F=this.R,t},ut.ma=function(){return!!this.c&&!0},ut.Y=function(){return this.R},(ut=oi.prototype).va=function(){},ut.ua=function(){},ut.ta=function(){},ut.sa=function(){},ut.Sa=function(){},ai.prototype.a=function(t,e){return new si(t,e)},Ct(si,Re),(ut=si.prototype).addEventListener=function(t,e,n,r){si.N.addEventListener.call(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){si.N.removeEventListener.call(this,t,e,n,r)},ut.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;an(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new hr(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=jr(e,t.g,t.i)),(t=t.w).i=n,e=ii(t.a,null,t.i),an(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,lr(t)):(Qn(e,"MODE","init"),!t.a.o&&t.a.j&&Qn(e,"X-HTTP-Session-Id",t.a.j),t.b=new bn(t,void 0,void 0),t.b.h=t.h,Sn(t.b,e,!1,null),t.M=0)},ut.close=function(){Kr(this.a)},ut.Wa=function(t){if(ft(t)){var e={};e.__data__=t,Wr(this.a,e)}else this.h?((e={}).__data__=Me(t),Wr(this.a,e)):Wr(this.a,t)},ut.G=function(){this.a.c=null,delete this.f,Kr(this.a),delete this.a,si.N.G.call(this)},Ct(ui,gn),Ct(ci,yn),Ct(hi,oi),hi.prototype.va=function(){this.a.dispatchEvent("a")},hi.prototype.ua=function(t){this.a.dispatchEvent(new ui(t))},hi.prototype.ta=function(t){this.a.dispatchEvent(new ci(t))},hi.prototype.sa=function(){this.a.dispatchEvent("b")};var li=Nt((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r}),ai);ai.prototype.createWebChannel=ai.prototype.a,si.prototype.send=si.prototype.Wa,si.prototype.open=si.prototype.Va,si.prototype.close=si.prototype.close,cn.NO_ERROR=0,cn.TIMEOUT=8,cn.HTTP_ERROR=6,hn.COMPLETE="complete",pn.EventType=mn,mn.OPEN="a",mn.CLOSE="b",mn.ERROR="c",mn.MESSAGE="d",Re.prototype.listen=Re.prototype.za,_r.prototype.listenOnce=_r.prototype.Aa,_r.prototype.getLastError=_r.prototype.Xa,_r.prototype.getLastErrorCode=_r.prototype.ya,_r.prototype.getStatus=_r.prototype.T,_r.prototype.getResponseJson=_r.prototype.Ua,_r.prototype.getResponseText=_r.prototype.aa,_r.prototype.send=_r.prototype.ca;var fi,pi={createWebChannelTransport:li,ErrorCode:cn,EventType:hn,WebChannel:pn,XhrIo:_r},di=pi.createWebChannelTransport,mi=pi.ErrorCode,gi=pi.EventType,yi=pi.WebChannel,vi=pi.XhrIo,bi=ot.SDK_VERSION,wi=new q("@firebase/firestore");function Ti(){return wi.logLevel===P.DEBUG?fi.DEBUG:wi.logLevel===P.SILENT?fi.SILENT:fi.ERROR}function Ei(t){switch(t){case fi.DEBUG:wi.logLevel=P.DEBUG;break;case fi.ERROR:wi.logLevel=P.ERROR;break;case fi.SILENT:wi.logLevel=P.SILENT;break;default:wi.error("Firestore ("+bi+"): Invalid value passed to `setLogLevel`")}}function Ii(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(wi.logLevel<=P.DEBUG){var i=n.map(Ni);wi.debug.apply(wi,g(["Firestore ("+bi+") ["+t+"]: "+e],i))}}function Si(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(wi.logLevel<=P.ERROR){var r=e.map(Ni);wi.error.apply(wi,g(["Firestore ("+bi+"): "+t],r))}}function Ni(t){if("string"==typeof t)return t;var e=Di.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t){var e="FIRESTORE ("+bi+") INTERNAL ASSERTION FAILED: "+t;throw Si(e),new Error(e)}function Ci(t,e){t||Ai(e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(fi||(fi={}));var Di=function(){function t(){}return t.setPlatform=function(e){t.platform&&Ai("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||Ai("Platform not set"),t.platform},t}();function ki(){return Di.getPlatform().emptyByteString}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _i={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ri=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return h(e,t),e}(Error);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Oi(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ri(_i.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Li(t,e){return void 0!==t?t:e}function xi(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function Pi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ui(t){for(var e in Ci(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Fi(t,e){if(0!==e.length)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ro(e.length,"argument")+".")}function Vi(t,e,n){if(e.length!==n)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires "+ro(n,"argument")+", but was called with "+ro(e.length,"argument")+".")}function Bi(t,e,n){if(e.length<n)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ro(n,"argument")+", but was called with "+ro(e.length,"argument")+".")}function qi(t,e,n,r){if(e.length<n||e.length>r)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ro(e.length,"argument")+".")}function ji(t,e,n,r){Yi(t,e,no(n)+" argument",r)}function zi(t,e,n,r){void 0!==r&&ji(t,e,n,r)}function Ki(t,e,n,r){Yi(t,e,n+" option",r)}function Gi(t,e,n,r){void 0!==r&&Ki(t,e,n,r)}function Wi(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ji(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+Ji(r[o]))}(t,e,n,r,i)}function Qi(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(Ji(u))}var c=Ji(r);throw new Ri(_i.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function Hi(t,e,n,r){if(!e.some((function(t){return t===r})))throw new Ri(_i.INVALID_ARGUMENT,"Invalid value "+Ji(r)+" provided to function "+t+"() for its "+no(n)+" argument. Acceptable values: "+e.join(", "))}function Yi(t,e,n,r){if(!("object"===e?Xi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Ji(r);throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Xi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ji(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ai("Unknown wrong type: "+typeof t)}function $i(t,e,n){if(void 0===n)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+no(e)+" argument, but it was undefined.")}function Zi(t,e,n){Pi(e,(function(e,r){if(n.indexOf(e)<0)throw new Ri(_i.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function to(t,e,n,r){var i=Ji(r);return new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires its "+no(n)+" argument to be a "+e+", but it was: "+i)}function eo(t,e,n){if(n<=0)throw new Ri(_i.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+no(e)+" argument to be a positive number, but it was: "+n+".")}function no(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ro(t,e){return t+" "+e+(1===t?"":"s")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var io=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return Ci(20===e.length,"Invalid auto ID: "+e),e},t}();function oo(t,e){return t<e?-1:t>e?1:0}function ao(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function so(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(){if("undefined"==typeof Uint8Array)throw new Ri(_i.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function co(){if(!Di.getPlatform().base64Available)throw new Ri(_i.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ho,lo=function(){function t(t){co(),this._binaryString=t}return t.fromBase64String=function(e){Vi("Blob.fromBase64String",arguments,1),ji("Blob.fromBase64String","string",1,e),co();try{var n=Di.getPlatform().atob(e);return new t(n)}catch(t){throw new Ri(_i.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(Vi("Blob.fromUint8Array",arguments,1),uo(),!(e instanceof Uint8Array))throw to("Blob.fromUint8Array","Uint8Array",1,e);var n=Array.prototype.map.call(e,(function(t){return String.fromCharCode(t)})).join("");return new t(n)},t.prototype.toBase64=function(){return Vi("Blob.toBase64",arguments,0),co(),Di.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){Vi("Blob.toUint8Array",arguments,0),uo();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return oo(this._binaryString,t._binaryString)},t}(),fo=Oi(lo,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),po=function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},mo="(default)",go=function(){function t(t,e){this.projectId=t,this.database=e||mo}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===mo},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return oo(this.projectId,t.projectId)||oo(this.database,t.database)},t}(),yo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),vo=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ai("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Ai("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,Ci(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return Ci(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return Ci(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return Ci(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.EMPTY_PATH=new e([]),e}(vo),wo=/^[_a-zA-Z][_a-zA-Z0-9]*$/,To=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return wo.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ri(_i.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ri(_i.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ri(_i.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ri(_i.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(vo),Eo=function(){function t(e){this.path=e,Ci(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===bo.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return bo.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new bo(e.slice()))},t.fromPathString=function(e){return new t(bo.fromString(e))},t.EMPTY=new t(new bo([])),t}(),Io=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection",t.RetryTransaction="retry_transaction"}(ho||(ho={}));var So=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Io,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ri(_i.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),No=function(){function t(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueAndInitiateShutdown=function(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(t){})):this.enqueueInternal(t)},t.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then((function(){return e.operationInProgress=!0,t().catch((function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw Si("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.operationInProgress=!1,t}))}));return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),Ci(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.timerIdsToSkip.indexOf(t)>-1&&(e=0);var i=So.createAndSchedule(this,t,e,n,(function(t){return r.removeDelayedOperation(t)}));return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&Ai("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){Ci(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){if(n[e].timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then((function(){Ci(t===ho.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==ho.All&&i.timerId===t)break}return e.drain()}))},t.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);Ci(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),Ao="",Co="",Do="",ko="";function _o(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Oo(e)),e=Ro(t.get(n),e);return Oo(e)}function Ro(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Ao+Do;break;case Ao:n+=Ao+ko;break;default:n+=o}}return n}function Oo(t){return t+Ao+Co}function Mo(t){var e=t.length;if(Ci(e>=2,"Invalid path "+t),2===e)return Ci(t.charAt(0)===Ao&&t.charAt(1)===Co,"Non-empty path "+t+" had length 2"),bo.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Ao,o);switch((a<0||a>n)&&Ai('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case Co:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case Do:i+=t.substring(o,a),i+="\0";break;case ko:i+=t.substring(o,a+1);break;default:Ai('Invalid encoded resource path: "'+t+'"')}o=a+2}return new bo(r)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ri(_i.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ri(_i.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ri(_i.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ri(_i.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?oo(this.nanoseconds,t.nanoseconds):oo(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),xo=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Lo(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Lo(0,0)),t}(),Po=function(){function t(t,e){this.comparator=t,this.root=e||Fo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Uo(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Uo(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Uo(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Uo(this.root,t,this.comparator,!0)},t}(),Uo=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){Ci(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Fo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ai("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Ai("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw Ai("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Vo=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ai("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ai("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ai("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ai("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ai("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Fo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fo.EMPTY=new Vo;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Bo=function(){function t(t){this.comparator=t,this.data=new Po(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach((function(t){n=n.add(t)})),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new qo(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new qo(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),qo=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),jo=new Po(Eo.comparator);function zo(){return jo}function Ko(){return zo()}var Go=new Po(Eo.comparator);function Wo(){return Go}var Qo=new Po(Eo.comparator);function Ho(){return Qo}var Yo=new Bo(Eo.comparator);function Xo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Yo,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Jo=new Bo(oo);function $o(){return Jo}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zo=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,Ci(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&Ci(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;Ci(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&Ci(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime))}for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Xo())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ao(this.mutations,t.mutations)&&ao(this.baseMutations,t.baseMutations)},t}(),ta=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){Ci(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Ho(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),ea=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Ai("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),na="SimpleDb",ra=function(){function t(e){this.db=e,12.2===t.getIOSVersion(w())&&Si("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.openOrCreate=function(e,n,r){return Ci(t.isAvailable(),"IndexedDB not supported in current environment."),Ii(na,"Opening database:",e),new ea((function(i,o){var a=window.indexedDB.open(e,n);a.onsuccess=function(e){var n=e.target.result;i(new t(n))},a.onblocked=function(){o(new Ri(_i.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new Ri(_i.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(t){Ii(na,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,a.transaction,t.oldVersion,fs).next((function(){Ii(na,"Database upgrade to version "+fs+" complete")}))}})).toPromise()},t.delete=function(t){return Ii(na,"Removing database:",t),sa(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var e=w(),n=t.getIOSVersion(e),r=0<n&&n<10,i=t.getAndroidVersion(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.isMockPersistence=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.USE_MOCK_PERSISTENCE)},t.getStore=function(t,e){return t.store(e)},t.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return f(this,void 0,void 0,(function(){var r,i,o,a,s,u;return p(this,(function(c){switch(c.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,a=function(){var t,a,u,c;return p(this,(function(h){switch(h.label){case 0:++o,t=oa.open(s.db,r?"readonly":"readwrite",e),h.label=1;case 1:return h.trys.push([1,3,,4]),(a=n(t).catch((function(e){return t.abort(e),ea.reject(e)})).toPromise()).catch((function(){})),[4,t.completionPromise];case 2:return h.sent(),[2,{value:a}];case 3:return u=h.sent(),c=i&&"FirebaseError"!==u.name&&o<3,Ii(na,"Transaction failed with error: %s. Retrying: %s.",u.message,c),c?[3,4]:[2,{value:Promise.reject(u)}];case 4:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:return"object"==typeof(u=c.sent())?[2,u.value]:[3,1];case 3:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),ia=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return sa(this.dbCursor.delete())},t}(),oa=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Io,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=ca(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(Ii(na,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return Ci(!!e,"Object store not part of transaction: "+t),new aa(e)},t}(),aa=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ii(na,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ii(na,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),sa(n)},t.prototype.add=function(t){return Ii(na,"ADD",this.store.name,t,t),sa(this.store.add(t))},t.prototype.get=function(t){var e=this;return sa(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ii(na,"GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Ii(na,"DELETE",this.store.name,t),sa(this.store.delete(t))},t.prototype.count=function(){return Ii(na,"COUNT",this.store.name),sa(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.deleteAll=function(t,e){Ii(na,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(t,e,n){return n.delete()}))},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new ea((function(n,r){e.onerror=function(t){var e=ca(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.iterateCursor=function(t,e){var n=[];return new ea((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ia(i),a=e(i.primaryKey,i.value,o);if(a instanceof ea){var s=a.catch((function(t){return o.done(),ea.reject(t)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return ea.waitFor(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(Ci(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function sa(t){return new ea((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ca(t.target.error);n(e)}}))}var ua=!1;function ca(t){var e=ra.getIOSVersion(w());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ri("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ua||(ua=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return Ci(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return da(t).iterate({index:ys.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next((function(e){return e.lastStreamToken=pa(n),ga(t).put(e)}))},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next((function(t){return t.lastStreamToken}))},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next((function(n){return n.lastStreamToken=pa(e),ga(t).put(n)}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=ma(t),a=da(t);return a.add({}).next((function(s){Ci("number"==typeof s,"Auto-generated key is not a number");for(var u=new Zo(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),h=[],l=new Bo((function(t,e){return oo(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],m=vs.key(i.userId,d.key.path,s);l=l.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(m,vs.PLACEHOLDER))}return l.forEach((function(e){h.push(i.indexManager.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),ea.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return da(t).get(e).next((function(t){return t?(Ci(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null}))},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?ea.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return da(t).iterate({index:ys.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Ci(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return da(t).iterate({index:ys.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return da(t).loadAll(ys.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.fromDbMutationBatch(t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=vs.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ma(t).iterate({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=Mo(u);if(s===n.userId&&e.path.isEqual(h))return da(t).get(c).next((function(t){if(!t)throw Ai("Dangling document-mutation reference found: "+r+" which points to "+c);Ci(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bo(oo),i=[];return e.forEach((function(e){var o=vs.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=ma(t).iterate({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Mo(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),ea.waitFor(i).next((function(){return n.lookupMutationBatches(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;Ci(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),Ci(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=vs.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Bo(oo);return ma(t).iterate({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=Mo(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.lookupMutationBatches(t,s)}))},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(da(t).get(e).next((function(t){if(null===t)throw Ai("Dangling document-mutation reference found, which points to "+e);Ci(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))})))})),ea.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return fa(t.simpleDbTransaction,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.removeCachedMutationKeys(e.batchId)})),ea.forEach(r,(function(e){return n.referenceDelegate.removeMutationReference(t,e)}))}))},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return ea.resolve();var r=IDBKeyRange.lowerBound(vs.prefixForUser(e.userId)),i=[];return ma(t).iterate({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Mo(t[1]);i.push(o)}else r.done()})).next((function(){Ci(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.canonicalString()})))}))}))},t.prototype.containsKey=function(t,e){return la(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return ga(t).get(this.userId).next((function(t){return t||new gs(e.userId,-1,"")}))},t}();function la(t,e,n){var r=vs.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ma(t).iterate({range:o,keysOnly:!0},(function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function fa(t,e,n){var r=t.store(ys.store),i=t.store(vs.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Ci(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=vs.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return ea.waitFor(o).next((function(){return c}))}function pa(t){return t instanceof Uint8Array?(Ci(ra.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function da(t){return Hs.getStore(t,ys.store)}function ma(t){return Hs.getStore(t,vs.store)}function ga(t){return Hs.getStore(t,gs.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ya,va=1;!function(t){t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine"}(ya||(ya={}));var ba=function(){function t(t,e){this.generatorId=t,Ci((t&va)===t,"Generator ID "+t+" contains more than "+va+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<va,t},t.prototype.after=function(t){return this.seek(t+(1<<va)),this.next()},t.prototype.seek=function(t){Ci((t&va)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forTargetCache=function(){return new t(ya.QueryCache,2)},t.forSyncEngine=function(){return new t(ya.SyncEngine)},t}(),wa=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=ba.forTargetCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next((function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next((function(t){return xo.fromTimestamp(new Lo(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return Ia(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.saveTargetData(t,e).next((function(){return n.retrieveMetadata(t).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(e,r),n.saveMetadata(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.saveTargetData(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ta(t).delete(e.targetId)})).next((function(){return n.retrieveMetadata(t)})).next((function(e){return Ci(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.saveMetadata(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ta(t).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return ea.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){var n=this;return Ta(t).iterate((function(t,r){var i=n.serializer.fromDbTarget(r);e(i)}))},t.prototype.retrieveMetadata=function(t){return Ea(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Hs.getStore(n,Ns.store)).put(Ns.key,e);var n},t.prototype.saveTargetData=function(t,e){return Ta(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromTargetData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.retrieveMetadata(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ta(t).iterate({range:i,index:Is.queryTargetsIndexName},(function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Sa(t);return e.forEach((function(e){var a=_o(e.path);i.push(o.put(new Ss(n,a))),i.push(r.referenceDelegate.addReference(t,e))})),ea.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Sa(t);return ea.forEach(e,(function(e){var o=_o(e.path);return ea.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Sa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Sa(t),i=Xo();return r.iterate({range:n,keysOnly:!0},(function(t,e,n){var r=Mo(t[1]),o=new Eo(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=_o(e.path),r=IDBKeyRange.bound([n],[so(n)],!1,!0),i=0;return Sa(t).iterate({index:Ss.documentTargetsIndex,keysOnly:!0,range:r},(function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.getTargetDataForTarget=function(t,e){var n=this;return Ta(t).get(e).next((function(t){return t?n.serializer.fromDbTarget(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(t){return Hs.getStore(t,Is.store)}function Ea(t){return ra.getStore(t,Ns.store).get(Ns.key).next((function(t){return Ci(null!==t,"Missing metadata row."),t}))}function Ia(t){return Ea(t).next((function(t){return t.highestListenSequenceNumber}))}function Sa(t){return Hs.getStore(t,Ss.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Na,Aa=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Bo(To.comparator);return e.forEach((function(t){return n=n.add(t)})),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach((function(n){n.isPrefixOf(t)&&(e=!0)})),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),Ca=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),Da=function(t,e){this.version=t,this.transformResults=e};!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(Na||(Na={}));var ka,_a,Ra=function(){function t(t,e){this.updateTime=t,this.exists=e,Ci(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof ts&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof ts:(Ci(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Oa=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&Ci(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof ts?t.version:xo.MIN},t}(),Ma=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Na.Set,i}return h(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),Ci(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new ts(this.key,n,{hasCommittedMutations:!0},this.value)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Oa.getPostMutationVersion(t);return new ts(this.key,r,{hasLocalMutations:!0},this.value)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Oa),La=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Na.Patch,o}return h(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Ci(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new ns(this.key,e.version);var n=this.patchDocument(t);return new ts(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Oa.getPostMutationVersion(t),i=this.patchDocument(t);return new ts(this.key,r,{hasLocalMutations:!0},i)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof ts?t.data():Ja.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}})),t},e}(Oa),xa=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Na.Transform,r.precondition=Ra.exists(!0),r}return h(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Ci(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new ns(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new ts(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new ts(this.key,r.version,{hasLocalMutations:!0},o)},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ts?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?Ja.EMPTY.set(i.field,a):e.set(i.field,a))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&ao(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){return Ci(t instanceof ts,"Unknown MaybeDocument type "+t),Ci(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},e.prototype.serverTransformResults=function(t,e){var n=[];Ci(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof ts&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof ts&&(u=e.field(a.field)),null===u&&n instanceof ts&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},e.prototype.transformObject=function(t,e){Ci(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(Oa),Pa=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Na.Delete,r}return h(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),Ci(null==e.transformResults,"Transform results received by DeleteMutation."),new es(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&Ci(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new es(this.key,xo.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Oa);!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(ka||(ka={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(_a||(_a={}));var Ua=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(_a.Estimate,n);case"previous":return new t(_a.Previous,n);case"none":case void 0:return new t(_a.Default,n);default:return Ai("fromSnapshotOptions() called with invalid options.")}},t}(),Fa=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return Ci(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),oo(this.typeOrder,t.typeOrder)},t}(),Va=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=ka.NullValue,e.internalValue=null,e}return h(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Fa),Ba=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.BooleanValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?oo(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Fa),qa=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.NumberValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue,r=t.internalValue,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.defaultCompareTo(t);var n,r},e}(Fa);function ja(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.isEqual=function(t){return t instanceof e&&ja(this.internalValue,t.internalValue)},e}(qa),Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.isEqual=function(t){return t instanceof e&&ja(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(qa),Ga=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.StringValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?oo(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Fa),Wa=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.TimestampValue,n}return h(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Qa?-1:this.defaultCompareTo(t)},e}(Fa),Qa=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=ka.TimestampValue,r}return h(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===_a.Estimate?new Wa(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===_a.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Wa?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Fa),Ha=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.BlobValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Fa),Ya=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=ka.RefValue,r}return h(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:Eo.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Fa),Xa=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.GeoPointValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Fa),Ja=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.ObjectValue,n}return h(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal((function(n,r){e[n]=r.value(t)})),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=oo(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return oo(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(Ci(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(Ci(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){Ci(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach((function(t){n=n instanceof e?n.internalValue.get(t):null})),n},e.prototype.fieldMask=function(){var t=new Bo(To.comparator);return this.internalValue.forEach((function(n,r){var i=new To([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach((function(e){t=t.add(i.child(e))}))}else t=t.add(i)})),Aa.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Po(oo)),e}(Fa),$a=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=ka.ArrayValue,n}return h(e,t),e.prototype.value=function(t){return this.internalValue.map((function(e){return e.value(t)}))},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++){if(n[e].isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return oo(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map((function(t){return t.toString()})).join(",")+"]"},e}(Fa),Za=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return Eo.comparator(t.key,e.key)},t}(),ts=function(t){function e(e,n,r,i,o,a){var s=t.call(this,e,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,Ci(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return h(e,t),e.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.objectValue){var e=Ja.EMPTY;Pi(this.proto.fields||{},(function(n,r){e=e.set(new To([n]),t.converter(r))})),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.getProtoField=function(t){Ci(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.firstSegment()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):Ai("Trying to compare documents on fields that don't exist")},e}(Za),es=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return h(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Za),ns=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Za),rs=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Pi(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Ui(this.inner)},t}(),is=function(){function t(){this.changes=new rs((function(t){return t.toString()})),this.changesApplied=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return Ci(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(t){Ci(void 0===this._readTime||this._readTime.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=t},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.readTime=e,this.changes.set(t.key,t)},t.prototype.removeEntry=function(t,e){this.assertNotApplied(),e&&(this.readTime=e),this.changes.set(t,null)},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?ea.resolve(n):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){Ci(!this.changesApplied,"Changes have already been applied.")},t}(),os=function(){function t(t,e){this.serializer=t,this.indexManager=e}return t.prototype.addEntry=function(t,e,n){return ss(t).put(us(e),n)},t.prototype.removeEntry=function(t,e){var n=ss(t),r=us(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.setMetadata(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return ss(t).get(us(e)).next((function(t){return n.maybeDecodeDocument(t)}))},t.prototype.getSizedEntry=function(t,e){var n=this;return ss(t).get(us(e)).next((function(t){var e=n.maybeDecodeDocument(t);return e?{maybeDocument:e,size:cs(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ko();return this.forEachDbEntry(t,e,(function(t,e){var i=n.maybeDecodeDocument(e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.getSizedEntries=function(t,e){var n=this,r=Ko(),i=new Po(Eo.comparator);return this.forEachDbEntry(t,e,(function(t,e){var o=n.maybeDecodeDocument(e);o?(r=r.insert(t,o),i=i.insert(t,cs(e))):(r=r.insert(t,null),i=i.insert(t,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return ea.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return ss(t).iterate({range:r},(function(t,e,r){for(var a=Eo.fromSegments(t);o&&Eo.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this;Ci(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Wo(),o=e.path.length+1,a={};if(n.isEqual(xo.MIN)){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Ts.collectionReadTimeIndex}return ss(t).iterate(a,(function(t,n,a){if(t.length===o){var s=r.serializer.fromDbRemoteDocument(n);e.path.isPrefixOf(s.key.path)?s instanceof ts&&e.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.getNewDocumentChanges=function(t,e){var n=this,r=zo(),i=this.serializer.toDbTimestampKey(e),o=ss(t),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:Ts.readTimeIndex,range:a},(function(t,e){var o=n.serializer.fromDbRemoteDocument(e);r=r.insert(o.key,o),i=e.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},t.prototype.getLastDocumentChange=function(t){var e,n=this,r=ss(t),i=xo.MIN;return r.iterate({index:Ts.readTimeIndex,reverse:!0},(function(t,r,o){e=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()})).next((function(){return{changedDoc:e,readTime:i}}))},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this,!!e&&e.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return as(t).get(Es.key).next((function(t){return Ci(!!t,"Missing document cache metadata"),t}))},t.prototype.setMetadata=function(t,e){return as(t).put(Es.key,e)},t.prototype.maybeDecodeDocument=function(t){if(t){var e=this.serializer.fromDbRemoteDocument(t);return e instanceof es&&e.version.isEqual(xo.forDeletedDoc())?null:e}return null},t.RemoteDocumentChangeBuffer=function(t){function e(e,n){var r=t.call(this)||this;return r.documentCache=e,r.trackRemovals=n,r.documentSizes=new rs((function(t){return t.toString()})),r}return h(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Bo((function(t,e){return oo(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.documentSizes.get(o);if(Ci(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){Ci(!e.readTime.isEqual(xo.MIN),"Cannot add a document with a read time of zero");var u=e.documentCache.serializer.toDbRemoteDocument(a,e.readTime);i=i.add(o.path.popLast());var c=cs(u);r+=c-s,n.push(e.documentCache.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=e.documentCache.serializer.toDbRemoteDocument(new es(o,xo.forDeletedDoc()),e.readTime);n.push(e.documentCache.addEntry(t,o,h))}else n.push(e.documentCache.removeEntry(t,o))})),i.forEach((function(r){n.push(e.documentCache.indexManager.addToCollectionParentIndex(t,r))})),n.push(this.documentCache.updateMetadata(t,r)),ea.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next((function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next((function(t){var e=t.maybeDocuments;return t.sizeMap.forEach((function(t,e){n.documentSizes.set(t,e)})),e}))},e}(is),t}();function as(t){return Hs.getStore(t,Es.store)}function ss(t){return Hs.getStore(t,Ts.store)}function us(t){return t.path.toArray()}function cs(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ai("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hs=function(){function t(){this.collectionParentIndex=new ls}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),ea.resolve()},t.prototype.getCollectionParents=function(t,e){return ea.resolve(this.collectionParentIndex.getEntries(e))},t}(),ls=function(){function t(){this.index={}}return t.prototype.add=function(t){Ci(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Bo(bo.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Bo(bo.comparator)).toArray()},t}(),fs=9,ps=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Ci(n<r&&n>=0&&r<=fs,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new oa(e);n<1&&r>=1&&(function(t){t.createObjectStore(ms.store)}(t),function(t){t.createObjectStore(gs.store,{keyPath:gs.keyPath}),t.createObjectStore(ys.store,{keyPath:ys.keyPath,autoIncrement:!0}).createIndex(ys.userMutationsIndex,ys.userMutationsKeyPath,{unique:!0}),t.createObjectStore(vs.store)}(t),Cs(t),function(t){t.createObjectStore(Ts.store)}(t));var a=ea.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(Ss.store),t.deleteObjectStore(Is.store),t.deleteObjectStore(Ns.store)}(t),Cs(t)),a=a.next((function(){return function(t){var e=t.store(Ns.store),n=new Ns(0,0,xo.MIN.toTimestamp(),0);return e.put(Ns.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(ys.store).loadAll().next((function(n){t.deleteObjectStore(ys.store),t.createObjectStore(ys.store,{keyPath:ys.keyPath,autoIncrement:!0}).createIndex(ys.userMutationsIndex,ys.userMutationsKeyPath,{unique:!0});var r=e.store(ys.store),i=n.map((function(t){return r.put(t)}));return ea.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(Ds.store,{keyPath:Ds.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(Es.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ts.store);e.createIndex(Ts.readTimeIndex,Ts.readTimeIndexPath,{unique:!1}),e.createIndex(Ts.collectionReadTimeIndex,Ts.collectionReadTimeIndexPath,{unique:!1})}(e)}))),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ts.store).iterate((function(t,n){e+=cs(n)})).next((function(){var n=new Es(e);return t.store(Es.store).put(Es.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(gs.store),r=t.store(ys.store);return n.loadAll().next((function(n){return ea.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(ys.userMutationsIndex,i).next((function(r){return ea.forEach(r,(function(r){Ci(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return fa(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ss.store),n=t.store(Ts.store);return Ia(t).next((function(t){var r=[];return n.iterate((function(n,i){var o=new bo(n),a=function(t){return[0,_o(t)]}(o);r.push(e.get(a).next((function(n){return n?ea.resolve():function(n){return e.put(new Ss(0,_o(n),t))}(o)})))})).next((function(){return ea.waitFor(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(As.store,{keyPath:As.keyPath});var n=e.store(As.store),r=new ls,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:_o(i)})}};return e.store(Ts.store).iterate({keysOnly:!0},(function(t,e){var n=new bo(t);return i(n.popLast())})).next((function(){return e.store(vs.store).iterate({keysOnly:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Mo(n));return i(r.popLast())}))}))},t}();var ds=function(t,e){this.seconds=t,this.nanoseconds=e},ms=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();var gs=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),ys=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();var vs=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,_o(e)]},t.key=function(t,e,n){return[t,_o(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();var bs=function(t,e){this.path=t,this.readTime=e},ws=function(t,e){this.path=t,this.version=e},Ts=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),Es=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();var Is=function(){function t(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),Ss=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,Ci(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Ns=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),As=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function Cs(t){t.createObjectStore(Ss.store,{keyPath:Ss.keyPath}).createIndex(Ss.documentTargetsIndex,Ss.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Is.store,{keyPath:Is.keyPath}).createIndex(Is.queryTargetsIndexName,Is.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ns.store)}var Ds=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}();var ks,_s=g([gs.store,ys.store,vs.store,Ts.store,Is.store,ms.store,Ns.store,Ss.store],[Ds.store]),Rs=g(_s,[Es.store]),Os=g(Rs,[As.store]),Ms=function(){function t(){this.collectionParentsCache=new ls}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(Ci(e.length%2==1,"Expected a collection path."),!this.collectionParentsCache.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.collectionParentsCache.add(e)}));var o={collectionId:r,parent:_o(i)};return Ls(t).put(o)}return ea.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[so(e),""],!1,!0);return Ls(t).loadAll(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Mo(o.parent))}return n}))},t}();function Ls(t){return Hs.getStore(t,As.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(ks||(ks={}));var xs=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=xo.MIN),void 0===o&&(o=xo.MIN),void 0===a&&(a=ki()),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken===t.resumeToken&&this.target.isEqual(t.target)},t}(),Ps=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Eo.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new es(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=Eo.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new ns(e,n)}return Ai("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t,e){var n=this.toDbTimestampKey(e),r=t.key.path.popLast().toArray();if(t instanceof ts){var i=t.proto?t.proto:this.remoteSerializer.toDocument(t),o=t.hasCommittedMutations;return new Ts(null,null,i,o,n,r)}if(t instanceof es){var a=t.key.path.toArray(),s=this.toDbTimestamp(t.version);o=t.hasCommittedMutations;return new Ts(null,new bs(a,s),null,o,n,r)}if(t instanceof ns){a=t.key.path.toArray();var u=this.toDbTimestamp(t.version);return new Ts(new ws(a,u),null,null,!0,n,r)}return Ai("Unexpected MaybeDocument")},t.prototype.toDbTimestampKey=function(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]},t.prototype.fromDbTimestampKey=function(t){var e=new Lo(t[0],t[1]);return xo.fromTimestamp(e)},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new ds(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Lo(t.seconds,t.nanoseconds);return xo.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.remoteSerializer.toMutation(t)})),i=e.mutations.map((function(t){return n.remoteSerializer.toMutation(t)}));return new ys(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.remoteSerializer.fromMutation(t)})),r=t.mutations.map((function(t){return e.remoteSerializer.fromMutation(t)})),i=Lo.fromMillis(t.localWriteTimeMs);return new Zo(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach((function(t){e.push(_o(t.path))})),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Xo(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new Eo(Mo(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(t.lastLimboFreeSnapshotVersion):xo.MIN,i=t.resumeToken;return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new xs(e,t.targetId,ks.Listen,t.lastListenSequenceNumber,n,r,i)},t.prototype.toDbTarget=function(t){Ci(ks.Listen===t.purpose,"Only queries with purpose "+ks.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion),i=this.toDbTimestamp(t.lastLimboFreeSnapshotVersion);return e=t.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.target):this.remoteSerializer.toQueryTarget(t.target),t.resumeToken instanceof Uint8Array?(Ci(ra.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new Is(t.targetId,t.target.canonicalId(),r,n,t.sequenceNumber,i,e)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Us(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=oo(n,i);return 0===a?oo(r,o):a}var Fs=function(){function t(t){this.maxElements=t,this.buffer=new Bo(Us),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Us(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Vs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bs=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),qs=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}return t.prototype.start=function(){Ci(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Bs.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;Ci(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;Ii("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(ho.LruGarbageCollection,e,(function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then((function(){return t.scheduleGC()})).catch(Ys)}))},t}(),js=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return ea.resolve(yo.INVALID);var r=new Fs(e);return this.delegate.forEachTarget(t,(function(t){return r.addElement(t.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,(function(t){return r.addElement(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===Bs.COLLECTION_DISABLED?(Ii("LruGarbageCollector","Garbage collection skipped; disabled"),ea.resolve(Vs)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ii("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Vs):n.runGarbageCollection(t,e)}))},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,i,o,a,s,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Ii("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){(u=Date.now(),Ti()<=fi.DEBUG)&&Ii("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-h)+"ms");return ea.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),zs=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Ks="IndexedDbPersistence",Gs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ws="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Qs=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return h(e,t),e}(zs),Hs=function(){function t(e,n,r,i,o,a,s,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},this.referenceDelegate=new $s(this,o),this.dbName=n+t.MAIN_DATABASE,this.serializer=new Ps(s),this.document=i.document,this.targetCache=new wa(this.referenceDelegate,this.serializer),this.indexManager=new Ms,this.remoteDocumentCache=new os(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new Ri(_i.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Qs)return ra.getStore(t.simpleDbTransaction,e);throw Ai("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e){return f(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:if(!t.isAvailable())throw new Ri(_i.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.lruParams,e.queue,e.serializer,e.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}}))}))},t.prototype.start=function(){var t=this;return Ci(!this.started,"IndexedDbPersistence double-started!"),Ci(null!==this.window,"Expected 'window' to be defined"),ra.openOrCreate(this.dbName,fs,new ps(this.serializer)).then((function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()})).then((function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.simpleDb.runTransaction("readonly-idempotent",[Ns.store],(function(t){return Ia(t)}))})).then((function(e){t.listenSequence=new yo(e,t.sequenceNumberSyncer)})).then((function(){t._started=!0})).catch((function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)}))},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return f(e,void 0,void 0,(function(){return p(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener((function(n){return f(e,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget((function(){return f(e,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite-idempotent",Os,(function(e){return Js(e).put(new Ds(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next((function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget((function(){return t.primaryStateListener(!1)})))}))})).next((function(){return t.canActAsPrimary(e)})).next((function(n){return t.isPrimary&&!n?t.releasePrimaryLeaseIfHeld(e).next((function(){return!1})):!!n&&t.acquireOrExtendPrimaryLease(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return Ii(Ks,"Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.queue.enqueueAndForget((function(){return t.primaryStateListener(e)})),t.isPrimary=e}))},t.prototype.verifyPrimaryLease=function(t){var e=this;return Xs(t).get(ms.key).next((function(t){return ea.resolve(e.isLocalClient(t))}))},t.prototype.removeClientMetadata=function(t){return Js(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return f(this,void 0,void 0,(function(){var e=this;return p(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(n){var r=t.getStore(n,Ds.store);return r.loadAll().next((function(t){var n=e.filterActiveClients(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return ea.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.zombiedClientLocalStorageKey(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(ho.ClientMetadataRefresh,4e3,(function(){return t.updateClientMetadataAndTryBecomePrimary().then((function(){return t.maybeGarbageCollectMultiClientState()})).then((function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return Xs(t).get(ms.key).next((function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new Ri(_i.FAILED_PRECONDITION,Ws);return!1}}return!(!e.networkEnabled||!e.inForeground)||Js(t).loadAll().next((function(t){return void 0===e.filterActiveClients(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ii(Ks,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return f(this,void 0,void 0,(function(){var t=this;return p(this,(function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[ms.store,Ds.store],(function(e){return t.releasePrimaryLeaseIfHeld(e).next((function(){return t.removeClientMetadata(e)}))}))];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter((function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)}))},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly-idempotent",[Ds.store],(function(e){return Js(e).loadAll().next((function(e){return t.filterActiveClients(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return f(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,ra.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return Ci(this.started,"Cannot initialize MutationQueue before persistence is started."),ha.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getTargetCache=function(){return Ci(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},t.prototype.getRemoteDocumentCache=function(){return Ci(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return Ci(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;Ii(Ks,"Starting transaction:",t);var i,o=e.endsWith("idempotent"),a=e.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,Os,(function(o){return i=new Qs(o,r.listenSequence.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.verifyPrimaryLease(o).next((function(t){return!!t||r.canActAsPrimary(o)})).next((function(e){if(!e)throw Si("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new Ri(_i.FAILED_PRECONDITION,Gs);return n(i)})).next((function(t){return r.acquireOrExtendPrimaryLease(o).next((function(){return t}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return Xs(t).get(ms.key).next((function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new Ri(_i.FAILED_PRECONDITION,Ws)}))},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new ms(this.clientId,this.allowTabSynchronization,Date.now());return Xs(t).put(ms.key,e)},t.isAvailable=function(){return ra.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Xs(t);return n.get(ms.key).next((function(t){return e.isLocalClient(t)?(Ii(Ks,"Releasing primary lease."),n.delete(ms.key)):ea.resolve()}))},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(Si("Detected an update time that is in the future: "+t+" > "+n),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(Ci(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(Ci("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return Ii(Ks,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Si(Ks,"Failed to get zombied client id.",t),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){Si("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Ys(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){if(!function(t){return t.code===_i.FAILED_PRECONDITION&&t.message===Gs}(t))throw t;return Ii(Ks,"Unexpectedly lost primary lease"),[2]}))}))}function Xs(t){return t.store(ms.store)}function Js(t){return t.store(Ds.store)}var $s=function(){function t(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new js(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,(function(t,n){return e(n)}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Zs(t,e)},t.prototype.removeReference=function(t,e){return Zs(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Zs(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?ea.resolve(!0):function(t,e){var n=!1;return ga(t).iterateSerial((function(r){return la(t,r,e).next((function(t){return t&&(n=!0),ea.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(t,(function(a,s){if(s<=e){var u=n.isPinned(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),Sa(t).delete([0,_o(a.path)])}))}));i.push(u)}})).next((function(){return ea.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Zs(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=Sa(t),i=yo.INVALID;return r.iterate({index:Ss.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==yo.INVALID&&e(new Eo(Mo(n)),i),i=s,n=a):i=yo.INVALID})).next((function(){i!==yo.INVALID&&e(new Eo(Mo(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Zs(t,e){return Sa(t).put(function(t,e){return new Ss(0,_o(t.path),e)}(e,t.currentSequenceNumber))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tu=Number,eu=tu.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),nu=tu.MAX_SAFE_INTEGER||Math.pow(2,53)-1,ru=tu.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function iu(t){return null==t}function ou(t){return ru(t)&&t<=nu&&t>=eu}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var au,su=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}iu(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t=this.path.canonicalString();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),iu(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.isDocumentQuery=function(){return Eo.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t.First="F",t.Last="L"}(au||(au={}));var uu=function(){function t(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=au.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[wu]:this.memoizedOrderBy=[new bu(t),wu];else{Ci(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:yu.ASCENDING;this.memoizedOrderBy.push(a===yu.ASCENDING?wu:Tu)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){Ci(null==this.getInequalityFilterField()||!(e instanceof lu)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),Ci(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){Ci(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.withLimitToFirst=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,au.First,this.startAt,this.endAt)},t.prototype.withLimitToLast=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,au.Last,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},t.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},t.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},t.prototype.isEqual=function(t){return this.toTarget().isEqual(t.toTarget())&&this.limitType===t.limitType},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return Ci(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimitToFirst=function(){return!iu(this.limit)&&this.limitType===au.First},t.prototype.hasLimitToLast=function(){return!iu(this.limit)&&this.limitType===au.Last},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof lu&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof lu&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===au.First)this.memoizedTarget=new su(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===yu.DESCENDING?yu.ASCENDING:yu.DESCENDING;t.push(new bu(r.field,i))}var o=this.endAt?new vu(this.endAt.position,!this.endAt.before):null,a=this.startAt?new vu(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new su(this.path,this.collectionGroup,t,this.filters,this.limit,o,a)}return this.memoizedTarget},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):Eo.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){Ci(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),cu=function(){},hu=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return Ai("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),lu=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return h(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===hu.IN?(Ci(r instanceof $a,"Comparing on key with IN, but filter value not an ArrayValue"),Ci(r.internalValue.every((function(t){return t instanceof Ya})),"Comparing on key with IN, but an array value was not a RefValue"),new pu(t,r)):(Ci(r instanceof Ya,"Comparing on key, but filter value not a RefValue"),Ci(n!==hu.ARRAY_CONTAINS&&n!==hu.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new fu(t,n,r));if(r.isEqual(Va.INSTANCE)){if(n!==hu.EQUAL)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Ka.NAN)){if(n!==hu.EQUAL)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===hu.ARRAY_CONTAINS?new du(t,r):n===hu.IN?(Ci(r instanceof $a,"IN filter has invalid value: "+r.toString()),new mu(t,r)):n===hu.ARRAY_CONTAINS_ANY?(Ci(r instanceof $a,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new gu(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case hu.LESS_THAN:return t<0;case hu.LESS_THAN_OR_EQUAL:return t<=0;case hu.EQUAL:return 0===t;case hu.GREATER_THAN:return t>0;case hu.GREATER_THAN_OR_EQUAL:return t>=0;default:return Ai("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return[hu.LESS_THAN,hu.LESS_THAN_OR_EQUAL,hu.GREATER_THAN,hu.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(cu),fu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.matches=function(t){var e=this.value,n=Eo.comparator(t.key,e.key);return this.matchesComparison(n)},e}(lu),pu=function(t){function e(e,n){var r=t.call(this,e,hu.IN,n)||this;return r.value=n,r}return h(e,t),e.prototype.matches=function(t){return this.value.internalValue.some((function(e){return t.key.isEqual(e.key)}))},e}(lu),du=function(t){function e(e,n){return t.call(this,e,hu.ARRAY_CONTAINS,n)||this}return h(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof $a&&e.contains(this.value)},e}(lu),mu=function(t){function e(e,n){var r=t.call(this,e,hu.IN,n)||this;return r.value=n,r}return h(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(lu),gu=function(t){function e(e,n){var r=t.call(this,e,hu.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return h(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof $a&&n.internalValue.some((function(t){return e.value.contains(t)}))},e}(lu),yu=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),vu=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){Ci(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())Ci(o instanceof Ya,"Bound has a non-key value where the key path is being used."),n=Eo.comparator(o.key,e.key);else{var a=e.field(i.field);Ci(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===yu.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),bu=function(){function t(t,e){this.field=t,void 0===e&&(e=yu.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?ts.compareByKey(t,e):ts.compareByField(this.field,t,e);switch(this.dir){case yu.ASCENDING:return n;case yu.DESCENDING:return-1*n;default:return Ai("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),wu=new bu(To.keyField(),yu.ASCENDING),Tu=new bu(To.keyField(),yu.DESCENDING),Eu=function(){function t(){}return t.prototype.setLocalDocumentsView=function(t){this.localDocumentsView=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return Ci(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),e.matchesAllDocuments()?this.executeFullCollectionScan(t,e):n.isEqual(xo.MIN)?this.executeFullCollectionScan(t,e):this.localDocumentsView.getDocuments(t,r).next((function(o){var a=i.applyQuery(e,o);return(e.hasLimitToFirst()||e.hasLimitToLast())&&i.needsRefill(e.limitType,a,r,n)?i.executeFullCollectionScan(t,e):(Ti()<=fi.DEBUG&&Ii("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),i.localDocumentsView.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.applyQuery=function(t,e){var n=new Bo((function(e,n){return t.docComparator(e,n)}));return e.forEach((function(e,r){r instanceof ts&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.needsRefill=function(t,e,n,r){if(n.size!==e.size)return!0;var i=t===au.First?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.executeFullCollectionScan=function(t,e){return Ti()<=fi.DEBUG&&Ii("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.localDocumentsView.getDocumentsMatchingQuery(t,e,xo.MIN)},t}(),Iu=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.getDocumentInternal(t,e,r)}))},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].applyToLocalView(e,t)}return t}))},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Ko();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].applyToLocalView(t,e)}r=r.insert(t,e)})),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e)}))},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=zo();return i.forEach((function(t,e){e||(e=new es(t,xo.forDeletedDoc())),o=o.insert(t,e)})),o}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Eo(e)).next((function(t){var e=Wo();return t instanceof ts&&(e=e.insert(t.key,t)),e}))},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e,n){var r=this;Ci(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=Wo();return this.indexManager.getCollectionParents(t,i).next((function(a){return ea.forEach(a,(function(a){var s=e.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.addMissingBaseDocuments(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);r=l instanceof ts?r.insert(c,l):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Xo(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof La&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof ts&&(c=c.insert(t,e))})),c}))},t}(),Su=function(){function t(){this.refsByKey=new Bo(Nu.compareByKey),this.refsByTarget=new Bo(Nu.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Nu(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.removeRef(new Nu(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.removeReferencesForId=function(t){var e=this,n=Eo.EMPTY,r=new Nu(n,t),i=new Nu(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(t){e.removeRef(t),o.push(t.key)})),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach((function(e){return t.removeRef(e)}))},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=Eo.EMPTY,n=new Nu(e,t),r=new Nu(e,t+1),i=Xo();return this.refsByTarget.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Nu(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Nu=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return Eo.comparator(t.key,e.key)||oo(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return oo(t.targetOrBatchId,e.targetOrBatchId)||Eo.comparator(t.key,e.key)},t}(),Au=function(){function t(t,e,n){this.persistence=t,this.queryEngine=e,this.localViewReferences=new Su,this.targetDataByTarget=new Po(oo),this.targetIdByTarget=new rs((function(t){return t.canonicalId()})),this.lastDocumentChangeReadTime=xo.MIN,Ci(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(n),this.remoteDocuments=t.getRemoteDocumentCache(),this.targetCache=t.getTargetCache(),this.localDocuments=new Iu(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return t.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},t.prototype.handleUserChange=function(t){return f(this,void 0,void 0,(function(){var e,n,r,i=this;return p(this,(function(o){switch(o.label){case 0:return e=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,e=i.persistence.getMutationQueue(t),n=new Iu(i.remoteDocuments,e,i.persistence.getIndexManager()),e.getAllMutationBatches(r)})).next((function(t){for(var e=[],i=[],a=Xo(),s=0,u=o;s<u.length;s++){var c=u[s];e.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p];i.push(c.batchId);for(var m=0,g=c.mutations;m<g.length;m++){f=g[m];a=a.add(f.key)}}return n.getDocuments(r,a).next((function(t){return{affectedDocuments:t,removedBatchIds:e,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=e,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},t.prototype.localWrite=function(t){var e,n=this,r=Lo.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Xo());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){e=i;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],h=c.extractBaseValue(e.get(c.key));null!=h&&a.push(new La(c.key,h,h.fieldMask(),Ra.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,t)}))})).then((function(t){var n=t.applyToLocalDocumentSet(e);return{batchId:t.batchId,changes:n}}))},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return e.mutationQueue.lookupMutationKeys(n,t).next((function(t){return t?e.localDocuments.getDocuments(n,t):ea.resolve(null)}))}))},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next((function(){return e.applyWriteToRemoteDocuments(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next((function(t){return Ci(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(e){return t.mutationQueue.getLastStreamToken(e)}))},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return e.mutationQueue.setLastStreamToken(n,t)}))},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)}))},t.prototype.applyRemoteEvent=function(e){var n=this,r=e.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;var s=[];xi(e.targetChanges,(function(e,a){var u=i.get(e);if(u){s.push(n.targetCache.removeMatchingKeys(o,a.removedDocuments,e).next((function(){return n.targetCache.addMatchingKeys(o,a.addedDocuments,e)})));var c=a.resumeToken;if(c.length>0){var h=u.withResumeToken(c,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(e,h),t.shouldPersistTargetData(u,h,a)&&s.push(n.targetCache.updateTargetData(o,h))}}}));var u=zo(),c=Xo();if(e.documentUpdates.forEach((function(t,e){c=c.add(t)})),s.push(a.getEntries(o,c).next((function(t){e.documentUpdates.forEach((function(i,c){var h=t.get(i);c instanceof es&&c.version.isEqual(xo.MIN)?(a.removeEntry(i,r),u=u.insert(i,c)):null==h||c.version.compareTo(h.version)>0||0===c.version.compareTo(h.version)&&h.hasPendingWrites?(Ci(!xo.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),a.addEntry(c,r),u=u.insert(i,c)):Ii("LocalStore","Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))}))}))),!r.isEqual(xo.MIN)){var h=n.targetCache.getLastRemoteSnapshotVersion(o).next((function(t){return Ci(r.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,r)}));s.push(h)}return ea.waitFor(s).next((function(){return a.apply(o)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(o,u)}))})).then((function(t){return n.targetDataByTarget=i,t}))},t.shouldPersistTargetData=function(t,e,n){return Ci(e.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.length||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)},t.prototype.notifyLocalViewChanges=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);Ci(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return ea.forEach(t,(function(t){return ea.forEach(t.removedKeys,(function(t){return e.persistence.referenceDelegate.removeReference(n,t)}))}))}))},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)}))},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return e.localDocuments.getDocument(n,t)}))},t.prototype.allocateTarget=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return e.targetCache.getTargetData(n,t).next((function(i){return i?(r=i,ea.resolve(r)):e.targetCache.allocateTargetId(n).next((function(i){return r=new xs(t,i,ks.Listen,n.currentSequenceNumber),e.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.targetDataByTarget.get(n.targetId)&&(e.targetDataByTarget=e.targetDataByTarget.insert(n.targetId,n),e.targetIdByTarget.set(t,n.targetId)),n}))},t.prototype.getTargetData=function(t,e){var n=this.targetIdByTarget.get(e);return void 0!==n?ea.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(t,e)},t.prototype.releaseTarget=function(t,e){var n=this,r=this.targetDataByTarget.get(t);Ci(null!==r,"Tried to release nonexistent target: "+t);var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.localViewReferences.removeReferencesForId(t);return e?ea.resolve():ea.forEach(o,(function(t){return n.persistence.referenceDelegate.removeReference(i,t)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(r.target)}))},t.prototype.executeQuery=function(t,e){var n=this,r=xo.MIN,i=Xo();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,t.toTarget()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,t,e?r:xo.MIN,e?i:Xo())})).next((function(t){return{documents:t,remoteKeys:i}}))}))},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return e.targetCache.getMatchingKeysForTargetId(n,t)}))},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=ea.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(t,r)})).next((function(t){var o=t,a=e.docVersions.get(r);Ci(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o,e.commitVersion):Ci(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(t,i)}))},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return t.collect(n,e.targetDataByTarget)}))},t.prototype.getTarget=function(t){var e=this,n=this.targetDataByTarget.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return e.targetCache.getTargetDataForTarget(n,t).next((function(t){return t?t.target:null}))}))},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(e){return t.remoteDocuments.getNewDocumentChanges(e,t.lastDocumentChangeReadTime)})).then((function(e){var n=e.changedDocs,r=e.readTime;return t.lastDocumentChangeReadTime=r,n}))},t.prototype.synchronizeLastDocumentChangeReadTime=function(){return f(this,void 0,void 0,(function(){var t,e=this;return p(this,(function(n){return this.remoteDocuments instanceof os?(t=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(e){return t.getLastDocumentChange(e)})).then((function(t){var n=t.readTime;e.lastDocumentChangeReadTime=n}))]):[2]}))}))},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Cu=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=ki(),this.batchesByDocumentKey=new Bo(Nu.compareByKey)}return t.prototype.checkEmpty=function(t){return ea.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");Ci(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return Ci(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,ea.resolve()},t.prototype.getLastStreamToken=function(t){return ea.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,ea.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){Ci(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&Ci(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Zo(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Nu(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return ea.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return ea.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return Ci(null!=n,"Failed to find local mutation batch."),ea.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return ea.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return ea.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},t.prototype.getAllMutationBatches=function(t){return ea.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Nu(e,0),i=new Nu(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(t){Ci(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);Ci(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),ea.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bo(oo);return e.forEach((function(t){var e=new Nu(t,0),i=new Nu(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],(function(e){Ci(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)}))})),ea.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){Ci(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;Eo.isDocumentKey(i)||(i=i.child(""));var o=new Nu(new Eo(i),0),a=new Bo(oo);return this.batchesByDocumentKey.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)}),o),ea.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Ci(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return ea.forEach(e.mutations,(function(i){var o=new Nu(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)})).next((function(){n.batchesByDocumentKey=r}))},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new Nu(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return ea.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&Ci(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),ea.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return Ci(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return Ci(n.batchId===t,"If found batch must match"),n},t}();var Du,ku=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new Po(Eo.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){Ci(!n.isEqual(xo.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return ea.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ko();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),ea.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){Ci(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Wo(),i=new Eo(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||c instanceof ts&&e.matches(c)&&(r=r.insert(c.key,c))}return ea.resolve(r)},t.prototype.forEachDocumentKey=function(t,e){return ea.forEach(this.docs,(function(t){return e(t)}))},t.prototype.getNewDocumentChanges=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return ea.resolve(this.size)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return h(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i?n.push(e.documentCache.addEntry(t,i,e.readTime)):e.documentCache.removeEntry(r)})),ea.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},e}(is),t}(),_u=function(){function t(t){this.persistence=t,this.targets=new rs((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=xo.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Su,this.targetCount=0,this.targetIdGenerator=ba.forTargetCache()}return t.prototype.forEachTarget=function(t,e){return this.targets.forEach((function(t,n){return e(n)})),ea.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return ea.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return ea.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,ea.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),ea.resolve()},t.prototype.saveTargetData=function(t){this.targets.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return Ci(!this.targets.has(e.target),"Adding a target that already exists"),this.saveTargetData(e),this.targetCount+=1,ea.resolve()},t.prototype.updateTargetData=function(t,e){return Ci(this.targets.has(e.target),"Updating a non-existent target"),this.saveTargetData(e),ea.resolve()},t.prototype.removeTargetData=function(t,e){return Ci(this.targetCount>0,"Removing a target from an empty cache"),Ci(this.targets.has(e.target),"Removing a non-existent target from the cache"),this.targets.delete(e.target),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,ea.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),ea.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return ea.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.targets.get(e)||null;return ea.resolve(n)},t.prototype.getTargetDataForTarget=function(t,e){return Ai("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.addReference(t,e))})),ea.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.removeReference(t,e))})),ea.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),ea.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return ea.resolve(n)},t.prototype.containsKey=function(t,e){return ea.resolve(this.references.containsKey(e))},t}(),Ru=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new yo(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new _u(this);this.indexManager=new hs,this.remoteDocumentCache=new ku(this.indexManager,(function(t){return n.referenceDelegate.documentSize(t)}))}return t.createLruPersistence=function(e,n,r){return new t(e,(function(t){return new Lu(t,new Ps(n),r)}))},t.createEagerPersistence=function(e){return new t(e,(function(t){return new Mu(t)}))},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){return[2,[this.clientId]]}))}))},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Cu(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.targetCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;Ii("MemoryPersistence","Starting transaction:",t);var i=new Ou(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(t){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.mutationQueuesContainKey=function(t,e){return ea.or((n=this.mutationQueues,r=[],Pi(n,(function(t,e){return r.push(e)})),r).map((function(n){return function(){return n.containsKey(t,e)}})));var n,r},t}(),Ou=function(t){function e(e){var n=t.call(this)||this;return n.currentSequenceNumber=e,n}return h(e,t),e}(zs),Mu=function(){function t(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(t.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Ai("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),ea.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),ea.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),ea.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.orphanedDocuments.add(t)}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ea.forEach(this.orphanedDocuments,(function(r){return e.isReferenced(t,r).next((function(t){t||n.removeEntry(r)}))})).next((function(){return e._orphanedDocuments=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next((function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)}))},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return ea.or([function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return ea.resolve(n.inMemoryPins.containsKey(e))}])},t}(),Lu=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new rs((function(t){return _o(t.path)})),this.garbageCollector=new js(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return ea.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return ea.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(t,r,i).next((function(t){return t?ea.resolve():e(i)}))}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(t,(function(i){return n.isPinned(t,i,e).next((function(t){t||(r++,o.removeEntry(i))}))})).next((function(){return o.apply(t)})).next((function(){return r}))},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),ea.resolve()},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),ea.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),ea.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),ea.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t,t.version);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ai("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return ea.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return ea.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getTargetCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return ea.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),xu=1e3,Pu=1.5,Uu=6e4,Fu=function(){function t(t,e,n,r,i){void 0===n&&(n=xu),void 0===r&&(r=Pu),void 0===i&&(i=Uu),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&Ii("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return e.lastAttemptTime=Date.now(),t()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff"}(Du||(Du={}));var Vu,Bu,qu=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Du.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Fu(t,e)}return t.prototype.isStarted=function(){return this.state===Du.Starting||this.state===Du.Open||this.state===Du.Backoff},t.prototype.isOpen=function(){return this.state===Du.Open},t.prototype.start=function(){this.state!==Du.Error?(Ci(this.state===Du.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(Du.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.inhibitBackoff=function(){Ci(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Du.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return t.handleIdleCloseTimer()})))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){return this.isOpen()?[2,this.close(Du.Initial)]:[2]}))}))},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return f(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return Ci(this.isStarted(),"Only started streams should be closed."),Ci(t===Du.Error||iu(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==Du.Error?this.backoff.reset():e&&e.code===_i.RESOURCE_EXHAUSTED?(Si(e.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===_i.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;Ci(this.state===Du.Initial,"Must be in initial state to auth"),this.state=Du.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(e){t.closeCount===n&&t.startStream(e)}),(function(n){e((function(){var e=new Ri(_i.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)}))}))},t.prototype.startStream=function(t){var e=this;Ci(this.state===Du.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen((function(){n((function(){return Ci(e.state===Du.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=Du.Open,e.listener.onOpen()}))})),this.stream.onClose((function(t){n((function(){return e.handleStreamClose(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.performBackoff=function(){var t=this;Ci(this.state===Du.Error,"Should only perform backoff when in Error state"),this.state=Du.Backoff,this.backoff.backoffAndRun((function(){return f(t,void 0,void 0,(function(){return p(this,(function(t){return Ci(this.state===Du.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Du.Initial,this.start(),Ci(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},t.prototype.handleStreamClose=function(t){return Ci(this.isStarted(),"Can't handle server close on non-started stream"),Ii("PersistentStream","close with error: "+t),this.stream=null,this.close(Du.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget((function(){return e.closeCount===t?n():(Ii("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),ju=function(t){function e(e,n,r,i,o){var a=t.call(this,e,ho.ListenStreamConnectionBackoff,ho.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return h(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(qu),zu=function(t){function e(e,n,r,i,o){var a=t.call(this,e,ho.WriteStreamConnectionBackoff,ho.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=ki(),a}return h(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(Ci(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return Ci(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){Ci(this.isOpen(),"Writing handshake requires an opened stream"),Ci(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;Ci(this.isOpen(),"Writing mutations requires an opened stream"),Ci(this.handshakeComplete_,"Handshake must be complete before writing mutations"),Ci(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map((function(t){return e.serializer.toMutation(t)}))};this.sendRequest(n)},e}(qu),Ku=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new zu(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new ju(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map((function(t){return e.serializer.toMutation(t)}))};return this.invokeRPC("Commit",n).then((function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)}))},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map((function(t){return e.serializer.toName(t)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=zo();n.forEach((function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);Ci(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(t,e,r)})).catch((function(t){throw t.code===_i.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(t,e,r)})).catch((function(t){throw t.code===_i.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t}(),Gu=function(){function t(t){this.datastore=t,this.readVersions=Ho(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return f(this,void 0,void 0,(function(){var e,n=this;return p(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ri(_i.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach((function(t){t instanceof es||t instanceof ts?n.recordVersion(t):Ai("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Pa(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return f(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach((function(e){t=t.remove(e.key)})),!t.isEmpty())throw new Ri(_i.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t instanceof ts)e=t.version;else{if(!(t instanceof es))throw Ai("Document in a transaction was a "+t.constructor.name);e=xo.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Ri(_i.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?Ra.updateTime(e):Ra.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(xo.forDeletedDoc()))throw new Ri(_i.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ra.updateTime(e)}return Ra.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){Ci(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(Vu||(Vu={})),function(t){t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState"}(Bu||(Bu={}));
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wu,Qu=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Vu.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Vu.Unknown),Ci(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(ho.OnlineStateTimeout,1e4,(function(){return t.onlineStateTimer=null,Ci(t.state===Vu.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(Vu.Offline),Promise.resolve()})))},t.prototype.handleWatchStreamFailure=function(t){this.state===Vu.Online?(this.setAndBroadcast(Vu.Unknown),Ci(0===this.watchStreamFailures,"watchStreamFailures must be 0"),Ci(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(Vu.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Vu.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(Si(e),this.shouldWarnClientIsOffline=!1):Ii("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function Hu(t){switch(t){case _i.OK:return Ai("Treated status OK as error");case _i.CANCELLED:case _i.UNKNOWN:case _i.DEADLINE_EXCEEDED:case _i.RESOURCE_EXHAUSTED:case _i.INTERNAL:case _i.UNAVAILABLE:case _i.UNAUTHENTICATED:return!1;case _i.INVALID_ARGUMENT:case _i.NOT_FOUND:case _i.ALREADY_EXISTS:case _i.PERMISSION_DENIED:case _i.FAILED_PRECONDITION:case _i.ABORTED:case _i.OUT_OF_RANGE:case _i.UNIMPLEMENTED:case _i.DATA_LOSS:return!0;default:return Ai("Unknown status code: "+t)}}function Yu(t){if(void 0===t)return Si("GRPC error has no .code"),_i.UNKNOWN;switch(t){case Wu.OK:return _i.OK;case Wu.CANCELLED:return _i.CANCELLED;case Wu.UNKNOWN:return _i.UNKNOWN;case Wu.DEADLINE_EXCEEDED:return _i.DEADLINE_EXCEEDED;case Wu.RESOURCE_EXHAUSTED:return _i.RESOURCE_EXHAUSTED;case Wu.INTERNAL:return _i.INTERNAL;case Wu.UNAVAILABLE:return _i.UNAVAILABLE;case Wu.UNAUTHENTICATED:return _i.UNAUTHENTICATED;case Wu.INVALID_ARGUMENT:return _i.INVALID_ARGUMENT;case Wu.NOT_FOUND:return _i.NOT_FOUND;case Wu.ALREADY_EXISTS:return _i.ALREADY_EXISTS;case Wu.PERMISSION_DENIED:return _i.PERMISSION_DENIED;case Wu.FAILED_PRECONDITION:return _i.FAILED_PRECONDITION;case Wu.ABORTED:return _i.ABORTED;case Wu.OUT_OF_RANGE:return _i.OUT_OF_RANGE;case Wu.UNIMPLEMENTED:return _i.UNIMPLEMENTED;case Wu.DATA_LOSS:return _i.DATA_LOSS;default:return Ai("Unknown status code: "+t)}}function Xu(t){if(void 0===t)return Wu.OK;switch(t){case _i.OK:return Wu.OK;case _i.CANCELLED:return Wu.CANCELLED;case _i.UNKNOWN:return Wu.UNKNOWN;case _i.DEADLINE_EXCEEDED:return Wu.DEADLINE_EXCEEDED;case _i.RESOURCE_EXHAUSTED:return Wu.RESOURCE_EXHAUSTED;case _i.INTERNAL:return Wu.INTERNAL;case _i.UNAVAILABLE:return Wu.UNAVAILABLE;case _i.UNAUTHENTICATED:return Wu.UNAUTHENTICATED;case _i.INVALID_ARGUMENT:return Wu.INVALID_ARGUMENT;case _i.NOT_FOUND:return Wu.NOT_FOUND;case _i.ALREADY_EXISTS:return Wu.ALREADY_EXISTS;case _i.PERMISSION_DENIED:return Wu.PERMISSION_DENIED;case _i.FAILED_PRECONDITION:return Wu.FAILED_PRECONDITION;case _i.ABORTED:return Wu.ABORTED;case _i.OUT_OF_RANGE:return Wu.OUT_OF_RANGE;case _i.UNIMPLEMENTED:return Wu.UNIMPLEMENTED;case _i.DATA_LOSS:return Wu.DATA_LOSS;default:return Ai("Unknown status code: "+t)}}!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(Wu||(Wu={}));
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ju,$u,Zu=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Eo.comparator(e.key,n.key)}:function(t,e){return Eo.comparator(t.key,e.key)},this.keyedMap=Wo(),this.sortedSet=new Po(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Ju||(Ju={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}($u||($u={}));var tc,ec=function(){function t(){this.changeMap=new Po(Eo.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Ju.Added&&n.type===Ju.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Ju.Metadata&&n.type!==Ju.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Ju.Modified&&n.type===Ju.Modified?this.changeMap=this.changeMap.insert(e,{type:Ju.Modified,doc:t.doc}):t.type===Ju.Modified&&n.type===Ju.Added?this.changeMap=this.changeMap.insert(e,{type:Ju.Added,doc:t.doc}):t.type===Ju.Removed&&n.type===Ju.Added?this.changeMap=this.changeMap.remove(e):t.type===Ju.Removed&&n.type===Ju.Modified?this.changeMap=this.changeMap.insert(e,{type:Ju.Removed,doc:n.doc}):t.type===Ju.Added&&n.type===Ju.Removed?this.changeMap=this.changeMap.insert(e,{type:Ju.Modified,doc:t.doc}):Ai("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal((function(e,n){t.push(n)})),t},t}(),nc=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:Ju.Added,doc:t})})),new t(e,n,Zu.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),rc=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=ic.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(xo.MIN,i,$o(),zo(),Xo())},t}(),ic=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ki(),n,Xo(),Xo(),Xo())},t}(),oc=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},ac=function(t,e){this.targetId=t,this.existenceFilter=e};!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(tc||(tc={}));var sc=function(t,e,n,r){void 0===n&&(n=ki()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},uc=function(){function t(){this.pendingResponses=0,this.documentChanges=lc(),this._resumeToken=ki(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Xo(),e=Xo(),n=Xo();return this.documentChanges.forEach((function(r,i){switch(i){case Ju.Added:t=t.add(r);break;case Ju.Modified:e=e.add(r);break;case Ju.Removed:n=n.add(r);break;default:Ai("Encountered invalid change type: "+i)}})),new ic(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=lc()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),cc=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=zo(),this.pendingDocumentTargetMapping=hc(),this.pendingTargetResets=new Bo(oo)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof ts?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof es&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ensureTargetState(n);switch(t.state){case tc.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case tc.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case tc.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),Ci(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case tc.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case tc.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:Ai("Unknown target watch change state: "+t.state)}}))},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):xi(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.targetDataForActiveTarget(e);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new Eo(i.path);this.removeDocumentFromTarget(e,o,new es(o,xo.forDeletedDoc()))}else Ci(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};xi(this.targetStates,(function(r,i){var o=e.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new Eo(o.target.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new es(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=Xo();this.pendingDocumentTargetMapping.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.targetDataForActiveTarget(t);return!n||n.purpose===ks.LimboResolution||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new rc(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=zo(),this.pendingDocumentTargetMapping=hc(),this.pendingTargetResets=new Bo(oo),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Ju.Modified:Ju.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Ju.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new uc),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Bo(oo),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){var e=null!==this.targetDataForActiveTarget(t);return e||Ii("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.targetDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getTargetDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;Ci(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new uc,this.metadataProvider.getRemoteKeysForTarget(t).forEach((function(n){e.removeDocumentFromTarget(t,n,null)}))},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function hc(){return new Po(Eo.comparator)}function lc(){return new Po(Eo.comparator)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fc="RemoteStore",pc=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(t){n.enqueueAndForget((function(){return f(o,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(Ii(fc,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new Qu(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return f(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Vu.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Vu.Offline),[2]}}))}))},t.prototype.disableNetworkInternal=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(Ii(fc,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},t.prototype.shutdown=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return Ii(fc,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Vu.Unknown),[2]}}))}))},t.prototype.listen=function(t){Mi(this.listenTargets,t.targetId)||(this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t))},t.prototype.unlisten=function(t){Ci(Mi(this.listenTargets,t),"unlisten called on target no currently watched: "+t),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),Ui(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Vu.Unknown))},t.prototype.getTargetDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){Ci(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new cc(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!Ui(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return f(this,void 0,void 0,(function(){var t=this;return p(this,(function(e){return xi(this.listenTargets,(function(e,n){t.sendWatchRequest(n)})),[2]}))}))},t.prototype.onWatchStreamClose=function(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){return void 0===t&&Ci(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Vu.Unknown),[2]}))}))},t.prototype.onWatchStreamChange=function(t,e){return f(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Vu.Online),t instanceof sc&&t.state===tc.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof oc?this.watchChangeAggregator.handleDocumentChange(t):t instanceof ac?this.watchChangeAggregator.handleExistenceFilter(t):(Ci(t instanceof sc,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(xo.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.raiseWatchSnapshot=function(t){var e=this;Ci(!t.isEqual(xo.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return xi(n.targetChanges,(function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.withResumeToken(r.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.withResumeToken(ki(),n.snapshotVersion),e.sendUnwatchRequest(t);var r=new xs(n.target,t,ks.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;Ci(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return f(e,void 0,void 0,(function(){return p(this,(function(e){return Mi(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]}))}))}))})),r},t.prototype.fillWritePipeline=function(){return f(this,void 0,void 0,(function(){var t,e;return p(this,(function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){Ci(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){Ci(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){return this.writeStream.writeHandshake(),[2]}))}))},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})).catch(Ys)},t.prototype.onMutationResult=function(t,e){var n=this;Ci(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=ta.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},t.prototype.onWriteStreamClose=function(t){return f(this,void 0,void 0,(function(){var e=this;return p(this,(function(n){return void 0===t&&Ci(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then((function(){e.shouldStartWriteStream()&&e.startWriteStream()}))]):[2]}))}))},t.prototype.handleHandshakeError=function(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){return Hu(t.code)?(Ii(fc,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=ki(),[2,this.localStore.setLastStreamToken(ki()).catch(Ys)]):[2]}))}))},t.prototype.handleWriteError=function(t){return f(this,void 0,void 0,(function(){var e,n=this;return p(this,(function(r){return Hu(i=t.code)&&i!==_i.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then((function(){return n.fillWritePipeline()}))]):[2];var i}))}))},t.prototype.createTransaction=function(){return new Gu(this.datastore)},t.prototype.restartNetwork=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Vu.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.handleCredentialChange=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(Ii(fc,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.applyPrimaryState=function(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Vu.Unknown),e.label=4;case 4:return[2]}}))}))},t}(),dc=function(){function t(t,e){if(Vi("GeoPoint",arguments,2),ji("GeoPoint","number",1,t),ji("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new Ri(_i.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ri(_i.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return oo(this._lat,t._lat)||oo(this._long,t._long)},t}(),mc=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new Qa(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),gc=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=bc(t),n=function(t){e.find((function(e){return e.isEqual(t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new $a(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&ao(e.elements,this.elements)},t}(),yc=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=bc(t),n=function(t){e=e.filter((function(e){return!e.isEqual(t)}))},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new $a(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&ao(e.elements,this.elements)},t}(),vc=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof za&&this.operand instanceof za){var r=n.internalValue+this.operand.internalValue;return new za(r)}r=n.internalValue+this.operand.internalValue;return new Ka(r)},t.prototype.applyToRemoteDocument=function(t,e){return Ci(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof qa?t:new za(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function bc(t){return t instanceof $a?t.internalValue.slice():[]}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wc,Tc,Ec=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),Ic=((wc={})[yu.ASCENDING.name]="ASCENDING",wc[yu.DESCENDING.name]="DESCENDING",wc),Sc=((Tc={})[hu.LESS_THAN.name]="LESS_THAN",Tc[hu.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Tc[hu.GREATER_THAN.name]="GREATER_THAN",Tc[hu.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Tc[hu.EQUAL.name]="EQUAL",Tc[hu.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Tc[hu.IN.name]="IN",Tc[hu.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",Tc),Nc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(t,e){Ci(!iu(t),e+" is missing")}function Cc(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Ai("can't parse "+t)}var Dc=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?_i.UNKNOWN:Yu(t.code);return new Ri(e,t.message||"")},t.prototype.toInt32Value=function(t){return this.options.useProto3Json||iu(t)?t:{value:t}},t.prototype.fromInt32Value=function(t){var e;return iu(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return this.options.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);Ci(!!t,"Cannot deserialize null or undefined timestamp.");var e=Cc(t.seconds||"0"),n=t.nanos||0;return new Lo(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=Nc.exec(t);if(Ci(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Lo(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(Ci(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),lo.fromBase64String(t)):(Ci(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),lo.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return Ci(!!t,"Trying to deserialize version that isn't set"),xo.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=bo.fromString(t);return Ci(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return Ci(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),Ci(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Eo(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?bo.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new bo(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new bo(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return Ci(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Va)return{nullValue:"NULL_VALUE"};if(t instanceof Ba)return{booleanValue:t.value()};if(t instanceof za)return{integerValue:""+t.value()};if(t instanceof Ka){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Ga?{stringValue:t.value()}:t instanceof Ja?{mapValue:this.toMapValue(t)}:t instanceof $a?{arrayValue:this.toArrayValue(t)}:t instanceof Wa?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Xa?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Ha?{bytesValue:this.toBytes(t.value())}:t instanceof Ya?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:Ai("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Va.INSTANCE;if("booleanValue"in t)return Ba.of(t.booleanValue);if("integerValue"in t)return new za(Cc(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Ka.NAN;if("Infinity"===t.doubleValue)return Ka.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Ka.NEGATIVE_INFINITY}return new Ka(t.doubleValue)}if("stringValue"in t)return new Ga(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){Ac(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new $a(n.map((function(t){return e.fromValue(t)})))}if("timestampValue"in t)return Ac(t.timestampValue,"timestampValue"),new Wa(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){Ac(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Xa(new dc(r,i))}if("bytesValue"in t){Ac(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Ha(o)}if("referenceValue"in t){Ac(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new go(a.get(1),a.get(3)),u=new Eo(this.extractLocalPathFromResourceName(a));return new Ya(s,u)}return Ai("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return Ci(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new ts(r,i,{hasCommittedMutations:!!e},void 0,t,(function(t){return n.fromValue(t)}))},t.prototype.toFields=function(t){var e=this,n={};return t.forEach((function(t,r){n[t]=e.toValue(r)})),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Ja.EMPTY;return Pi(n,(function(t,n){r=r.set(new To([t]),e.fromValue(n))})),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.toValue(t))})),{values:n}},t.prototype.fromFound=function(t){var e=this;Ci(!!t.found,"Tried to deserialize a found document from a missing document."),Ac(t.found.name,"doc.found.name"),Ac(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new ts(n,r,{},void 0,t.found,(function(t){return e.fromValue(t)}))},t.prototype.fromMissing=function(t){Ci(!!t.missing,"Tried to deserialize a missing document from a found document."),Ci(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new es(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):Ai("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case tc.Added:return"ADD";case tc.Current:return"CURRENT";case tc.NoChange:return"NO_CHANGE";case tc.Removed:return"REMOVE";case tc.Reset:return"RESET";default:return Ai("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof ac)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof oc){if(t.newDoc instanceof ts){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof es){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof sc){var n=void 0;return t.cause&&(n={code:Xu(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return Ai("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){Ac(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new sc(r,i,o,s||null)}else if("documentChange"in t){Ac(t.documentChange,"documentChange");var u=t.documentChange;Ac(u.document,"documentChange.name"),Ac(u.document.name,"documentChange.document.name"),Ac(u.document.updateTime,"documentChange.document.updateTime");var c=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),l=new ts(c,h,{},void 0,u.document,(function(t){return n.fromValue(t)})),f=u.targetIds||[],p=u.removedTargetIds||[];e=new oc(f,p,l.key,l)}else if("documentDelete"in t){Ac(t.documentDelete,"documentDelete");var d=t.documentDelete;Ac(d.document,"documentDelete.document");c=this.fromName(d.document),h=d.readTime?this.fromVersion(d.readTime):xo.forDeletedDoc(),l=new es(c,h),p=d.removedTargetIds||[];e=new oc([],p,l.key,l)}else if("documentRemove"in t){Ac(t.documentRemove,"documentRemove");var m=t.documentRemove;Ac(m.document,"documentRemove");c=this.fromName(m.document),p=m.removedTargetIds||[];e=new oc([],p,c,null)}else{if(!("filter"in t))return Ai("Unknown change type "+JSON.stringify(t));Ac(t.filter,"filter");var g=t.filter;Ac(g.targetId,"filter.targetId");var y=g.count||0,v=new Ec(y),b=g.targetId;e=new ac(b,v)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?tc.NoChange:"ADD"===t?tc.Added:"REMOVE"===t?tc.Removed:"CURRENT"===t?tc.Current:"RESET"===t?tc.Reset:Ai("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return xo.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?xo.MIN:e.readTime?this.fromVersion(e.readTime):xo.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Ma)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Pa)e={delete:this.toName(t.key)};else if(t instanceof La)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof xa))return Ai("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.toFieldTransform(t)}))}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Ra.NONE;if(t.update){Ac(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new La(r,i,o,n)}return new Ma(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Pa(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map((function(t){return e.fromFieldTransform(t)}));return Ci(!0===n.exists,'Transforms only support precondition "exists == true"'),new xa(r,a)}return Ai("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return Ci(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ai("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Ra.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Ra.exists(t.exists):Ra.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(xo.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map((function(t){return n.fromValue(t)}))),new Da(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(Ci(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.fromWriteResult(t,e)}))):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof mc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof gc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof yc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof vc)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw Ai("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)Ci("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=mc.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new gc(r.map((function(t){return e.fromValue(t)})))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new yc(r.map((function(t){return e.fromValue(t)})))}else if("increment"in t){var i=this.fromValue(t.increment);Ci(i instanceof qa,"NUMERIC_ADD transform requires a NumberValue"),n=new vc(i)}else Ai("Unknown transform proto: "+JSON.stringify(t));var o=To.fromServerFormat(t.fieldPath);return new Ca(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;Ci(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return uu.atPath(this.fromQueryPath(n)).toTarget()},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(Ci(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Ci(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ci(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new uu(e,i,s,a,u,au.First,c,h).toTarget()},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case ks.Listen:return null;case ks.ExistenceFilterMismatch:return"existence-filter-mismatch";case ks.LimboResolution:return"limbo-document";default:return Ai("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.target;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof lu?e.toUnaryOrFieldFilter(t):Ai("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.fromFilter(t)})).reduce((function(t,e){return t.concat(e)})):Ai("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.toPropertyOrder(t)}))},t.prototype.fromOrder=function(t){var e=this;return t.map((function(t){return e.fromPropertyOrder(t)}))},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map((function(t){return e.toValue(t)}))}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map((function(t){return e.fromValue(t)}));return new vu(r,n)},t.prototype.toDirection=function(t){return Ic[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return yu.ASCENDING;case"DESCENDING":return yu.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return Sc[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return hu.EQUAL;case"GREATER_THAN":return hu.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return hu.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return hu.LESS_THAN;case"LESS_THAN_OR_EQUAL":return hu.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return hu.ARRAY_CONTAINS;case"IN":return hu.IN;case"ARRAY_CONTAINS_ANY":return hu.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Ai("Unspecified operator");default:return Ai("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return To.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new bu(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return lu.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===hu.EQUAL){if(t.value.isEqual(Ka.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Va.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return lu.create(e,hu.EQUAL,Ka.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return lu.create(n,hu.EQUAL,Va.INSTANCE);case"OPERATOR_UNSPECIFIED":return Ai("Unspecified filter");default:return Ai("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map((function(t){return To.fromServerFormat(t)}));return Aa.fromArray(e)},t}(),kc=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},_c=function(){function t(t){this.syncEngine=t,this.queries=new rs((function(t){return t.canonicalId()})),this.onlineState=Vu.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);(r||(n=!0,r=new kc,this.queries.set(e,r)),r.listeners.push(t),Ci(!t.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap)&&(t.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent());return n?this.syncEngine.listen(e).then((function(t){return r.targetId=t,t})):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return f(this,void 0,void 0,(function(){var e,n,r,i;return p(this,(function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]}))}))},t.prototype.onWatchChange=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++){u[s].onViewSnapshot(i)&&(e=!0)}a.viewSnap=i}}e&&this.raiseSnapshotsInSyncEvent()},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t;var e=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++){o[i].applyOnlineStateChange(t)&&(e=!0)}})),e&&this.raiseSnapshotsInSyncEvent()},t.prototype.addSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.add(t),t.next()},t.prototype.removeSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.delete(t)},t.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(t){t.next()}))},t}(),Rc=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=Vu.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(Ci(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Ju.Metadata&&e.push(i)}t=new nc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(t)&&(this.queryObserver.next(t),o=!0):this.shouldRaiseInitialEvent(t,this.onlineState)&&(this.raiseInitialEvent(t),o=!0),this.snap=t,o},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t;var e=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&(this.raiseInitialEvent(this.snap),e=!0),e},t.prototype.shouldRaiseInitialEvent=function(t,e){if(Ci(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Vu.Offline;return this.options.waitForSyncWhenOnline&&n?(Ci(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Vu.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){Ci(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=nc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Oc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.addedKeys=n,this.removedKeys=r}return t.fromSnapshot=function(e,n){for(var r=Xo(),i=Xo(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Ju.Added:r=r.add(s.doc.key);break;case Ju.Removed:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Mc=function(t){this.key=t},Lc=function(t){this.key=t},xc=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Xo(),this.mutatedKeys=Xo(),this.documentSet=new Zu(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new ec,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=e instanceof ts?e:null;l&&(Ci(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:Ju.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(h,l)||(r.track({type:Ju.Modified,doc:l}),d=!0,(u&&n.query.docComparator(l,u)>0||c&&n.query.docComparator(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:Ju.Added,doc:l}),d=!0):h&&!l&&(r.track({type:Ju.Removed,doc:h}),d=!0,(u||c)&&(s=!0));d&&(l?(a=a.add(l),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var h=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:Ju.Removed,doc:h})}return Ci(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;Ci(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case Ju.Added:return 1;case Ju.Modified:case Ju.Metadata:return 2;case Ju.Removed:return 0;default:return Ai("Unknown ChangeType: "+t)}};return n(t)-n(e)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t.type,e.type)||r.query.docComparator(t.doc,e.doc)})),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?$u.Synced:$u.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new nc(this.query,t.documentSet,i,o,t.mutatedKeys,s===$u.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Vu.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new ec,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.add(t)})),t.modifiedDocuments.forEach((function(t){return Ci(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")})),t.removedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)})),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Xo(),this.documentSet.forEach((function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))}));var n=[];return e.forEach((function(e){t.limboDocuments.has(e)||n.push(new Lc(e))})),this.limboDocuments.forEach((function(t){e.has(t)||n.push(new Mc(t))})),n},t.prototype.synchronizeWithPersistedState=function(t){this._syncedDocuments=t.remoteKeys,this.limboDocuments=Xo();var e=this.computeDocChanges(t.documents);return this.applyChanges(e,!0)},t.prototype.computeInitialSnapshot=function(){return nc.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===$u.Local)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pc=5,Uc=function(){function t(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=Pc,this.backoff=new Fu(this.asyncQueue,ho.RetryTransaction)}return t.prototype.run=function(){this.runWithBackOff()},t.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun((function(){return f(t,void 0,void 0,(function(){var t,e,n=this;return p(this,(function(r){return t=this.remoteStore.createTransaction(),(e=this.tryRunUpdateFunction(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.handleTransactionError(t)}))}))})).catch((function(t){n.handleTransactionError(t)})),[2]}))}))}))},t.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!iu(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.handleTransactionError=function(t){var e=this;this.retries>0&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return e.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.isRetryableTransactionError=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Hu(e)}return!1},t}(),Fc=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Vc=function(t){this.key=t,this.receivedDocument=!1},Bc=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new rs((function(t){return t.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new Po(Eo.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Su,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ba.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Vu.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){Ci(null!==t,"SyncEngine listener cannot be null"),Ci(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return f(this,void 0,void 0,(function(){var e,n,r,i,o;return p(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(t.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(t,e,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}}))}))},t.prototype.initializeViewAndComputeSnapshot=function(t,e,n){return f(this,void 0,void 0,(function(){var r,i,o,a,s,u;return p(this,(function(c){switch(c.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return r=c.sent(),i=new xc(t,r.remoteKeys),o=i.computeDocChanges(r.documents),a=ic.createSynthesizedTargetChangeForCurrentChange(e,n&&this.onlineState!==Vu.Offline),Ci(0===(s=i.applyChanges(o,!0===this.isPrimary,a)).limboChanges.length,"View returned limbo docs before target ack from the server."),Ci(!!s.snapshot,"applyChanges for new view should always return a snapshot"),u=new Fc(t,e,i),this.queryViewsByQuery.set(t,u),this.queriesByTarget[e]||(this.queriesByTarget[e]=[]),this.queriesByTarget[e].push(t),[2,s.snapshot]}}))}))},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return f(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(t.query,!0)];case 1:return e=r.sent(),n=t.view.synchronizeWithPersistedState(e),this.isPrimary&&this.updateTrackedLimbos(t.targetId,n.limboChanges),[2,n]}}))}))},t.prototype.unlisten=function(t){return f(this,void 0,void 0,(function(){var e,n,r=this;return p(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),Ci(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),(n=this.queriesByTarget[e.targetId]).length>1?(this.queriesByTarget[e.targetId]=n.filter((function(e){return!e.isEqual(t)})),this.queryViewsByQuery.delete(t),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseTarget(e.targetId,!1).then((function(){r.sharedClientState.clearQueryState(e.targetId),r.remoteStore.unlisten(e.targetId),r.removeAndCleanupTarget(e.targetId)})).catch(Ys)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(e.targetId),[4,this.localStore.releaseTarget(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return f(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new Uc(t,this.remoteStore,e,n).run()},t.prototype.applyRemoteEvent=function(t){return f(this,void 0,void 0,(function(){var e,n=this;return p(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),Pi(t.targetChanges,(function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(Ci(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),e.addedDocuments.size>0?r.receivedDocument=!0:e.modifiedDocuments.size>0?Ci(r.receivedDocument,"Received change for limbo target document without add."):e.removedDocuments.size>0&&(Ci(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Ys(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Bu.RemoteStore||!this.isPrimary&&e===Bu.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(e,r){var i=r.view.applyOnlineStateChange(t);Ci(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return f(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return p(this,(function(u){switch(u.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new Po(Eo.comparator)).insert(r,new es(r,xo.forDeletedDoc())),o=Xo().add(r),a=new rc(xo.MIN,{},new Bo(oo),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return[4,this.localStore.releaseTarget(t,!1).then((function(){return s.removeAndCleanupTarget(t,e)})).catch(Ys)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},t.prototype.applyBatchState=function(t,e,n){return f(this,void 0,void 0,(function(){var r;return p(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(Ii("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):Ai("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},t.prototype.applySuccessfulWrite=function(t){return f(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),e=t.batch.batchId,this.processUserCallback(e,null),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Ys(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.rejectFailedWrite=function(t,e){return f(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Ys(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.registerPendingWritesCallback=function(t){return f(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||Ii("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.pendingWritesCallbacks.get(e)||[]).push(t),this.pendingWritesCallbacks.set(e,n),[2])}}))}))},t.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach((function(t){t.resolve()})),this.pendingWritesCallbacks.delete(t)},t.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach((function(e){e.forEach((function(e){e.reject(new Ri(_i.CANCELLED,t))}))})),this.pendingWritesCallbacks.clear()},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Po(oo)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(Ci(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupTarget=function(t,e){var n=this;void 0===e&&(e=null),this.sharedClientState.removeLocalQueryTarget(t),Ci(this.queriesByTarget[t]&&0!==this.queriesByTarget[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.queriesByTarget[t];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),e&&this.syncEngineListener.onWatchError(o,e)}if(delete this.queriesByTarget[t],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(t);this.limboDocumentRefs.removeReferencesForId(t),a.forEach((function(t){n.limboDocumentRefs.containsKey(t)||n.removeLimboTarget(t)}))}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof Mc)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof Lc){Ii("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else Ai("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){Ii("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=uu.atPath(e.path);this.limboResolutionsByTarget[n]=new Vc(e),this.remoteStore.listen(new xs(r.toTarget(),n,ks.LimboResolution,yo.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return f(this,void 0,void 0,(function(){var n,r,i,o=this;return p(this,(function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(a,s){i.push(Promise.resolve().then((function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query,!1).then((function(t){var n=t.documents;return s.view.computeDocChanges(n,e)})):e})).then((function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Oc.fromSnapshot(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},t.prototype.assertSubscribed=function(t){Ci(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return f(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},t.prototype.applyPrimaryState=function(t){return f(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u=this;return p(this,(function(c){switch(c.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=c.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),xi(this.queriesByTarget,(function(t,e){u.sharedClientState.isLocalQueryTarget(t)?a.push(t):s=s.then((function(){return u.removeAndCleanupTarget(t),u.localStore.releaseTarget(t,!0)})),u.remoteStore.unlisten(t)})),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))},t.prototype.resetLimboDocuments=function(){var t=this;xi(this.limboResolutionsByTarget,(function(e){t.remoteStore.unlisten(e)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Po(Eo.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return f(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,h,l,f,d;return p(this,(function(p){switch(p.label){case 0:e=[],n=[],r=0,i=t,p.label=1;case 1:return r<i.length?(o=i[r],a=void 0,(s=this.queriesByTarget[o])&&0!==s.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return p.sent(),[4,this.localStore.allocateTarget(s[0].toTarget())];case 3:a=p.sent(),u=0,c=s,p.label=4;case 4:return u<c.length?(h=c[u],Ci(!!(l=this.queryViewsByQuery.get(h)),"No query view found for "+h),[4,this.synchronizeViewAndComputeSnapshot(l)]):[3,7];case 5:(f=p.sent()).snapshot&&n.push(f.snapshot),p.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return Ci(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return Ci(!!(d=p.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return a=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:p.sent(),p.label=12;case 12:e.push(a),p.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,e]}}))}))},t.prototype.synthesizeTargetToQuery=function(t){return new uu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,au.First,t.startAt,t.endAt)},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return f(this,void 0,void 0,(function(){var r,i;return p(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return Ii("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[t])return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=rc.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(t,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(t,n),[3,7];case 6:Ai("Unexpected target state: "+e),o.label=7;case 7:return[2]}}))}))},t.prototype.applyActiveTargetsChange=function(t,e){return f(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,h,l=this;return p(this,(function(f){switch(f.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,f.label=1;case 1:return n<r.length?(h=r[n],Ci(!this.queriesByTarget[h],"Trying to add an already active target"),[4,this.localStore.getTarget(h)]):[3,6];case 2:return Ci(!!(i=f.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=f.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:f.sent(),this.remoteStore.listen(o),f.label=5;case 5:return n++,[3,1];case 6:a=function(t){return p(this,(function(e){switch(e.label){case 0:return s.queriesByTarget[t]?[4,s.localStore.releaseTarget(t,!1).then((function(){l.remoteStore.unlisten(t),l.removeAndCleanupTarget(t)})).catch(Ys)]:[2,"continue"];case 1:return e.sent(),[2]}}))},s=this,u=0,c=e,f.label=7;case 7:return u<c.length?(h=c[u],[5,a(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return u++,[3,7];case 10:return[2]}}))}))},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];if(e&&e.receivedDocument)return Xo().add(e.key);var n=Xo(),r=this.queriesByTarget[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);Ci(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},t}(),qc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),jc="firestore_clients";function zc(t,e){return Ci(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),jc+"_"+t+"_"+e}var Kc="firestore_mutations";function Gc(t,e,n){var r=Kc+"_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}var Wc="firestore_targets";function Qc(t,e){return Wc+"_"+t+"_"+e}var Hc="firestore_online_state";var Yc="firestore_sequence_number";
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xc="SharedClientState",Jc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,Ci(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new Ri(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(Si(Xc,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),$c=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,Ci(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ri(r.error.code,r.error.message)),i?new t(e,r.state,o):(Si(Xc,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Zc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=$o(),a=0;i&&a<r.activeTargetIds.length;++a)i=ou(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Si(Xc,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),th=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&n.onlineState in Vu&&"string"==typeof n.clientId?new t(n.clientId,Vu[n.onlineState]):(Si(Xc,"Failed to parse online state: "+e),null)},t}(),eh=function(){function t(){this.activeTargetIds=$o()}return t.prototype.addQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),nh=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new Ri(_i.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=zc(this.persistenceKey,this.localClientId),this.sequenceNumberKey=function(t){return Yc+"_"+t}(this.persistenceKey),this.activeClients[this.localClientId]=new eh,this.clientStateKeyRe=new RegExp("^"+jc+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Kc+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Wc+"_"+a+"_(\\d+)$"),this.onlineStateKey=function(t){return Hc+"_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return f(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,h,l=this;return p(this,(function(f){switch(f.label){case 0:return Ci(!this.started,"WebStorageSharedClientState already started"),Ci(null!==this.syncEngine,"syncEngine property must be set before calling start()"),Ci(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(zc(this.persistenceKey,r)))&&(o=Zc.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)h=c[u],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=$o();return Pi(this.activeClients,(function(e,n){t=t.unionWith(n.activeTargetIds)})),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Qc(this.persistenceKey,t));if(n){var r=$c.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Qc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.removeMutationState(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ii(Xc,"READ",t,e),e},t.prototype.setItem=function(t,e){Ii(Xc,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ii(Xc,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(Ii(Xc,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void Si("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return f(e,void 0,void 0,(function(){var e,n,r,i,o,a;return p(this,(function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(Ci(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=yo.INVALID;if(null!=t)try{var n=JSON.parse(t);Ci("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){Si(Xc,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==yo.INVALID&&this.sequenceNumberHandler(a));return[2]}))}))}))}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Jc(this.currentUser,t,e,n),i=Gc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=Gc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Vu[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=Qc(this.persistenceKey,t),i=new $c(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return Ci(null!==n,"Cannot parse client state key '"+t+"'"),Zc.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);Ci(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Jc.fromWebStorageEntry(new qc(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);Ci(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return $c.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return th.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return f(this,void 0,void 0,(function(){return p(this,(function(e){return t.user.uid!==this.currentUser.uid?(Ii(Xc,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]}))}))},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach((function(t){return f(n,void 0,void 0,(function(){return p(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return f(n,void 0,void 0,(function(){return p(this,(function(e){return i.has(t)||a.push(t),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();var rh=function(){function t(){this.localState=new eh,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new eh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),ih=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return Bs.withCacheSize(this.cacheSizeBytes)},t}(),oh=function(){},ah=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=io.newId()}return t.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new Io,r=new Io,i=!1;return this.credentials.setChangeListener((function(o){i?e.asyncQueue.enqueueAndForget((function(){return e.handleCredentialChange(o)})):(i=!0,e.initializePersistence(t,r,o).then((function(t){return e.initializeRest(o,t)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.enableNetwork()}))},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof ih?this.startIndexedDbPersistence(n,t).then((function(t){return e.resolve(),t})).catch((function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()})):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof Ri?t.code===_i.FAILED_PRECONDITION||t.code===_i.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ri(_i.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Hs.buildStoragePrefix(this.databaseInfo),i=new Dc(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return f(n,void 0,void 0,(function(){var n,o;return p(this,(function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!nh.isAvailable(this.platform))throw new Ri(_i.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.lruParams(),this.sharedClientState=e.synchronizeTabs?new nh(this.asyncQueue,this.platform,r,this.clientId,t):new rh,[4,Hs.createIndexedDbPersistence({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),this.persistence=o,[2,o.referenceDelegate.garbageCollector]}}))}))}))},t.prototype.startMemoryPersistence=function(){return this.persistence=Ru.createEagerPersistence(this.clientId),this.sharedClientState=new rh,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return Ii("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return f(n,void 0,void 0,(function(){var n,i,o,a,s,u,c=this;return p(this,(function(h){switch(h.label){case 0:return n=new Eu,this.localStore=new Au(this.persistence,n,t),[4,this.localStore.start()];case 1:return h.sent(),e&&(this.lruScheduler=new qs(e,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),a=new Ku(this.asyncQueue,r,this.credentials,o),s=function(t){return c.syncEngine.applyOnlineStateChange(t,Bu.RemoteStore)},u=function(t){return c.syncEngine.applyOnlineStateChange(t,Bu.SharedClientState)},this.remoteStore=new pc(this.localStore,a,this.asyncQueue,s,i),this.syncEngine=new Bc(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new _c(this.syncEngine),[4,this.sharedClientState.start()];case 2:return h.sent(),[4,this.remoteStore.start()];case 3:return h.sent(),[4,this.persistence.setPrimaryStateListener((function(t){return f(c,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return h.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return f(c,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return h.sent(),[2]}}))}))}))},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),Ii("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return f(t,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new Io;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.registerPendingWritesCallback(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new Rc(t,e,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},t.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.unlisten(t)}))},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.localStore.readDocument(t)})).then((function(t){if(t instanceof ts)return t;if(t instanceof es)return null;throw new Ri(_i.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return f(e,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return e=i.sent(),n=new xc(t,e.remoteKeys),r=n.computeDocChanges(e.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new Io;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.write(t,n)})),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.addSnapshotsInSyncListener=function(t){var e=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.addSnapshotsInSyncListener(t),Promise.resolve()}))},t.prototype.removeSnapshotsInSyncListener=function(t){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(t)},Object.defineProperty(t.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new Io;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()})),n.promise},t}(),sh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),uh=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+ro(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(ji("FieldPath","string",n,t[n]),0===t[n].length)throw new Ri(_i.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new To(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw to("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(To.keyField().canonicalString()),t}(),ch=new RegExp("[~\\*/\\[\\]]");
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hh=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},lh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){Ci(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(qc.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){Ci(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),fh=function(){function t(t){var e=this;this.tokenListener=null,this.currentUser=qc.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),t.get().then((function(t){e.auth=t,e.tokenListener&&e.auth.addAuthTokenListener(e.tokenListener)}),(function(){})))}return t.prototype.getToken=function(){var t=this;Ci(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.tokenCounter!==e)throw new Ri(_i.ABORTED,"getToken aborted due to token change.");return n?(Ci("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new hh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){Ci(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){Ci(null!=this.tokenListener,"removeChangeListener() called twice"),Ci(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.auth&&this.auth.getUid();return Ci(null===t||"string"==typeof t,"Received invalid UID: "+t),new qc(t)},t}(),ph=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=qc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),dh=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new ph(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(qc.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function mh(t){if(!t)return new lh;switch(t.type){case"gapi":var e=t.client;return Ci(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new dh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ri(_i.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,["next","error","complete"])}var yh,vh=function(){function t(t){this._methodName=t}return t.delete=function(){return Fi("FieldValue.delete",arguments),bh.instance},t.serverTimestamp=function(){return Fi("FieldValue.serverTimestamp",arguments),wh.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bi("FieldValue.arrayUnion",arguments,1),new Th(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bi("FieldValue.arrayRemove",arguments,1),new Eh(t)},t.increment=function(t){return ji("FieldValue.increment","number",1,t),Vi("FieldValue.increment",arguments,1),new Ih(t)},t.prototype.isEqual=function(t){return this===t},t}(),bh=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return h(e,t),e.instance=new e,e}(vh),wh=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return h(e,t),e.instance=new e,e}(vh),Th=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return h(e,t),e}(vh),Eh=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return h(e,t),e}(vh),Ih=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return h(e,t),e}(vh),Sh=Oi(vh,"Use FieldValue.<field>() instead."),Nh=/^__.*__$/,Ah=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new La(t,this.data,this.fieldMask,e)):n.push(new Ma(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new xa(t,this.fieldTransforms)),n},t}(),Ch=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new La(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new xa(t,this.fieldTransforms)),n},t}();function Dh(t){switch(t){case yh.Set:case yh.MergeSet:case yh.Update:return!0;case yh.Argument:case yh.ArrayArgument:return!1;default:throw Ai("Unexpected case for UserDataSource: "+t)}}!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument",t[t.ArrayArgument=4]="ArrayArgument"}(yh||(yh={}));var kh=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new Ri(_i.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(0===t.length)throw this.createError("Document fields must not be empty");if(Dh(this.dataSource)&&Nh.test(t))throw this.createError('Document fields cannot begin and end with "__"')},t}(),_h=function(t,e){this.databaseId=t,this.key=e},Rh=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new kh(yh.Set,t,To.EMPTY_PATH);Mh("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Ah(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new kh(yh.MergeSet,t,To.EMPTY_PATH);Mh("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Bo(To.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof uh)l=h._internalPath;else{if("string"!=typeof h)throw Ai("Expected stringOrFieldPath to be a string or a FieldPath");l=xh(t,h)}if(!r.contains(l))throw new Ri(_i.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");s=s.add(l)}i=Aa.fromSet(s),o=r.fieldTransforms.filter((function(t){return i.covers(t.field)}))}else i=Aa.fromArray(r.fieldMask),o=r.fieldTransforms;return new Ah(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new kh(yh.Update,t,To.EMPTY_PATH);Mh("Data must be an object, but it was:",r,e);var i=new Bo(To.comparator),o=Ja.EMPTY;Pi(e,(function(e,a){var s=xh(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof bh)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}}));var a=Aa.fromSet(i);return new Ch(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new kh(yh.Update,t,To.EMPTY_PATH),o=[Lh(t,e)],a=[n];if(r.length%2!=0)throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Lh(t,r[s])),a.push(r[s+1]);var u=new Bo(To.comparator),c=Ja.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof bh)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=Aa.fromSet(u);return new Ch(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e,n){void 0===n&&(n=!1);var r=new kh(n?yh.ArrayArgument:yh.Argument,t,To.EMPTY_PATH),i=this.parseData(e,r);return Ci(null!=i,"Parsed data should not be null."),Ci(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Ph(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(Oh(t=this.runPreConverter(t,e)))return Mh("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof vh)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement&&e.dataSource!==yh.ArrayArgument)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Po(oo);return Ui(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pi(t,(function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))})),new Ja(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Va.INSTANCE),n.push(s),r++}return new $a(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Dh(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof bh){if(e.dataSource!==yh.MergeSet)throw e.dataSource===yh.Update?(Ci(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof wh)e.fieldTransforms.push(new Ca(e.path,mc.instance));else if(t instanceof Th){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new gc(n);e.fieldTransforms.push(new Ca(e.path,r))}else if(t instanceof Eh){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new yc(n);e.fieldTransforms.push(new Ca(e.path,i))}else if(t instanceof Ih){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new vc(o);e.fieldTransforms.push(new Ca(e.path,a))}else Ai("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Va.INSTANCE;if("number"==typeof t)return ou(t)?new za(t):new Ka(t);if("boolean"==typeof t)return Ba.of(t);if("string"==typeof t)return new Ga(t);if(t instanceof Date)return new Wa(Lo.fromDate(t));if(t instanceof Lo)return new Wa(new Lo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof dc)return new Xa(t);if(t instanceof lo)return new Ha(t);if(t instanceof _h)return new Ya(t.databaseId,t.key);throw e.createError("Unsupported field value: "+Ji(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map((function(e,r){var i=new kh(yh.Argument,t,To.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))}))},t}();function Oh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Lo||t instanceof dc||t instanceof lo||t instanceof _h||t instanceof vh)}function Mh(t,e,n){if(!Oh(n)||!Xi(n)){var r=Ji(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Lh(t,e){if(e instanceof uh)return e._internalPath;if("string"==typeof e)return xh(t,e);throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function xh(t,e){try{return function(t){if(t.search(ch)>=0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(uh.bind.apply(uh,g([void 0],t.split("."))))}catch(e){throw new Ri(_i.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=Ph(e);throw new Ri(_i.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Ph(t){return t instanceof Error?t.message:t.toString()}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uh="firestore.googleapis.com",Fh=!0,Vh=!0,Bh=!1,qh=Bs.COLLECTION_DISABLED,jh=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new Ri(_i.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Uh,this.ssl=Fh}else Ki("settings","non-empty string","host",t.host),this.host=t.host,Gi("settings","boolean","ssl",t.ssl),this.ssl=Li(t.ssl,Fh);if(Zi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Gi("settings","object","credentials",t.credentials),this.credentials=t.credentials,Gi("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Si("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&Si("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Li(t.timestampsInSnapshots,Vh),Gi("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Bs.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==qh&&t.cacheSizeBytes<Bs.MINIMUM_CACHE_SIZE_BYTES)throw new Ri(_i.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Bs.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}Gi("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?Bh:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),zh=function(){function t(e,n){var r=this;if(this._firebaseApp=null,this._queue=new No,this.INTERNAL={delete:function(){return f(r,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var i=e;this._firebaseApp=i,this._databaseId=t.databaseIdFromApp(i),this._persistenceKey=i.name,this._credentials=new fh(n)}else{var o=e;if(!o.projectId)throw new Ri(_i.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new go(o.projectId,o.database),this._persistenceKey="[DEFAULT]",this._credentials=new lh}this._settings=new jh({}),this._dataConverter=this.createDataConverter(this._databaseId)}return t.prototype.settings=function(t){if(Vi("Firestore.settings",arguments,1),ji("Firestore.settings","object",1,t),Mi(t,"persistence"))throw new Ri(_i.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new jh(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new Ri(_i.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=e,void 0!==e.credentials&&(this._credentials=mh(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new Ri(_i.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Si("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=Li(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new ih(this._settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=Hs.buildStoragePrefix(this.makeDatabaseInfo()),n=new Io;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return f(t,void 0,void 0,(function(){var t;return p(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new Ri(_i.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Hs.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ensureClientConfigured(),gh(t))return this.onSnapshotsInSyncInternal(t);ji("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.onSnapshotsInSyncInternal(e)},t.prototype.onSnapshotsInSyncInternal=function(t){var e=this,n=new sh({next:function(){t.next&&t.next()},error:function(t){throw Ai("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),e._firestoreClient.removeSnapshotsInSyncListener(n)}},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new oh),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new po(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},t.prototype.configureClient=function(t){Ci(!!this._settings.host,"FirestoreSettings.host is not set"),Ci(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new ah(Di.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},t.prototype.createDataConverter=function(t){return new Rh((function(e){if(e instanceof Wh){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new Ri(_i.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new _h(t,e._key)}return e}))},t.databaseIdFromApp=function(t){var e=t.options;if(!Mi(e,"projectId"))throw new Ri(_i.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new Ri(_i.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new go(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._firebaseApp)throw new Ri(_i.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return Vi("Firestore.collection",arguments,1),ji("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new $h(bo.fromString(t),this)},t.prototype.doc=function(t){return Vi("Firestore.doc",arguments,1),ji("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Wh.forPath(bo.fromString(t),this)},t.prototype.collectionGroup=function(t){if(Vi("Firestore.collectionGroup",arguments,1),ji("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Xh(new uu(bo.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return Vi("Firestore.runTransaction",arguments,1),ji("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction((function(n){return t(new Kh(e,n))}))},t.prototype.batch=function(){return this.ensureClientConfigured(),new Gh(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Ti()){case fi.DEBUG:return"debug";case fi.ERROR:return"error";case fi.SILENT:return"silent";default:return Ai("Unknown log level: "+Ti())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(Vi("Firestore.setLogLevel",arguments,1),ji("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Ei(fi.DEBUG);break;case"error":Ei(fi.ERROR);break;case"silent":Ei(fi.SILENT);break;default:throw new Ri(_i.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},t}(),Kh=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;Vi("Transaction.get",arguments,1);var n=nl("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Ai("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof es)return new Hh(e._firestore,n._key,null,!1,!1,n._converter);if(r instanceof ts)return new Hh(e._firestore,n._key,r,!1,!1,n._converter);throw Ai("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},t.prototype.set=function(t,e,n){qi("Transaction.set",arguments,2,3);var r=nl("Transaction.set",t,this._firestore);n=Zh("Transaction.set",n);var i=il(r._converter,e,"Transaction.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(r._key,s),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof e||e instanceof uh?(Bi("Transaction.update",arguments,3),r=nl("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(Vi("Transaction.update",arguments,2),r=nl("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){Vi("Transaction.delete",arguments,1);var e=nl("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Gh=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){qi("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=nl("WriteBatch.set",t,this._firestore);n=Zh("WriteBatch.set",n);var i=il(r._converter,e,"WriteBatch.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(r._key,Ra.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof e||e instanceof uh?(Bi("WriteBatch.update",arguments,3),r=nl("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(Vi("WriteBatch.update",arguments,2),r=nl("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Ra.exists(!0))),this},t.prototype.delete=function(t){Vi("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=nl("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Pa(e._key,Ra.NONE)),this},t.prototype.commit=function(){return f(this,void 0,void 0,(function(){return p(this,(function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new Ri(_i.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Wh=function(){function t(t,e,n){this._key=t,this.firestore=e,this._converter=n,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n,r){if(e.length%2!=0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new Eo(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new $h(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(Vi("DocumentReference.collection",arguments,1),ji("DocumentReference.collection","non-empty string",1,t),!t)throw new Ri(_i.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=bo.fromString(t);return new $h(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw to("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)&&this._converter===e._converter},t.prototype.set=function(t,e){qi("DocumentReference.set",arguments,1,2),e=Zh("DocumentReference.set",e);var n=il(this._converter,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData(i,r,e.mergeFields):this.firestore._dataConverter.parseSetData(i,r);return this._firestoreClient.write(o.toMutations(this._key,Ra.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof uh?(Bi("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(Vi("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,Ra.exists(!0)))},t.prototype.delete=function(){return Vi("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Pa(this._key,Ra.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];qi("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||gh(t[i])||(Zi("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Gi("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return gh(t[i])?n=t[i]:(ji("DocumentReference.onSnapshot","function",i,t[i]),zi("DocumentReference.onSnapshot","function",i+1,t[i+1]),zi("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new sh({next:function(t){if(e.next){Ci(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Hh(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites,n._converter))}},error:r}),o=this._firestoreClient.listen(uu.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return qi("DocumentReference.get",arguments,0,1),el("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then((function(t){n(new Hh(e.firestore,e._key,t,!0,t instanceof ts&&t.hasLocalMutations,e._converter))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new Ri(_i.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new Ri(_i.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this._key,this.firestore,e)},t}(),Qh=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Hh=function(){function t(t,e,n,r,i,o){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i,this._converter=o}return t.prototype.data=function(t){if(qi("DocumentSnapshot.data",arguments,0,1),t=tl("DocumentSnapshot.data",t),this._document){if(this._converter){var e=new Yh(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(e,t)}return this.toJSObject(this._document.data(),Ua.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},t.prototype.get=function(t,e){if(qi("DocumentSnapshot.get",arguments,1,2),e=tl("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(Lh("DocumentSnapshot.get",t));if(null!==n)return this.toJSValue(n,Ua.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Wh(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Qh(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw to("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))&&this._converter===e._converter},t.prototype.toJSObject=function(t,e){var n=this,r={};return t.forEach((function(t,i){r[t]=n.toJSValue(i,e)})),r},t.prototype.toJSValue=function(t,e){if(t instanceof Ja)return this.toJSObject(t,e);if(t instanceof $a)return this.toJSArray(t,e);if(t instanceof Ya){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||Si("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Wh(n,this._firestore,this._converter)}return t.value(e)},t.prototype.toJSArray=function(t,e){var n=this;return t.internalValue.map((function(t){return n.toJSValue(t,e)}))},t}(),Yh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return Ci(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Hh),Xh=function(){function t(t,e,n){this._query=t,this.firestore=e,this._converter=n}return t.prototype.where=function(e,n,r){Vi("Query.where",arguments,3),$i("Query.where",3,r);var i,o=["<","<=","==",">=",">","array-contains","in","array-contains-any"];Hi("Query.where",o,2,n);var a=Lh("Query.where",e),s=hu.fromString(n);if(a.isKeyField()){if(s===hu.ARRAY_CONTAINS||s===hu.ARRAY_CONTAINS_ANY)throw new Ri(_i.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===hu.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],c=0,h=r;c<h.length;c++){var l=h[c];u.push(this.parseDocumentIdValue(l))}i=new $a(u)}else i=this.parseDocumentIdValue(r)}else s!==hu.IN&&s!==hu.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),i=this.firestore._dataConverter.parseQueryValue("Query.where",r,s===hu.IN);var f=lu.create(a,s,i);return this.validateNewFilter(f),new t(this._query.addFilter(f),this.firestore,this._converter)},t.prototype.orderBy=function(e,n){var r;if(qi("Query.orderBy",arguments,1,2),zi("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=yu.ASCENDING;else{if("desc"!==n)throw new Ri(_i.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=yu.DESCENDING}if(null!==this._query.startAt)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Lh("Query.orderBy",e),o=new bu(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore,this._converter)},t.prototype.limit=function(e){return Vi("Query.limit",arguments,1),ji("Query.limit","number",1,e),eo("Query.limit",1,e),new t(this._query.withLimitToFirst(e),this.firestore,this._converter)},t.prototype.limitToLast=function(e){return Vi("Query.limitToLast",arguments,1),ji("Query.limitToLast","number",1,e),eo("Query.limitToLast",1,e),new t(this._query.withLimitToLast(e),this.firestore,this._converter)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Bi("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Bi("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore,this._converter)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Bi("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Bi("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore,this._converter)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw to("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.withConverter=function(e){return new t(this._query,this.firestore,e)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if($i(t,1,e),e instanceof Hh){if(n.length>0)throw new Ri(_i.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Ri(_i.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Ya(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof Qa)throw new Ri(_i.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new vu(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new Ri(_i.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(bo.fromString(a));if(!Eo.isDocumentKey(s))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new Eo(s);i.push(new Ya(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new vu(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];qi("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||gh(t[i])||(Zi("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Gi("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),gh(t[i])?n=t[i]:(ji("Query.onSnapshot","function",i,t[i]),zi("Query.onSnapshot","function",i+1,t[i+1]),zi("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new sh({next:function(t){e.next&&e.next(new Jh(n.firestore,n._query,t,n._converter))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.validateHasExplicitOrderByForLimitToLast=function(t){if(t.hasLimitToLast()&&0===t.explicitOrderBy.length)throw new Ri(_i.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return qi("Query.get",arguments,0,1),el("Query.get",t),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then((function(t){n(new Jh(e.firestore,e._query,t,e._converter))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new Ri(_i.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"==typeof t){if(""===t)throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(bo.fromString(t));if(!Eo.isDocumentKey(e))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Ya(this.firestore._databaseId,new Eo(e))}if(t instanceof Wh){var n=t;return new Ya(this.firestore._databaseId,n._key)}throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ji(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Ri(_i.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ri(_i.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new Ri(_i.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof lu){var e=[hu.ARRAY_CONTAINS,hu.ARRAY_CONTAINS_ANY],n=[hu.IN,hu.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new Ri(_i.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Ri(_i.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new Ri(_i.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Jh=function(){function t(t,e,n,r){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._converter=r,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Qh(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;qi("QuerySnapshot.forEach",arguments,1,2),ji("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach((function(r){t.call(e,n.convertToDocumentImpl(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Xh(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(Zi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Gi("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new Ri(_i.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n,r){if(n.oldDocs.isEmpty()){var i,o=0;return n.docChanges.map((function(e){var a=new Yh(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r);return Ci(e.type===Ju.Added,"Invalid event type for first snapshot"),Ci(!i||n.query.docComparator(i,e.doc)<0,"Got added events in wrong order"),i=e.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}}))}var a=n.oldDocs;return n.docChanges.filter((function(t){return e||t.type!==Ju.Metadata})).map((function(e){var i=new Yh(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key),r),o=-1,s=-1;return e.type!==Ju.Added&&(Ci((o=a.indexOf(e.doc.key))>=0,"Index for document not found"),a=a.delete(e.doc.key)),e.type!==Ju.Removed&&(s=(a=a.add(e.doc)).indexOf(e.doc.key)),{type:rl(e.type),doc:i,oldIndex:o,newIndex:s}}))}(this._firestore,e,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw to("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)&&this._converter===e._converter},t.prototype.convertToDocumentImpl=function(t){return new Yh(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key),this._converter)},t}();g(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(t){try{Object.defineProperty(Jh.prototype.docChanges,t,{get:function(){return function(){throw new Ri(_i.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var $h=function(t){function e(e,n,r){var i=t.call(this,uu.atPath(e),n,r)||this;if(i._path=e,e.length%2!=1)throw new Ri(_i.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return i}return h(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Wh(new Eo(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(qi("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=io.newId()),ji("CollectionReference.doc","non-empty string",1,t),""===t)throw new Ri(_i.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=bo.fromString(t);return Wh.forPath(this._query.path.child(e),this.firestore,this._converter)},e.prototype.add=function(t){Vi("CollectionReference.add",arguments,1),ji("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this._path,this.firestore,t)},e}(Xh);function Zh(t,e){if(void 0===e)return{merge:!1};if(Zi(t,e,["merge","mergeFields"]),Gi(t,"boolean","merge",e.merge),Wi(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"==typeof t||t instanceof uh})),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ri(_i.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function tl(t,e){return void 0===e?{}:(Zi(t,e,["serverTimestamps"]),Qi(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function el(t,e){zi(t,"object",1,e),e&&(Zi(t,e,["source"]),Qi(t,0,"source",e.source,["default","server","cache"]))}function nl(t,e,n){if(e instanceof Wh){if(e.firestore!==n)throw new Ri(_i.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw to(t,"DocumentReference",1,e)}function rl(t){switch(t){case Ju.Added:return"added";case Ju.Modified:case Ju.Metadata:return"modified";case Ju.Removed:return"removed";default:return Ai("Unknown change type: "+t)}}function il(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var ol=Oi(zh,"Use firebase.firestore() instead."),al=Oi(Kh,"Use firebase.firestore().runTransaction() instead."),sl=Oi(Gh,"Use firebase.firestore().batch() instead."),ul=Oi(Wh,"Use firebase.firestore().doc() instead."),cl=Oi(Hh),hl=Oi(Yh),ll=Oi(Xh),fl=Oi(Jh),pl=Oi($h,"Use firebase.firestore().collection() instead."),dl={Firestore:ol,GeoPoint:dc,Timestamp:Lo,Blob:fo,Transaction:al,WriteBatch:sl,DocumentReference:ul,DocumentSnapshot:cl,Query:ll,QueryDocumentSnapshot:hl,QuerySnapshot:fl,CollectionReference:pl,FieldPath:uh,FieldValue:Sh,setLogLevel:zh.setLogLevel,CACHE_SIZE_UNLIMITED:qh};function ml(t){t.INTERNAL.registerComponent(new R("firestore",(function(t){var e=t.getProvider("app").getImmediate();return new zh(e,t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(function(t){Ci(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(dl)))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gl=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),yl=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){Ii("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(0)}},t.prototype.onNetworkUnavailable=function(){Ii("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(1)}},t.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),vl=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){Ci(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){Ci(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){Ci(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){Ci(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){Ci(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){Ci(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),bl="Connection",wl={BatchGetDocuments:"batchGet",Commit:"commit"},Tl="gl-js/ fire/"+bi,El=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=Tl},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise((function(o,a){var s=new vi;s.listenOnce(gi.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case mi.NO_ERROR:var e=s.getResponseJson();Ii(bl,"XHR received:",JSON.stringify(e)),o(e);break;case mi.TIMEOUT:Ii(bl,'RPC "'+t+'" timed out'),a(new Ri(_i.DEADLINE_EXCEEDED,"Request time out"));break;case mi.HTTP_ERROR:var n=s.getStatus();if(Ii(bl,'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var i=(u=r.status,c=u.toLowerCase().replace("_","-"),Object.values(_i).indexOf(c)>=0?c:_i.UNKNOWN);a(new Ri(i,r.message))}else a(new Ri(_i.UNKNOWN,"Server responded with status "+s.getStatus()))}else Ii(bl,'RPC "'+t+'" failed'),a(new Ri(_i.UNAVAILABLE,"Connection failed."));break;default:Ai('RPC "'+t+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{Ii(bl,'RPC "'+t+'" completed.')}var u,c}));var u=l({},e);delete u.database;var c=JSON.stringify(u);Ii(bl,"XHR sending: ",i+" "+c);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),s.send(i,"POST",c,h,15)}))},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=di(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),"object"==typeof navigator&&"ReactNative"===navigator.product||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");Ii(bl,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new vl({sendFn:function(t){u?Ii(bl,"Not sending because WebChannel is closed:",t):(s||(Ii(bl,"Opening WebChannel transport."),a.open(),s=!0),Ii(bl,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),h=function(t,e){a.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return h(yi.EventType.OPEN,(function(){u||Ii(bl,"WebChannel transport opened.")})),h(yi.EventType.CLOSE,(function(){u||(u=!0,Ii(bl,"WebChannel transport closed"),c.callOnClose())})),h(yi.EventType.ERROR,(function(t){u||(u=!0,Ii(bl,"WebChannel transport errored:",t),c.callOnClose(new Ri(_i.UNAVAILABLE,"The operation could not be completed")))})),h(yi.EventType.MESSAGE,(function(t){var e;if(!u){var n=t.data[0];Ci(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ii(bl,"WebChannel received error:",i);var o=i.status,s=function(t){var e=Wu[t];if(void 0!==e)return Yu(e)}(o),h=i.message;void 0===s&&(s=_i.INTERNAL,h="Unknown error status: "+o+" with message "+i.message),u=!0,c.callOnClose(new Ri(s,h)),a.close()}else Ii(bl,"WebChannel received:",n),c.callOnMessage(n)}})),setTimeout((function(){c.callOnOpen()}),0),c},t.prototype.makeUrl=function(t){var e=wl[t];return Ci(void 0!==e,"Unknown REST mapping for: "+t),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+e},t}(),Il=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new El(t))},t.prototype.newConnectivityMonitor=function(){return yl.isAvailable()?new yl:new gl},t.prototype.newSerializer=function(t){return new Dc(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Di.setPlatform(new Il);var Sl,Nl="@firebase/firestore",Al="1.9.1";ml(Sl=ot),Sl.registerVersion(Nl,Al);var Cl="blogs",Dl=st.firestore();function kl(){return Dl.collection(Cl).doc().id}(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function r(){this.a=null}function o(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var a=n.setTimeout;r.prototype.c=function(t){a(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new r;return e.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.La(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.La=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=i(t),a=r.next();!a.done;a=r.next())o(a.value).La(e,n)}))},e.all=function(t){var n=i(t),r=n.next();return r.done?o([]):new e((function(t,e){function i(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,o(r.value).La(i(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var o=o||{},a=this||self;function s(t){return"string"==typeof t}function u(t){return"boolean"==typeof t}var c=/^[\w+/_-]+[=]{0,2}$/,h=null;function l(){}function f(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){return null===t}function d(t){return"array"==f(t)}function m(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function g(t){return"function"==f(t)}function y(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),b=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function T(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:T).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now||function(){return+new Date};function N(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.gd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function A(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function C(t){if(Error.captureStackTrace)Error.captureStackTrace(this,C);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function D(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");C.call(this,n+t[r])}function k(t,e){throw new D("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function _(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function R(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function O(){this.b=this.a=null}N(C,Error),C.prototype.name="CustomError",N(D,C),D.prototype.name="AssertionError",_.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var M=new _((function(){return new x}),(function(t){t.reset()}));function L(){var t=zt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function x(){this.next=this.b=this.a=null}function P(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(y(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;k("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}O.prototype.add=function(t,e){var n=M.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},x.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},x.prototype.reset=function(){this.next=this.b=this.a=null};var U=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var V=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=s(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},B=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function q(t,e){return 0<=U(t,e)}function j(t,e){var n;return(n=0<=(e=U(t,e)))&&Array.prototype.splice.call(t,e,1),n}function z(t,e){!function(t,e){for(var n=s(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function K(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function Q(t){for(var e in t)return!1;return!0}function H(t){var e,n={};for(e in t)n[e]=t[e];return n}var Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Y.length;o++)n=Y[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function J(t,e){this.a=t===tt&&e||"",this.b=Z}function $(t){return t instanceof J&&t.constructor===J&&t.b===Z?t.a:(k("expected object of type Const, got '"+t+"'"),"type_error:Const")}J.prototype.qa=!0,J.prototype.pa=function(){return this.a},J.prototype.toString=function(){return"Const{"+this.a+"}"};var Z={},tt={},et=new J(tt,"");function nt(){this.a="",this.b=ut}function rt(t){return t instanceof nt&&t.constructor===nt&&t.b===ut?t.a:(k("expected object of type TrustedResourceUrl, got '"+t+"' of type "+f(t)),"type_error:TrustedResourceUrl")}function it(t,e){var n=$(t);if(!st.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return ct(t=n.replace(at,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof J?$(t):encodeURIComponent(String(t))})))}nt.prototype.qa=!0,nt.prototype.pa=function(){return this.a.toString()},nt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var at=/%{(\w+)}/g,st=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ut={};function ct(t){var e=new nt;return e.a=t,e}var ht=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},lt=/&/g,ft=/</g,pt=/>/g,dt=/"/g,mt=/'/g,gt=/\x00/g,yt=/[\x00&<>"']/;function vt(t,e){return-1!=t.indexOf(e)}function bt(t,e){return t<e?-1:t>e?1:0}function wt(){this.a="",this.b=Nt}function Tt(t){return t instanceof wt&&t.constructor===wt&&t.b===Nt?t.a:(k("expected object of type SafeUrl, got '"+t+"' of type "+f(t)),"type_error:SafeUrl")}wt.prototype.qa=!0,wt.prototype.pa=function(){return this.a.toString()},wt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Et=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function It(t){return t instanceof wt?t:(t="object"==typeof t&&t.qa?t.pa():String(t),Et.test(t)||(t="about:invalid#zClosurez"),At(t))}var St,Nt={};function At(t){var e=new wt;return e.a=t,e}At("about:blank");t:{var Ct=a.navigator;if(Ct){var Dt=Ct.userAgent;if(Dt){St=Dt;break t}}St=""}function kt(t){return vt(St,t)}function _t(){this.a="",this.b=Ot}function Rt(t){return t instanceof _t&&t.constructor===_t&&t.b===Ot?t.a:(k("expected object of type SafeHtml, got '"+t+"' of type "+f(t)),"type_error:SafeHtml")}_t.prototype.qa=!0,_t.prototype.pa=function(){return this.a.toString()},_t.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ot={};function Mt(t){var e=new _t;return e.a=t,e}Mt("<!DOCTYPE html>");var Lt,xt,Pt=Mt("");function Ut(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ft(t){return yt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(lt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(ft,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(pt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(dt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(mt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(gt,"&#0;"))),t}function Vt(t){a.setTimeout((function(){throw t}),0)}function Bt(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!kt("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",function(t){var e=ct($(et));P(t,"HTMLIFrameElement"),t.src=rt(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Rt(Pt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=E((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!kt("Trident")&&!kt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){a.setTimeout(t,0)}}function qt(t,e){xt||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);xt=function(){t.then(Kt)}}else xt=function(){var t=Kt;!g(a.setImmediate)||a.Window&&a.Window.prototype&&!kt("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(Lt||(Lt=Bt()),Lt(t)):a.setImmediate(t)}}(),jt||(xt(),jt=!0),zt.add(t,e)}Mt("<br>");var jt=!1,zt=new O;function Kt(){for(var t;t=L();){try{t.a.call(t.b)}catch(t){Vt(t)}R(M,t)}jt=!1}function Gt(t,e){if(this.a=Wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=l)try{var n=this;t.call(e,(function(t){ie(n,Qt,t)}),(function(t){if(!(t instanceof le))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}ie(n,Ht,t)}))}catch(t){ie(this,Ht,t)}}var Wt=0,Qt=2,Ht=3;function Yt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Yt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Xt=new _((function(){return new Yt}),(function(t){t.reset()}));function Jt(t,e,n){var r=Xt.get();return r.g=t,r.b=e,r.f=n,r}function $t(t){if(t instanceof Gt)return t;var e=new Gt(l);return ie(e,Qt,t),e}function Zt(t){return new Gt((function(e,n){n(t)}))}function te(t,e,n){oe(t,e,n,null)||qt(I(e,t))}function ee(t){return new Gt((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)te(t[o],I(i,o,!0),I(i,o,!1));else e(r)}))}function ne(t,e){t.b||t.a!=Qt&&t.a!=Ht||ae(t),t.f?t.f.next=e:t.b=e,t.f=e}function re(t,e,n,r){var i=Jt(null,null,null);return i.a=new Gt((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof le?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,ne(t,i),i.a}function ie(t,e,n){t.a==Wt&&(t===n&&(e=Ht,n=new TypeError("Promise cannot resolve to itself")),t.a=1,oe(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,ae(t),e!=Ht||n instanceof le||function(t,e){t.g=!0,qt((function(){t.g&&he.call(null,e)}))}(t,n)))}function oe(t,e,n,r){if(t instanceof Gt)return ne(t,Jt(e||l,n||null,r)),!0;if(A(t))return t.then(e,n,r),!0;if(y(t))try{var i=t.then;if(g(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function ae(t){t.h||(t.h=!0,qt(t.Zb,t))}function se(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ue(t,e,n,r){if(n==Ht&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ce(e,n,r);else try{e.c?e.g.call(e.f):ce(e,n,r)}catch(t){he.call(null,t)}R(Xt,e)}function ce(t,e,n){e==Qt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Gt.prototype.then=function(t,e,n){return re(this,g(t)?t:null,g(e)?e:null,n)},Gt.prototype.$goog_Thenable=!0,(t=Gt.prototype).ka=function(t,e){return(t=Jt(t,t,e)).c=!0,ne(this,t),this},t.s=function(t,e){return re(this,null,t,e)},t.cancel=function(t){this.a==Wt&&qt((function(){!function t(e,n){if(e.a==Wt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==Wt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):se(r),ue(r,o,Ht,n)))}e.c=null}else ie(e,Ht,n)}(this,new le(t))}),this)},t.Oc=function(t){this.a=Wt,ie(this,Qt,t)},t.Pc=function(t){this.a=Wt,ie(this,Ht,t)},t.Zb=function(){for(var t;t=se(this);)ue(this,t,this.a,this.i);this.h=!1};var he=Vt;function le(t){C.call(this,t)}function fe(){0!=pe&&(de[this[v]||(this[v]=++b)]=this),this.va=this.va,this.la=this.la}N(le,C),le.prototype.name="cancel";var pe=0,de={};function me(t){if(!t.va&&(t.va=!0,t.za(),0!=pe)){var e=t[v]||(t[v]=++b);if(0!=pe&&t.la&&0<t.la.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete de[e]}}function ge(t){return ge[" "](t),t}fe.prototype.va=!1,fe.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},ge[" "]=l;var ye,ve=kt("Opera"),be=kt("Trident")||kt("MSIE"),we=kt("Edge"),Te=we||be,Ee=kt("Gecko")&&!(vt(St.toLowerCase(),"webkit")&&!kt("Edge"))&&!(kt("Trident")||kt("MSIE"))&&!kt("Edge"),Ie=vt(St.toLowerCase(),"webkit")&&!kt("Edge");function Se(){var t=a.document;return t?t.documentMode:void 0}t:{var Ne="",Ae=function(){var t=St;return Ee?/rv:([^\);]+)(\)|;)/.exec(t):we?/Edge\/([\d\.]+)/.exec(t):be?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Ie?/WebKit\/(\S+)/.exec(t):ve?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ae&&(Ne=Ae?Ae[1]:""),be){var Ce=Se();if(null!=Ce&&Ce>parseFloat(Ne)){ye=String(Ce);break t}}ye=Ne}var De,ke={};function _e(t){return function(t,e){var n=ke;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=ht(String(ye)).split("."),r=ht(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=bt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||bt(0==a[2].length,0==s[2].length)||bt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}De=a.document&&be?Se():void 0;var Re=Object.freeze||function(t){return t},Oe=!be||9<=Number(De),Me=be&&!_e("9"),Le=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",l,e),a.removeEventListener("test",l,e)}catch(t){}return t}();function xe(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function Pe(t,e){if(xe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Ee){t:{try{ge(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:Ue[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}xe.prototype.preventDefault=function(){this.Mb=!1},N(Pe,xe);var Ue=Re({2:"touch",3:"pen",4:"mouse"});Pe.prototype.preventDefault=function(){Pe.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Me)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Pe.prototype.f=function(){return this.a};var Fe="closure_listenable_"+(1e6*Math.random()|0),Ve=0;function Be(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Pa=i,this.key=++Ve,this.ta=this.Ka=!1}function qe(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function je(t){this.src=t,this.a={},this.b=0}function ze(t,e){var n=e.type;n in t.a&&j(t.a[n],e)&&(qe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Ke(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==r)return i}return-1}je.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Ke(t,e,r,i);return-1<a?(e=t[a],n||(e.Ka=!1)):((e=new Be(e,this.src,o,!!r,i)).Ka=n,t.push(e)),e};var Ge="closure_lm_"+(1e6*Math.random()|0),We={};function Qe(t,e,n,r,i){if(r&&r.once)Ye(t,e,n,r,i);else if(d(e))for(var o=0;o<e.length;o++)Qe(t,e[o],n,r,i);else n=on(n),t&&t[Fe]?sn(t,e,n,y(r)?!!r.capture:!!r,i):He(t,e,n,!1,r,i)}function He(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=y(i)?!!i.capture:!!i,s=nn(t);if(s||(t[Ge]=s=new je(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=en,e=Oe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Le||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent($e(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Ye(t,e,n,r,i){if(d(e))for(var o=0;o<e.length;o++)Ye(t,e[o],n,r,i);else n=on(n),t&&t[Fe]?un(t,e,n,y(r)?!!r.capture:!!r,i):He(t,e,n,!0,r,i)}function Xe(t,e,n,r,i){if(d(e))for(var o=0;o<e.length;o++)Xe(t,e[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=on(n),t&&t[Fe]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=Ke(o=t.a[e],n,r,i))&&(qe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=nn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ke(e,n,r,i)),(n=-1<t?e[t]:null)&&Je(n))}function Je(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[Fe])ze(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent($e(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=nn(e))?(ze(n,t),0==n.b&&(n.src=null,e[Ge]=null)):qe(t)}}}function $e(t){return t in We?We[t]:We[t]="on"+t}function Ze(t,e,n,r){var i=!0;if((t=nn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=tn(o,r),i=i&&!1!==o)}return i}function tn(t,e){var n=t.listener,r=t.Pa||t.src;return t.Ka&&Je(t),n.call(r,e)}function en(t,e){if(t.ta)return!0;if(!Oe){if(!e)t:{e=["window","event"];for(var n=a,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Pe(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=Ze(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=Ze(r[i],t,!1,e),n=n&&o}return n}return tn(t,new Pe(e,this))}function nn(t){return(t=t[Ge])instanceof je?t:null}var rn="__closure_events_fn_"+(1e9*Math.random()>>>0);function on(t){return g(t)?t:(t[rn]||(t[rn]=function(e){return t.handleEvent(e)}),t[rn])}function an(){fe.call(this),this.u=new je(this),this.Sb=this,this.Xa=null}function sn(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function un(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function cn(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&ze(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Mb}function hn(t,e,n){if(g(t))n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function ln(t){var e=null;return new Gt((function(n,r){-1==(e=hn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw a.clearTimeout(e),t}))}function fn(t){if(t.U&&"function"==typeof t.U)return t.U();if(s(t))return t.split("");if(m(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function pn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(m(t)||s(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function dn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof dn)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function mn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];gn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)gn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function gn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}N(an,fe),an.prototype[Fe]=!0,an.prototype.addEventListener=function(t,e,n,r){Qe(this,t,e,n,r)},an.prototype.removeEventListener=function(t,e,n,r){Xe(this,t,e,n,r)},an.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var r=t.type||t;if(s(t))t=new xe(t,n);else if(t instanceof xe)t.target=t.target||n;else{var i=t;X(t=new xe(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=cn(a,r,!0,t)&&i}if(i=cn(a=t.b=n,r,!0,t)&&i,i=cn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=cn(a=t.b=e[o],r,!1,t)&&i;return i},an.prototype.za=function(){if(an.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)qe(n[r]);delete e.a[t],e.b--}}this.Xa=null},(t=dn.prototype).U=function(){mn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.X=function(){return mn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return gn(this.b,t)?this.b[t]:e},t.set=function(t,e){gn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var yn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function vn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof vn?(this.h=void 0!==e?e:t.h,bn(this,t.f),this.i=t.i,this.b=t.b,wn(this,t.l),this.c=t.c,Tn(this,Bn(t.a)),this.g=t.g):t&&(n=String(t).match(yn))?(this.h=!!e,bn(this,n[1]||"",!0),this.i=An(n[2]||""),this.b=An(n[3]||"",!0),wn(this,n[4]),this.c=An(n[5]||"",!0),Tn(this,n[6]||"",!0),this.g=An(n[7]||"")):(this.h=!!e,this.a=new Ln(null,this.h))}function bn(t,e,n){t.f=n?An(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function wn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function Tn(t,e,n){e instanceof Ln?(t.a=e,function(t,e){e&&!t.f&&(xn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Un(this,e),Vn(this,n,t))}),t)),t.f=e}(t.a,t.h)):(n||(e=Cn(e,On)),t.a=new Ln(e,t.h))}function En(t,e,n){t.a.set(e,n)}function In(t,e){return t.a.get(e)}function Sn(t){return t instanceof vn?new vn(t):new vn(t,void 0)}function Nn(t,e){var n=new vn(null,void 0);return bn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function An(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Cn(t,e,n){return s(t)?(t=encodeURI(t).replace(e,Dn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Dn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}vn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Cn(e,kn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(Cn(e,kn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Cn(n,"/"==n.charAt(0)?Rn:_n,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Cn(n,Mn)),t.join("")},vn.prototype.resolve=function(t){var e=new vn(this),n=!!t.f;n?bn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)wn(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(vt(i,"./")||vt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Tn(e,Bn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var kn=/[#\/\?@]/g,_n=/[#\?:]/g,Rn=/[#\?]/g,On=/[#\?@]/g,Mn=/#/g;function Ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function xn(t){t.a||(t.a=new dn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Pn(t){var e=pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Ln(null,void 0);t=fn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];d(o)?Vn(n,i,o):n.add(i,o)}return n}function Un(t,e){xn(t),e=qn(t,e),gn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,gn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&mn(t)))}function Fn(t,e){return xn(t),e=qn(t,e),gn(t.a.b,e)}function Vn(t,e,n){Un(t,e),0<n.length&&(t.c=null,t.a.set(qn(t,e),G(n)),t.b+=n.length)}function Bn(t){var e=new Ln;return e.c=t.c,t.a&&(e.a=new dn(t.a),e.b=t.b),e}function qn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=Ln.prototype).add=function(t,e){xn(this),this.c=null,t=qn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){xn(this),this.a.forEach((function(n,r){F(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.X=function(){xn(this);for(var t=this.a.U(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.U=function(t){xn(this);var e=[];if(s(t))Fn(this,t)&&(e=K(e,this.a.get(qn(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=K(e,t[n])}return e},t.set=function(t,e){return xn(this),this.c=null,Fn(this,t=qn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.U(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var jn=!be||9<=Number(De);function zn(t){var e=document;return s(t)?e.getElementById(t):t}function Kn(t,e){W(e,(function(e,n){e&&"object"==typeof e&&e.qa&&(e=e.pa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Gn.hasOwnProperty(n)?t.setAttribute(Gn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var Gn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Wn(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!jn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ft(a.name),'"'),a.type){o.push(' type="',Ft(a.type),'"');var u={};X(u,a),delete u.type,a=u}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(s(a)?o.className=a:d(a)?o.className=a.join(" "):Kn(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(s(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!m(o)||y(o)&&0<o.nodeType?r(o):F(Qn(o)?G(o):o,r)}}(i,o,r),o}function Qn(t){if(t&&"number"==typeof t.length){if(y(t))return"function"==typeof t.item||"string"==typeof t.item;if(g(t))return"function"==typeof t.item}return!1}function Hn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(d(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(a=n[i])&&(r.push(o),$n(i,r),r.push(":"),t(e,a,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":$n(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Yn,t,e),e.join("")}function Yn(){}var Xn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Jn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function $n(t,e){e.push('"',t.replace(Jn,(function(t){var e=Xn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Xn[t]=e),e})),'"')}function Zn(){var t=vr();return be&&!!De&&11==De||/Edge\/\d+/.test(t)}function tr(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function er(t,e){e=e||a.window;var n="about:blank";t&&(n=Tt(It(t)).toString()),e.location.href=n}function nr(t){return!!((t=(t||vr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function rr(t){t=t||a.window;try{t.close()}catch(t){}}function ir(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=vr().toLowerCase(),r&&(e.target=r,vt(n,"crios/")&&(e.target="_blank")),mr(vr())==pr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof wt?n:It(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((kt("iPhone")&&!kt("iPod")&&!kt("iPad")||kt("iPad")||kt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(P(a=r.document.createElement("A"),"HTMLAnchorElement"),e instanceof wt||e instanceof wt||(e="object"==typeof e&&e.qa?e.pa():String(e),Et.test(e)||(e="about:invalid#zClosurez"),e=At(e)),a.href=Tt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Tt(e).toString(),a&&(Te&&vt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Mt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ft(t)+'">'),a.document.write(Rt(t)),a.document.close())):(a=r.open(Tt(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var or=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ar=/^[^@]+@[^@]+$/;function sr(){var t=null;return new Gt((function(e){"complete"==a.document.readyState?e():(t=function(){e()},Ye(window,"load",t))})).s((function(e){throw Xe(window,"load",t),e}))}function ur(t){return t=t||vr(),!("file:"!==Ir()&&"ionic:"!==Ir()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function cr(){var t=a.window;try{return!(!t||t==t.top)}catch(t){return!1}}function hr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function lr(){return ot.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":ot.INTERNAL.hasOwnProperty("node")?"Node":hr()?"Worker":"Browser"}function fr(){var t=lr();return"ReactNative"===t||"Node"===t}var pr="Firefox",dr="Chrome";function mr(t){var e=t.toLowerCase();return vt(e,"opera/")||vt(e,"opr/")||vt(e,"opios/")?"Opera":vt(e,"iemobile")?"IEMobile":vt(e,"msie")||vt(e,"trident/")?"IE":vt(e,"edge/")?"Edge":vt(e,"firefox/")?pr:vt(e,"silk/")?"Silk":vt(e,"blackberry")?"Blackberry":vt(e,"webos")?"Webos":!vt(e,"safari/")||vt(e,"chrome/")||vt(e,"crios/")||vt(e,"android")?!vt(e,"chrome/")&&!vt(e,"crios/")||vt(e,"edge/")?vt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":dr:"Safari"}var gr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function yr(t,e){e=e||[];var n,r=[],i={};for(n in gr)i[gr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=lr())?r=mr(i=vr()):"Worker"===r&&(r=mr(i=vr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function vr(){return a.navigator&&a.navigator.userAgent||""}function br(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function wr(){try{var t=a.localStorage,e=Dr();if(t)return t.setItem(e,"1"),t.removeItem(e),!Zn()||!!a.indexedDB}catch(t){return hr()&&!!a.indexedDB}return!1}function Tr(){return(Er()||"chrome-extension:"===Ir()||ur())&&!fr()&&wr()&&!hr()}function Er(){return"http:"===Ir()||"https:"===Ir()}function Ir(){return a.location&&a.location.protocol||null}function Sr(t){return!nr(t=t||vr())&&mr(t)!=pr}function Nr(t){return void 0===t?null:Hn(t)}function Ar(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Cr(t){if(null!==t)return JSON.parse(t)}function Dr(t){return t||Math.floor(1e9*Math.random()).toString()}function kr(t){return"Safari"!=mr(t=t||vr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function _r(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Rr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=vr(),e=lr(),this.b=nr(t)||"ReactNative"===e}function Or(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Mr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Lr(){return!(!br("fireauth.oauthhelper",a)&&!br("fireauth.iframe",a))}Rr.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!Er()&&"chrome-extension:"!==Ir()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var xr,Pr={};function Ur(t){Pr[t]||(Pr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Fr={};Object.defineProperty(Fr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Fr,"abcd",{configurable:!0,enumerable:!0,value:2}),xr=2==Fr.abcd}catch(t){xr=!1}function Vr(t,e,n){xr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Br(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Vr(t,n,e[n])}function qr(t){var e={};return Br(e,t),e}function jr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Vr(e,n,jr(t[n]));return e}function zr(t){var e={},n=t[Gr],r=t[Wr];if(!(t=t[Qr])||t!=Kr&&!n)throw Error("Invalid provider user info!");e[Yr]=r||null,e[Hr]=n||null,Vr(this,Jr,t),Vr(this,Xr,jr(e))}var Kr="EMAIL_SIGNIN",Gr="email",Wr="newEmail",Qr="requestType",Hr="email",Yr="fromEmail",Xr="data",Jr="operation";function $r(t,e){this.code=ti+t,this.message=e||ei[t]||""}function Zr(t){var e=t&&t.code;return e?new $r(e.substring(ti.length),t.message):null}N($r,Error),$r.prototype.A=function(){return{code:this.code,message:this.message}},$r.prototype.toJSON=function(){return this.A()};var ti="auth/",ei={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function ni(t){var e=In(t=Sn(t),ri)||null,n=In(t,ii)||null,r=In(t,si)||null;if(r=r&&ci[r]||null,!e||!n||!r)throw new $r("argument-error",ri+", "+ii+"and "+si+" are required in a valid action code URL.");Br(this,{apiKey:e,operation:r,code:n,continueUrl:In(t,oi)||null,languageCode:In(t,ai)||null,tenantId:In(t,ui)||null})}var ri="apiKey",ii="oobCode",oi="continueUrl",ai="languageCode",si="mode",ui="tenantId",ci={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:Kr,verifyEmail:"VERIFY_EMAIL"};function hi(t){try{return new ni(t)}catch(t){return null}}function li(t){var e=t[gi];if(void 0===e)throw new $r("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new $r("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[fi];if(n&&"object"==typeof n){e=n[bi];var r=n[yi];if(n=n[vi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new $r("argument-error",yi+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new $r("argument-error",vi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new $r("argument-error",bi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new $r("missing-android-pkg-name")}}else if(void 0!==n)throw new $r("argument-error",fi+" property must be a non null object when specified.");if(this.f=null,(e=t[mi])&&"object"==typeof e){if("string"==typeof(e=e[wi])&&e.length)this.f=e;else if(void 0!==e)throw new $r("argument-error",wi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new $r("argument-error",mi+" property must be a non null object when specified.");if(void 0!==(e=t[di])&&"boolean"!=typeof e)throw new $r("argument-error",di+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[pi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new $r("argument-error",pi+" property must be a non empty string when specified.");this.i=t||null}var fi="android",pi="dynamicLinkDomain",di="handleCodeInApp",mi="iOS",gi="url",yi="installApp",vi="minimumVersion",bi="packageName",wi="bundleId";function Ti(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ei=null,Ii=null;function Si(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ii[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ei){Ei={},Ii={};for(var t=0;65>t;t++)Ei[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Ii[Ei[t]]=t,62<=t&&(Ii["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}function Ni(t){this.f=t.sub,S(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Ai(t){return(t=Ci(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Ni(t):null}function Ci(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Si(t))}catch(t){}return null}Ni.prototype.R=function(){return this.c},Ni.prototype.g=function(){return this.b};var Di,ki={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function _i(t){for(var e in ki)if(ki[e].id===t)return{firebaseEndpoint:(t=ki[e]).cb,secureTokenEndpoint:t.ib};return null}Di=_i("__EID__")?"__EID__":void 0;var Ri="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Oi=["client_id","response_type","scope","redirect_uri","state"],Mi={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:Oi},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:Oi},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:Oi},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Ri},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function Li(t){for(var e in Mi)if(Mi[e].Fa==t)return Mi[e];return null}function xi(t){var e={};e["facebook.com"]=Bi,e["google.com"]=ji,e["github.com"]=qi,e["twitter.com"]=zi;var n=t&&t[Ui];try{if(n)return e[n]?new e[n](t):new Vi(t);if(void 0!==t[Pi])return new Fi(t)}catch(t){}return null}var Pi="idToken",Ui="providerId";function Fi(t){var e=t[Ui];if(!e&&t[Pi]){var n=Ai(t[Pi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Vr(this,"providerId",e),Vr(this,"isNewUser",n)}function Vi(t){Fi.call(this,t),Vr(this,"profile",jr((t=Cr(t.rawUserInfo||"{}"))||{}))}function Bi(t){if(Vi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function qi(t){if(Vi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Vr(this,"username",this.profile&&this.profile.login||null)}function ji(t){if(Vi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function zi(t){if(Vi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Vr(this,"username",t.screenName||null)}function Ki(t){var e=Sn(t),n=In(e,"link"),r=In(Sn(n),"link");return e=In(e,"deep_link_id"),In(Sn(e),"link")||e||r||n||t}function Gi(){}function Wi(t,e){return t.then((function(t){if(t[La]){var n=Ai(t[La]);if(!n||e!=n.f)throw new $r("user-mismatch");return t}throw new $r("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==ti+"user-not-found"?new $r("user-mismatch"):t}))}function Qi(t,e){if(!e)throw new $r("internal-error","failed to construct a credential");this.a=e,Vr(this,"providerId",t),Vr(this,"signInMethod",t)}function Hi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Yi(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Qi(t.providerId,t.pendingToken)}catch(t){}return null}function Xi(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Vr(this,"idToken",e.idToken),e.accessToken&&Vr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Vr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new $r("internal-error","failed to construct a credential");Vr(this,"accessToken",e.oauthToken),Vr(this,"secret",e.oauthTokenSecret)}Vr(this,"providerId",t),Vr(this,"signInMethod",n)}function Ji(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Pn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function $i(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Xi(t.providerId,e,t.signInMethod)}catch(t){}}return null}function Zi(t,e){this.Fc=e||[],Br(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(Li(t)||{}).Ea||null,this.bb=null}function to(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new $r("argument-error",'SAML provider IDs must be prefixed with "saml."');Zi.call(this,t,[])}function eo(t){Zi.call(this,t,Oi),this.a=[]}function no(){eo.call(this,"facebook.com")}function ro(t){if(!t)throw new $r("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new no).credential({accessToken:e})}function io(){eo.call(this,"github.com")}function oo(t){if(!t)throw new $r("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new io).credential({accessToken:e})}function ao(){eo.call(this,"google.com"),this.ya("profile")}function so(t,e){var n=t;return y(t)&&(n=t.idToken,e=t.accessToken),(new ao).credential({idToken:n,accessToken:e})}function uo(){Zi.call(this,"twitter.com",Ri)}function co(t,e){var n=t;if(y(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new $r("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Xi("twitter.com",n,"twitter.com")}function ho(t,e,n){this.a=t,this.c=e,Vr(this,"providerId","password"),Vr(this,"signInMethod",n===fo.EMAIL_LINK_SIGN_IN_METHOD?fo.EMAIL_LINK_SIGN_IN_METHOD:fo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function lo(t){return t&&t.email&&t.password?new ho(t.email,t.password,t.signInMethod):null}function fo(){Br(this,{providerId:"password",isOAuthProvider:!1})}function po(t,e){if(!(e=mo(e)))throw new $r("argument-error","Invalid email link!");return new ho(t,e.code,fo.EMAIL_LINK_SIGN_IN_METHOD)}function mo(t){return(t=hi(t=Ki(t)))&&t.operation===Kr?t:null}function go(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new $r("internal-error");this.a=t,Vr(this,"providerId","phone"),Vr(this,"signInMethod","phone")}function yo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return F(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new go(e)}return null}function vo(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function bo(t){try{this.a=t||ot.auth()}catch(t){throw new $r("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Br(this,{providerId:"phone",isOAuthProvider:!1})}function wo(t,e){if(!t)throw new $r("missing-verification-id");if(!e)throw new $r("missing-verification-code");return new go({Va:t,Ua:e})}function To(t){if(t.temporaryProof&&t.phoneNumber)return new go({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return so(o,n);case"facebook.com":return ro(n);case"github.com":return oo(n);case"twitter.com":return co(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new Qi(e,a):new Xi(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new eo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Eo(t){if(!t.isOAuthProvider)throw new $r("invalid-oauth-provider")}function Io(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new $r("invalid-auth-event");if(this.g&&this.a)throw new $r("invalid-auth-event");if(this.g&&!this.f)throw new $r("invalid-auth-event")}function So(t){return(t=t||{}).type?new Io(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Zr(t.error),t.postBody,t.tenantId):null}function No(){this.b=null,this.a=[]}N(Vi,Fi),N(Bi,Vi),N(qi,Vi),N(ji,Vi),N(zi,Vi),Qi.prototype.na=function(t){return $a(t,Hi(this))},Qi.prototype.b=function(t,e){var n=Hi(this);return n.idToken=e,Za(t,n)},Qi.prototype.f=function(t,e){return Wi(ts(t,Hi(this)),e)},Qi.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Xi.prototype.na=function(t){return $a(t,Ji(this))},Xi.prototype.b=function(t,e){var n=Ji(this);return n.idToken=e,Za(t,n)},Xi.prototype.f=function(t,e){return Wi(ts(t,Ji(this)),e)},Xi.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Zi.prototype.Ga=function(t){return this.zb=H(t),this},N(to,Zi),N(eo,Zi),eo.prototype.ya=function(t){return q(this.a,t)||this.a.push(t),this},eo.prototype.Hb=function(){return G(this.a)},eo.prototype.credential=function(t,e){var n;if(!(n=y(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new $r("argument-error","credential failed: must provide the ID token and/or the access token.");return new Xi(this.providerId,n,this.providerId)},N(no,eo),Vr(no,"PROVIDER_ID","facebook.com"),Vr(no,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),N(io,eo),Vr(io,"PROVIDER_ID","github.com"),Vr(io,"GITHUB_SIGN_IN_METHOD","github.com"),N(ao,eo),Vr(ao,"PROVIDER_ID","google.com"),Vr(ao,"GOOGLE_SIGN_IN_METHOD","google.com"),N(uo,Zi),Vr(uo,"PROVIDER_ID","twitter.com"),Vr(uo,"TWITTER_SIGN_IN_METHOD","twitter.com"),ho.prototype.na=function(t){return this.signInMethod==fo.EMAIL_LINK_SIGN_IN_METHOD?ks(t,us,{email:this.a,oobCode:this.c}):ks(t,Ns,{email:this.a,password:this.c})},ho.prototype.b=function(t,e){return this.signInMethod==fo.EMAIL_LINK_SIGN_IN_METHOD?ks(t,cs,{idToken:e,email:this.a,oobCode:this.c}):ks(t,bs,{idToken:e,email:this.a,password:this.c})},ho.prototype.f=function(t,e){return Wi(this.na(t),e)},ho.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Br(fo,{PROVIDER_ID:"password"}),Br(fo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Br(fo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),go.prototype.na=function(t){return t.Wa(vo(this))},go.prototype.b=function(t,e){var n=vo(this);return n.idToken=e,ks(t,Cs,n)},go.prototype.f=function(t,e){var n=vo(this);return n.operation="REAUTH",Wi(t=ks(t,Ds,n),e)},go.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},bo.prototype.Wa=function(t,e){var n=this.a.b;return $t(e.verify()).then((function(r){if(!s(r))throw new $r("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return ks(t,ys,e)}(n,{phoneNumber:t,recaptchaToken:r}).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new $r("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Br(bo,{PROVIDER_ID:"phone"}),Br(bo,{PHONE_SIGN_IN_METHOD:"phone"}),Io.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Io.prototype.R=function(){return this.h},Io.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var Ao,Co=null;function Do(t){var e="unauthorized-domain",n=void 0,r=Sn(t);t=r.b,"chrome-extension"==(r=r.f)?n=Ut("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Ut("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",$r.call(this,e,n)}function ko(t,e,n){$r.call(this,t,n),(t=e||{}).Ab&&Vr(this,"email",t.Ab),t.ba&&Vr(this,"phoneNumber",t.ba),t.credential&&Vr(this,"credential",t.credential),t.Qb&&Vr(this,"tenantId",t.Qb)}function _o(t){if(t.code){var e=t.code||"";0==e.indexOf(ti)&&(e=e.substring(ti.length));var n={credential:To(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new $r(e,t.message||void 0);return new ko(e,n,t.message)}return null}function Ro(){}function Oo(t){return t.c||(t.c=t.b())}function Mo(){}function Lo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function xo(){}function Po(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=E(this.fc,this),this.a.onerror=E(this.Ib,this),this.a.onprogress=E(this.gc,this),this.a.ontimeout=E(this.kc,this)}function Uo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Fo(t,e,n){this.reset(t,e,n,void 0,void 0)}N(Do,$r),N(ko,$r),ko.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&X(t,e),t},ko.prototype.toJSON=function(){return this.A()},Ro.prototype.c=null,N(Mo,Ro),Mo.prototype.a=function(){var t=Lo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Mo.prototype.b=function(){var t={};return Lo(this)&&(t[0]=!0,t[1]=!0),t},Ao=new Mo,N(xo,Ro),xo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Po;throw Error("Unsupported browser")},xo.prototype.b=function(){return{}},(t=Po.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Uo(this,4)},t.Ib=function(){this.status=500,this.response=this.responseText="",Uo(this,4)},t.kc=function(){this.Ib()},t.gc=function(){this.status=200,Uo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Fo.prototype.a=null;function Vo(t){this.f=t,this.b=this.c=this.a=null}function Bo(t,e){this.name=t,this.value=e}Fo.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||S(),delete this.a},Bo.prototype.toString=function(){return this.name};var qo=new Bo("SEVERE",1e3),jo=new Bo("WARNING",900),zo=new Bo("CONFIG",700),Ko=new Bo("FINE",500);Vo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(k("Root logger has no level set."),null)}(this).value)for(g(e)&&(e=e()),t=new Fo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Go={},Wo=null;function Qo(t){var e;if(Wo||(Wo=new Vo(""),Go[""]=Wo,Wo.c=zo),!(e=Go[t])){e=new Vo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Qo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,Go[t]=e}return e}function Ho(t,e){t&&t.log(Ko,e,void 0)}function Yo(t){this.f=t}function Xo(t){an.call(this),this.o=t,this.readyState=Jo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Qo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}N(Yo,Ro),Yo.prototype.a=function(){return new Xo(this.f)},Yo.prototype.b=function(t){return function(){return t}}({}),N(Xo,an);var Jo=0;function $o(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function Zo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,ta(t)}function ta(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ea(t){an.call(this),this.headers=new dn,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=na,this.v=this.P=!1}(t=Xo.prototype).open=function(t,e){if(this.readyState!=Jo)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,ta(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Zo(this,!1)),this.readyState=Jo},t.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,ta(this)),this.a&&(this.readyState=3,ta(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,$o(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},t.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Zo(this,!0):ta(this),3==this.readyState&&$o(this)}},t.ic=function(t){this.a&&(this.response=this.responseText=t,Zo(this,!0))},t.hc=function(t){this.a&&(this.response=t,Zo(this,!0))},t.Oa=function(t){var e=this.h;e&&e.log(jo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Zo(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(jo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(jo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},N(ea,an);var na="";ea.prototype.b=Qo("goog.net.XhrIo");var ra=/^https?$/i,ia=["POST","PUT"];function oa(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.O=n,t.I=!1,t.c=!0,t.a=t.B?t.B.a():Ao.a(),t.w=t.B?Oo(t.B):Oo(Ao),t.a.onreadystatechange=E(t.Lb,t);try{Ho(t.b,da(t,"Opening Xhr")),t.J=!0,t.a.open(n,String(e),!0),t.J=!1}catch(e){return Ho(t.b,da(t,"Error opening Xhr: "+e.message)),void sa(t,e)}e=r||"";var o=new dn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(m(t)||s(t))F(t,e,void 0);else for(var n=pn(t),r=fn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=aa,n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}(o.X()),r=a.FormData&&e instanceof a.FormData,!q(ia,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.P&&(t.a.withCredentials=t.P);try{la(t),0<t.g&&(t.v=function(t){return be&&_e(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Ho(t.b,da(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=E(t.Ia,t)):t.o=hn(t.Ia,t.g,t)),Ho(t.b,da(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Ho(t.b,da(t,"Send error: "+e.message)),sa(t,e)}}function aa(t){return"content-type"==t.toLowerCase()}function sa(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ua(t),ha(t)}function ua(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ca(t){if(t.c&&void 0!==o)if(t.w[1]&&4==fa(t)&&2==pa(t))Ho(t.b,da(t,"Local request error detected and ignored"));else if(t.i&&4==fa(t))hn(t.Lb,0,t);else if(t.dispatchEvent("readystatechange"),4==fa(t)){Ho(t.b,da(t,"Request complete")),t.c=!1;try{var e,n=pa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.l).match(yn)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!ra.test(s?s.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<fa(t)?t.a.statusText:""}catch(e){Ho(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+pa(t)+"]",ua(t)}}finally{ha(t)}}}function ha(t,e){if(t.a){la(t);var n=t.a,r=t.w[0]?l:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(qo,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function la(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(a.clearTimeout(t.o),t.o=null)}function fa(t){return t.a?t.a.readyState:0}function pa(t){try{return 2<fa(t)?t.a.status:-1}catch(t){return-1}}function da(t,e){return e+" ["+t.O+" "+t.l+" "+pa(t)+"]"}function ma(t){var e=Aa;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ga(t,e,n){t.a=!0,t.c=n,t.f=!e,wa(t)}function ya(t){if(t.a){if(!t.u)throw new Ta(t);t.u=!1}}function va(t,e,n,r){t.g.push([e,n,r]),t.a&&wa(t)}function ba(t){return B(t.g,(function(t){return g(t[1])}))}function wa(t){if(t.h&&t.a&&ba(t)){var e=t.h,n=Sa[e];n&&(a.clearTimeout(n.a),delete Sa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var u=o.call(i||t.o,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(A(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,ba(t)||(n=!0)}}t.c=e,r&&(u=E(t.m,t,!0),r=E(t.m,t,!1),e instanceof ma?(va(e,u,r),e.w=!0):e.then(u,r)),n&&(e=new Ia(e),Sa[e.a]=e,t.h=e.a)}function Ta(){C.call(this)}function Ea(){C.call(this)}function Ia(t){this.a=a.setTimeout(E(this.c,this),0),this.b=t}(t=ea.prototype).Ia=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Ho(this.b,da(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Ho(this.b,da(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ha(this))},t.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ha(this,!0)),ea.qb.za.call(this)},t.Lb=function(){this.va||(this.J||this.i||this.f?ca(this):this.yc())},t.yc=function(){ca(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case na:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(qo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return Ho(this.b,"Can not get response: "+t.message),null}},ma.prototype.cancel=function(t){if(this.a)this.c instanceof ma&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new Ea(this),ya(this),ga(this,!1,t))}},ma.prototype.m=function(t,e){this.i=!1,ga(this,t,e)},ma.prototype.then=function(t,e,n){var r,i,o=new Gt((function(t,e){r=t,i=e}));return va(this,r,(function(t){t instanceof Ea?o.cancel():i(t)})),o.then(t,e,n)},ma.prototype.$goog_Thenable=!0,N(Ta,C),Ta.prototype.message="Deferred has already fired",Ta.prototype.name="AlreadyCalledError",N(Ea,C),Ea.prototype.message="Deferred was canceled",Ea.prototype.name="CanceledError",Ia.prototype.c=function(){throw delete Sa[this.a],this.b};var Sa={};function Na(t){var e={},n=e.document||document,r=rt(t).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},s=new ma(o),u=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(u=window.setTimeout((function(){Ca(i,!0);var t=new _a(ka,"Timeout reached for loading script "+r);ya(s),ga(s,!1,t)}),l),o.Ia=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ca(i,e.hd||!1,u),ya(s),ga(s,!0,null))},i.onerror=function(){Ca(i,!0,u);var t=new _a(Da,"Error while loading script "+r);ya(s),ga(s,!1,t)},X(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Kn(i,o),function(t,e){P(t,"HTMLScriptElement"),t.src=rt(e),null===h&&(h=(e=(e=a.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&c.test(e)?e:""),(e=h)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),s}function Aa(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&Ca(t,!0,this.Ia)}}function Ca(t,e,n){null!=n&&a.clearTimeout(n),t.onload=l,t.onerror=l,t.onreadystatechange=l,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Da=0,ka=1;function _a(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),C.call(this,n),this.code=t}function Ra(t){this.f=t}function Oa(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||xa,this.g=H(t.secureTokenHeaders||Pa),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||Ua,this.a=H(t.firebaseHeaders||Fa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==lr(),!(n=a.XMLHttpRequest||n&&ot.INTERNAL.node&&ot.INTERNAL.node.XMLHttpRequest)&&!hr())throw new $r("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,hr()?this.f=new Yo(self):fr()?this.f=new Ra(n):this.f=new xo,this.b=null}N(_a,C),N(Ra,Ro),Ra.prototype.a=function(){return new this.f},Ra.prototype.b=function(){return{}};var Ma,La="idToken",xa=new Rr(3e4,6e4),Pa={"Content-Type":"application/x-www-form-urlencoded"},Ua=new Rr(3e4,6e4),Fa={"Content-Type":"application/json"};function Va(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ba(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function qa(t,e,n,r,i,o,s){(function(){var t=vr();return!((t=mr(t)!=dr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!be||!De||9<De)})()||hr()?t=E(t.o,t):(Ma||(Ma=new Gt((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{a[za]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){va(t,null,e,void 0)}(Na(it(ja,{onload:za})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=E(t.m,t)),t(e,n,r,i,o,s)}Oa.prototype.R=function(){return this.b},Oa.prototype.o=function(t,e,n,r,i,o){if(hr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new $r("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ea(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout((function(){s.dispatchEvent("timeout")}),o)}sn(s,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Ho(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),un(s,"ready",(function(){u&&clearTimeout(u),me(this)})),un(s,"timeout",(function(){u&&clearTimeout(u),me(this),e&&e(null)})),oa(s,t,n,r,i)};var ja=new J(tt,"https://apis.google.com/js/client.js?onload=%{onload}"),za="__fcb"+Math.floor(1e6*Math.random()).toString();function Ka(t){if(!s(t=t.email)||!ar.test(t))throw new $r("invalid-email")}function Ga(t){"email"in t&&Ka(t)}function Wa(t){if(!t[La])throw new $r("internal-error")}function Qa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new $r("internal-error")}else{if(!t.sessionInfo)throw new $r("missing-verification-id");if(!t.code)throw new $r("missing-verification-code")}}Oa.prototype.m=function(t,e,n,r,i){var o=this;Ma.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Oa.prototype.ob=function(){return ks(this,ws,{})},Oa.prototype.rb=function(t,e){return ks(this,vs,{idToken:t,email:e})},Oa.prototype.sb=function(t,e){return ks(this,bs,{idToken:t,password:e})};var Ha={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Ya(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new $r("internal-error")}function Xa(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Fn(t=new Ln(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Ja(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=_o(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=_o(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=_o(t)):t.errorMessage&&(e=_s(t.errorMessage)),e)throw e;if(!t[La])throw new $r("internal-error")}function $a(t,e){return e.returnIdpCredential=!0,ks(t,Ts,e)}function Za(t,e){return e.returnIdpCredential=!0,ks(t,Is,e)}function ts(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ks(t,Es,e)}function es(t){if(!t.oobCode)throw new $r("invalid-action-code")}(t=Oa.prototype).tb=function(t,e){var n={idToken:t},r=[];return W(Ha,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),ks(this,vs,n)},t.kb=function(t,e){return X(t={requestType:"PASSWORD_RESET",email:t},e),ks(this,ps,t)},t.lb=function(t,e){return X(t={requestType:"EMAIL_SIGNIN",email:t},e),ks(this,ls,t)},t.jb=function(t,e){return X(t={requestType:"VERIFY_EMAIL",idToken:t},e),ks(this,fs,t)},t.Wa=function(t){return ks(this,As,t)},t.ab=function(t,e){return ks(this,gs,{oobCode:t,newPassword:e})},t.Ma=function(t){return ks(this,rs,{oobCode:t})},t.Ya=function(t){return ks(this,ns,{oobCode:t})};var ns={endpoint:"setAccountInfo",D:es,fa:"email",F:!0},rs={endpoint:"resetPassword",D:es,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new $r("internal-error")},F:!0},is={endpoint:"signupNewUser",D:function(t){if(Ka(t),!t.password)throw new $r("weak-password")},K:Wa,T:!0,F:!0},os={endpoint:"createAuthUri",F:!0},as={endpoint:"deleteAccount",V:["idToken"]},ss={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!d(t.deleteProvider))throw new $r("internal-error")}},us={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ka,K:Wa,T:!0,F:!0},cs={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ka,K:Wa,T:!0},hs={endpoint:"getAccountInfo"},ls={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new $r("internal-error");Ka(t)},fa:"email",F:!0},fs={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new $r("internal-error")},fa:"email",F:!0},ps={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new $r("internal-error");Ka(t)},fa:"email",F:!0},ds={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},ms={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new $r("internal-error")}},gs={endpoint:"resetPassword",D:es,fa:"email",F:!0},ys={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},vs={endpoint:"setAccountInfo",V:["idToken"],D:Ga,T:!0},bs={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(Ga(t),!t.password)throw new $r("weak-password")},K:Wa,T:!0},ws={endpoint:"signupNewUser",K:Wa,T:!0,F:!0},Ts={endpoint:"verifyAssertion",D:Ya,Ra:Xa,K:Ja,T:!0,F:!0},Es={endpoint:"verifyAssertion",D:Ya,Ra:Xa,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new $r("user-not-found");if(t.errorMessage)throw _s(t.errorMessage);if(!t[La])throw new $r("internal-error")},T:!0,F:!0},Is={endpoint:"verifyAssertion",D:function(t){if(Ya(t),!t.idToken)throw new $r("internal-error")},Ra:Xa,K:Ja,T:!0},Ss={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new $r("invalid-custom-token")},K:Wa,T:!0,F:!0},Ns={endpoint:"verifyPassword",D:function(t){if(Ka(t),!t.password)throw new $r("wrong-password")},K:Wa,T:!0,F:!0},As={endpoint:"verifyPhoneNumber",D:Qa,K:Wa,F:!0},Cs={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new $r("internal-error");Qa(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",_o(t);Wa(t)}},Ds={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Qa,K:Wa,F:!0};function ks(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.V))return Zt(new $r("internal-error"));var r,i=e.Kb||"POST";return $t(n).then(e.D).then((function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o){var a=Sn(t.h+e);En(a,"key",t.c),o&&En(a,"cb",S().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&En(a,u,r[u]);return new Gt((function(e,o){qa(t,a.toString(),(function(t){t?t.error?o(Rs(t,i||{})):e(t):o(new $r("network-request-failed"))}),n,s?void 0:Hn(Ar(r)),t.a,t.i.get())}))}(t,e.endpoint,i,n,e.Yb,e.wb||!1)})).then((function(t){return r=t,e.Ra?e.Ra(n,r):r})).then(e.K).then((function(){if(!e.fa)return r;if(!(e.fa in r))throw new $r("internal-error");return r[e.fa]}))}function _s(t){return Rs({error:{errors:[{message:t}],code:400,message:t}})}function Rs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new $r(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",X(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new $r(r[i],e);return!e&&t&&(e=Nr(t)),new $r("internal-error",e)}function Os(t){this.b=t,this.a=null,this.gb=function(t){return(Ps||(Ps=new Gt((function(t,e){function n(){_r(),br("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){_r(),e(Error("Network Error"))},timeout:Ls.get()})}if(br("gapi.iframes.Iframe"))t();else if(br("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){br("gapi.load")?n():e(Error("Network Error"))},$t(Na(r=it(Ms,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw Ps=null,t})))).then((function(){return new Gt((function(e,n){br("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),xs.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var Ms=new J(tt,"https://apis.google.com/js/api.js?onload=%{onload}"),Ls=new Rr(3e4,6e4),xs=new Rr(5e3,15e3),Ps=null;function Us(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Nn(this.i,"/__/auth/iframe"),En(this.a,"apiKey",this.g),En(this.a,"appName",this.h),this.b=null,this.c=[]}function Fs(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function Vs(t){try{return ot.app(t).auth().Ca()}catch(t){return[]}}function Bs(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function qs(t){var e=tr();return function(t){return ks(t,ds,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Sn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Sn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:or.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Do(tr())}))}function js(t){return t.l?t.l:(t.l=sr().then((function(){if(!t.o){var e=t.c,n=t.h,r=Vs(t.b),i=new Us(t.u,t.f,t.b);i.f=e,i.b=n,i.c=G(r||[]),t.o=i.toString()}t.i=new Os(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then((function(){t.a.register("authEvent",e,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.i,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=So(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",$t(n)}return n.status="ERROR",$t(n)}))}(t)})),t.l)}function zs(t){return t.m||(t.v=t.c?yr(t.c,Vs(t.b)):null,t.m=new Oa(t.f,_i(t.h),t.v)),t.m}function Ks(t,e,n,r,i,o,a,s,u,c,h){return(t=new Fs(t,e,n,r,i)).l=o,t.g=a,t.i=s,t.b=H(u||null),t.f=c,t.nb(h).toString()}function Gs(t){if(this.a=t||ot.INTERNAL.reactNative&&ot.INTERNAL.reactNative.AsyncStorage,!this.a)throw new $r("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Ws(t){this.b=t,this.a={},this.f=E(this.c,this)}Us.prototype.toString=function(){return this.f?En(this.a,"v",this.f):Un(this.a.a,"v"),this.b?En(this.a,"eid",this.b):Un(this.a.a,"eid"),this.c.length?En(this.a,"fw",this.c.join(",")):Un(this.a.a,"fw"),this.a.toString()},Fs.prototype.nb=function(t){return this.h=t,this},Fs.prototype.toString=function(){var t=Nn(this.o,"/__/auth/handler");if(En(t,"apiKey",this.m),En(t,"appName",this.c),En(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=ot.app(this.c).auth().ha()}catch(t){n=null}for(var r in e.bb=n,En(t,"providerId",this.a.providerId),n=Ar((e=this.a).zb))n[r]=n[r].toString();r=e.Fc,n=H(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.eb&&e.bb&&!n[e.eb]&&(n[e.eb]=e.bb),Q(n)||En(t,"customParameters",Nr(n))}if("function"==typeof this.a.Hb&&((e=this.a.Hb()).length&&En(t,"scopes",e.join(","))),this.l?En(t,"redirectUrl",this.l):Un(t.a,"redirectUrl"),this.g?En(t,"eventId",this.g):Un(t.a,"eventId"),this.i?En(t,"v",this.i):Un(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!In(t,a)&&En(t,a,this.b[a]);return this.h?En(t,"tid",this.h):Un(t.a,"tid"),this.f?En(t,"eid",this.f):Un(t.a,"eid"),(a=Vs(this.c)).length&&En(t,"fw",a.join(",")),t.toString()},(t=Bs.prototype).Fb=function(t,e,n){var r=new $r("popup-closed-by-user"),i=new $r("web-storage-unsupported"),o=this,a=!1;return this.ia().then((function(){(function(t){var e={type:"webStorageSupport"};return js(t).then((function(){return function(t,e){return t.gb.then((function(){return new Gt((function(n){t.a.send(e.type,e,n,br("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.i,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&rr(t),e(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(t){return new Gt((function(e){return function n(){ln(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return ln(n).then((function(){e(r)}))}))},t.Ob=function(){var t=vr();return!Sr(t)&&!kr(t)},t.Jb=function(){return!1},t.Db=function(t,e,n,r,i,o,a,s){if(!t)return Zt(new $r("popup-blocked"));if(a&&!Sr())return this.ia().s((function(e){rr(t),i(e)})),r(),$t();this.a||(this.a=qs(zs(this)));var u=this;return this.a.then((function(){var e=u.ia().s((function(e){throw rr(t),i(e),e}));return r(),e})).then((function(){(Eo(n),a)||er(Ks(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Eb=function(t,e,n,r){this.a||(this.a=qs(zs(this)));var i=this;return this.a.then((function(){Eo(e),er(Ks(i.u,i.f,i.b,t,e,tr(),n,i.c,void 0,i.h,r))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ia=function(){var t=this;return js(this).then((function(){return t.i.gb})).s((function(){throw t.a=null,new $r("network-request-failed")}))},t.Rb=function(){return!0},t.Aa=function(t){this.g.push(t)},t.Na=function(t){z(this.g,(function(e){return e==t}))},(t=Gs.prototype).get=function(t){return $t(this.a.getItem(t)).then((function(t){return t&&Cr(t)}))},t.set=function(t,e){return $t(this.a.setItem(t,Nr(e)))},t.S=function(t){return $t(this.a.removeItem(t))},t.$=function(){},t.ea=function(){};var Qs,Hs=[];function Ys(t,e,n){Q(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Xs(t){this.a=t}function Js(t){this.c=t,this.b=!1,this.a=[]}function $s(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Zt(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Gt((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return Zs(t,c),e})).s((function(e){throw Zs(t,c),e}))}function Zs(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),z(t.a,(function(t){return t==e}))}}function tu(){if(!ru())throw new $r("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=a.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;hr()&&self?(this.l=function(){var t=hr()?self:null;if(F(Hs,(function(n){n.b==t&&(e=n)})),!e){var e=new Ws(t);Hs.push(e)}return e}(),Ys(this.l,"keyChanged",(function(e,n){return uu(t).then((function(e){return 0<e.length&&F(t.a,(function(t){t(e)})),{keyProcessed:q(e,n.key)}}))})),Ys(this.l,"ping",(function(){return $t(["keyChanged"])}))):function(){var t=a.navigator;return t&&t.serviceWorker?$t().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):$t(null)}().then((function(e){(t.h=e)&&(t.g=new Js(new Xs(e)),$s(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&q(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function eu(t){return new Gt((function(e,n){var r=t.u.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Gt((function(e,n){var r=t.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return eu(t)})).then((function(t){e(t)})).s((function(t){n(t)}))}}))}function nu(t){return t.m||(t.m=eu(t)),t.m}function ru(){try{return!!a.indexedDB}catch(t){return!1}}function iu(t){return t.objectStore("firebaseLocalStorage")}function ou(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function au(t){return new Gt((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function su(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?$s(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):$t()}function uu(t){return nu(t).then((function(t){var e=iu(ou(t,!1));return e.getAll?au(e.getAll()):new Gt((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function cu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function hu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=$t().then((function(){if(ru()){var t=Dr(),r="__sak"+t;return Qs||(Qs=new tu),(n=Qs).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.S(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.$((function(t){F(e.a,(function(e){e(t)}))})),t}))}function lu(){this.a={},this.type="inMemory"}function fu(){if(!function(){var t="Node"==lr();if(!(t=pu()||t&&ot.INTERNAL.node&&ot.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==lr())throw new $r("internal-error","The LocalStorage compatibility library was not found.");throw new $r("web-storage-unsupported")}this.a=pu()||ot.INTERNAL.node.localStorage,this.type="localStorage"}function pu(){try{var t=a.localStorage,e=Dr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function du(){this.type="nullStorage"}function mu(){if(!function(){var t="Node"==lr();if(!(t=gu()||t&&ot.INTERNAL.node&&ot.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==lr())throw new $r("internal-error","The SessionStorage compatibility library was not found.");throw new $r("web-storage-unsupported")}this.a=gu()||ot.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function gu(){try{var t=a.sessionStorage,e=Dr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function yu(){var t={};t.Browser=wu,t.Node=Tu,t.ReactNative=Eu,t.Worker=Iu,this.a=t[lr()]}Ws.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];F(r,(function(e){i.push($t().then((function(){return e(t.origin,t.data.data)})))})),ee(i).then((function(r){var i=[];F(r,(function(t){i.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})})),F(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Xs.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Js.prototype.close=function(){for(;0<this.a.length;)Zs(this,this.a[0]);this.b=!0},(t=tu.prototype).set=function(t,e){var n,r=!1,i=this;return nu(this).then((function(e){return au((e=iu(ou(n=e,!0))).get(t))})).then((function(o){var a=iu(ou(n,!0));return o?(o.value=e,au(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,au(a.add(o)))})).then((function(){return i.c[t]=e,su(i,t)})).ka((function(){r&&i.b--}))},t.get=function(t){return nu(this).then((function(e){return au(iu(ou(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.S=function(t){var e=!1,n=this;return nu(this).then((function(r){return e=!0,n.b++,au(iu(ou(r,!0)).delete(t))})).then((function(){return delete n.c[t],su(n,t)})).ka((function(){e&&n.b--}))},t.$=function(t){0==this.a.length&&function(t){cu(t),function e(){t.f=setTimeout((function(){t.i=uu(t).then((function(e){0<e.length&&F(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ea=function(t){z(this.a,(function(e){return e==t})),0==this.a.length&&cu(this)},(t=hu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.S=function(t){return this.b.then((function(e){return e.S(t)}))},t.$=function(t){this.a.push(t)},t.ea=function(t){z(this.a,(function(e){return e==t}))},(t=lu.prototype).get=function(t){return $t(this.a[t])},t.set=function(t,e){return this.a[t]=e,$t()},t.S=function(t){return delete this.a[t],$t()},t.$=function(){},t.ea=function(){},(t=fu.prototype).get=function(t){var e=this;return $t().then((function(){return Cr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return $t().then((function(){var r=Nr(e);null===r?n.S(t):n.a.setItem(t,r)}))},t.S=function(t){var e=this;return $t().then((function(){e.a.removeItem(t)}))},t.$=function(t){a.window&&Qe(a.window,"storage",t)},t.ea=function(t){a.window&&Xe(a.window,"storage",t)},(t=du.prototype).get=function(){return $t(null)},t.set=function(){return $t()},t.S=function(){return $t()},t.$=function(){},t.ea=function(){},(t=mu.prototype).get=function(t){var e=this;return $t().then((function(){return Cr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return $t().then((function(){var r=Nr(e);null===r?n.S(t):n.a.setItem(t,r)}))},t.S=function(t){var e=this;return $t().then((function(){e.a.removeItem(t)}))},t.$=function(){},t.ea=function(){};var vu,bu,wu={C:fu,Ta:mu},Tu={C:fu,Ta:mu},Eu={C:Gs,Ta:du},Iu={C:fu,Ta:du},Su={ad:"local",NONE:"none",cd:"session"};function Nu(){var t=!(kr(vr())||!cr()),e=Sr(),n=wr();this.m=t,this.h=e,this.l=n,this.a={},vu||(vu=new yu),t=vu;try{this.g=!Zn()&&Lr()||!a.indexedDB?new t.a.C:new hu(hr()?new lu:new t.a.C)}catch(t){this.g=new lu,this.h=!0}try{this.i=new t.a.Ta}catch(t){this.i=new lu}this.u=new lu,this.f=E(this.Pb,this),this.b={}}function Au(){return bu||(bu=new Nu),bu}function Cu(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function Du(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ku(t,e,n){return n=Du(e,n),"local"==e.C&&(t.b[n]=null),Cu(t,e.C).S(n)}function _u(t){t.c&&(clearInterval(t.c),t.c=null)}function Ru(t){this.a=t,this.b=Au()}(t=Nu.prototype).get=function(t,e){return Cu(this,t.C).get(Du(t,e))},t.set=function(t,e,n){var r=Du(t,n),i=this,o=Cu(this,t.C);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.C&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=Du(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),Q(this.a)&&(Cu(this,"local").$(this.f),this.h||(Zn()||!Lr())&&a.indexedDB||!this.l||function(t){_u(t),t.c=setInterval((function(){for(var e in t.a){var n=a.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Pe({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Pb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Du(t,e),this.a[t]&&(z(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),Q(this.a)&&(Cu(this,"local").ea(this.f),_u(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Cu(this,"local").ea(this.f):_u(this),this.m)if(n=a.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?a.localStorage.setItem(e,r):a.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.$a(e))},be&&De&&10==De&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else F(t,E(this.$a,this))},t.$a=function(t){this.a[t]&&F(this.a[t],(function(t){t()}))};var Ou,Mu={name:"authEvent",C:"local"};function Lu(){this.a=Au()}function xu(t,e){this.b=Pu,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0!==Ou||(Ou=a.Int32Array?new Int32Array(zu):zu),this.reset()}N(xu,(function(){this.b=-1}));for(var Pu=64,Uu=Pu-1,Fu=[],Vu=0;Vu<Uu;Vu++)Fu[Vu]=0;var Bu=K(128,Fu);function qu(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Ou[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function ju(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(s(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(qu(t),i=0);else{if(!m(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(qu(t),i=0)}}t.c=i,t.g+=n}xu.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):G(this.h)};var zu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ku(){xu.call(this,8,Gu)}N(Ku,xu);var Gu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Wu(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=i||null,this.h=e+":"+n,this.v=new Lu,this.g=new Ru(this.h),this.f=null,this.b=[],this.a=this.c=null}function Qu(t){return new $r("invalid-cordova-configuration",t)}function Hu(t){var e=new Ku;ju(e,t),t=[];var n=8*e.g;56>e.c?ju(e,Bu,56-e.c):ju(e,Bu,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(qu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return V(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Yu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Xu(t){return t.f||(t.f=t.ia().then((function(){return new Gt((function(e){t.Aa((function n(r){return e(r),t.Na(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Ju(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Ki(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Cr(In(o=Sn(i),"firebaseError")||null))?Zr(o):null)?new Io(r.c,r.b,null,null,o,null,r.R()):new Io(r.c,r.b,i,r.f,null,null,r.R())),i=o||n}Yu(t,i)}))}var n=new Io("unknown",null,null,null,new $r("no-auth-event")),r=!1,i=ln(500).then((function(){return Ju(t).then((function(){r||Yu(t,n)}))})),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(br("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Co||(Co=new No),function(t){var e=Co;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=br("universalLinks.subscribe",a))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Ju(t){var e=null;return function(t){return t.b.get(Mu,t.a).then((function(t){return So(t)}))}(t.g).then((function(n){return e=n,ku((n=t.g).b,Mu,n.a)})).then((function(){return e}))}function $u(t){this.a=t,this.b=Au()}(t=Wu.prototype).ia=function(){return this.Da?this.Da:this.Da=(ur(void 0)?sr().then((function(){return new Gt((function(t,e){var n=a.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Zt(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof br("universalLinks.subscribe",a))throw Qu("cordova-universal-links-plugin-fix is not installed");if(void 0===br("BuildInfo.packageName",a))throw Qu("cordova-plugin-buildinfo is not installed");if("function"!=typeof br("cordova.plugins.browsertab.openUrl",a))throw Qu("cordova-plugin-browsertab is not installed");if("function"!=typeof br("cordova.InAppBrowser.open",a))throw Qu("cordova-plugin-inappbrowser is not installed")}),(function(){throw new $r("cordova-not-ready")}))},t.Fb=function(t,e){return e(new $r("operation-not-supported-in-this-environment")),$t()},t.Db=function(){return Zt(new $r("operation-not-supported-in-this-environment"))},t.Rb=function(){return!1},t.Ob=function(){return!0},t.Jb=function(){return!0},t.Eb=function(t,e,n,r){if(this.c)return Zt(new $r("redirect-operation-pending"));var i=this,o=a.document,s=null,u=null,c=null,h=null;return this.c=$t().then((function(){return Eo(e),Xu(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Io(e,r,null,o,new $r("no-auth-event"),null,i),u=br("BuildInfo.packageName",a);if("string"!=typeof u)throw new $r("invalid-cordova-configuration");var c=br("BuildInfo.displayName",a),h={};if(vr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!vr().toLowerCase().match(/android/))return Zt(new $r("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=Hu(o),h.sessionId=o;var l=Ks(t.u,t.i,t.l,e,n,null,r,t.m,h,t.o,i);return t.ia().then((function(){var e=t.h;return t.v.a.set(Mu,s.A(),e)})).then((function(){var e=br("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new $r("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=br("cordova.plugins.browsertab.openUrl",a)))throw new $r("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=br("cordova.InAppBrowser.open",a)))throw new $r("invalid-cordova-configuration");e=vr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Gt((function(t,e){u=function(){var e=br("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(u),c=function(){s||(s=ln(2e3).then((function(){e(new $r("redirect-cancelled-by-user"))})))},h=function(){Or()&&c()},o.addEventListener("resume",c,!1),vr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).s((function(t){return Ju(i).then((function(){throw t}))}))})).ka((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),u&&i.Na(u),i.c=null}))},t.Aa=function(t){this.b.push(t),Xu(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Io("unknown",null,null,null,new $r("no-auth-event")),t(e))}))},t.Na=function(t){z(this.b,(function(e){return e==t}))};var Zu={name:"pendingRedirect",C:"session"};function tc(t){return ku(t.b,Zu,t.a)}function ec(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=E(this.o,this),this.b=new mc,this.w=new wc,this.g=new $u(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=nc(this.B,this.u,this.m,Di)}function nc(t,e,n,r){var i=ot.SDK_VERSION||null;return ur()?new Wu(t,e,n,i,r):new Bs(t,e,n,i,r)}function rc(t){t.f||(t.f=!0,t.a.Aa(t.l));var e=t.a;return t.a.ia().s((function(n){throw t.a==e&&t.reset(),n}))}function ic(t){t.a.Ob()&&rc(t).s((function(e){var n=new Io("unknown",null,null,null,new $r("operation-not-supported-in-this-environment"));hc(e)&&t.o(n)})),t.a.Jb()||gc(t.b)}function oc(t,e){q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Zu,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?tc(t.g).then((function(){rc(t).s((function(e){var n=new Io("unknown",null,null,null,new $r("operation-not-supported-in-this-environment"));hc(e)&&t.o(n)}))})):ic(t)})).s((function(){ic(t)}))}function ac(t,e){z(t.h,(function(t){return t==e}))}ec.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=nc(this.B,this.u,this.m),this.i={}},ec.prototype.o=function(t){if(!t)throw new $r("invalid-auth-event");if(6e5<=S()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=S())),e=!0;break}}return gc(this.b),e};var sc=new Rr(2e3,1e4),uc=new Rr(3e4,6e4);function cc(t,e,n,r,i,o,a){return t.a.Db(e,n,r,(function(){t.f||(t.f=!0,t.a.Aa(t.l))}),(function(){t.reset()}),i,o,a)}function hc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function lc(t,e,n,r,i){var o;return function(t){return t.b.set(Zu,"pending",t.a)}(t.g).then((function(){return t.a.Eb(e,n,r,i).s((function(e){if(hc(e))throw new $r("operation-not-supported-in-this-environment");return o=e,tc(t.g).then((function(){throw o}))})).then((function(){return t.a.Rb()?new Gt((function(){})):tc(t.g).then((function(){return t.oa()})).then((function(){})).s((function(){}))}))}))}function fc(t,e,n,r,i){return t.a.Fb(r,(function(t){e.ja(n,null,t,i)}),sc.get())}ec.prototype.oa=function(){return this.b.oa()};var pc={};function dc(t,e,n){var r=e+":"+n;return pc[r]||(pc[r]=new ec(t,e,n)),pc[r]}function mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function gc(t){t.g||(t.g=!0,bc(t,!1,null,null))}function yc(t){t.g&&!t.i&&bc(t,!1,null,null)}function vc(t,e){if(t.b=function(){return $t(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function bc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Zt(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):vc(t,n):vc(t,{user:null}),t.f=[],t.c=[]}function wc(){}function Tc(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function Ec(t,e){this.a=e,Vr(this,"verificationId",t)}function Ic(t,e,n,r){return new bo(t).Wa(e,n).then((function(t){return new Ec(t,r)}))}function Sc(t){var e=Ci(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new $r("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Br(this,{token:t,expirationTime:Mr(1e3*e.exp),authTime:Mr(1e3*e.auth_time),issuedAtTime:Mr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Nc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Ac(t){this.f=t,this.b=this.a=null,this.c=0}function Cc(t,e){var n=e[La],r=e.refreshToken;e=Dc(e.expiresIn),t.b=n,t.c=e,t.a=r}function Dc(t){return S()+1e3*parseInt(t,10)}function kc(t,e){return function(t,e){return new Gt((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?qa(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Rs(t)):t.access_token&&t.refresh_token?n(t):r(new $r("internal-error")):r(new $r("network-request-failed"))}),"POST",Pn(e).toString(),t.g,t.u.get()):r(new $r("internal-error"))}))}(t.f,e).then((function(e){return t.b=e.access_token,t.c=Dc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function _c(t,e){this.a=t||null,this.b=e||null,Br(this,{lastSignInTime:Mr(e||null),creationTime:Mr(t||null)})}function Rc(t,e,n,r,i,o){Br(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Oc(t,e){for(var n in xe.call(this,t),e)this[n]=e[n]}function Mc(t,e,n){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=ot.SDK_VERSION?yr(ot.SDK_VERSION):null,this.a=new Oa(this.l,_i(Di),t),this.b=new Ac(this.a),Bc(this,e[La]),Cc(this.b,e),Vr(this,"refreshToken",this.b.a),zc(this,n||{}),an.call(this),this.J=!1,this.o&&Tr()&&(this.i=dc(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(t){return new Nc((function(){return t.G(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-S()-3e5;return 0<e?e:0}))}(this),this.W=E(this.Ja,this);var r=this;this.ga=null,this.xa=function(t){r.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){xc(r,t.c)},this.Y=null}function Lc(t,e){t.Z&&Xe(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&Qe(e,"languageCodeChanged",t.xa)}function xc(t,e){t.P=e,Ba(t.a,ot.SDK_VERSION?yr(ot.SDK_VERSION,t.P):null)}function Pc(t,e){t.Y&&Xe(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&Qe(e,"frameworkChanged",t.wa)}function Uc(t){try{return ot.app(t.m).auth()}catch(e){throw new $r("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Fc(t){t.B||t.w.b||(t.w.start(),Xe(t,"tokenChanged",t.W),Qe(t,"tokenChanged",t.W))}function Vc(t){Xe(t,"tokenChanged",t.W),t.w.stop()}function Bc(t,e){t.ma=e,Vr(t,"_lat",e)}function qc(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return ee(e).then((function(){return t}))}function jc(t){t.i&&!t.J&&(t.J=!0,oc(t.i,t))}function zc(t,e){Br(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new _c(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Kc(){}function Gc(t){return $t().then((function(){if(t.B)throw new $r("app-deleted")}))}function Wc(t){return V(t.providerData,(function(t){return t.providerId}))}function Qc(t,e){e&&(Hc(t,e.providerId),t.providerData.push(e))}function Hc(t,e){z(t.providerData,(function(t){return t.providerId==e}))}function Yc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Vr(t,e,n)}function Xc(t,e){t!=e&&(Br(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Vr(t,"metadata",function(t){return new _c(t.a,t.b)}(e.metadata)):Vr(t,"metadata",new _c),F(e.providerData,(function(e){Qc(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Vr(t,"refreshToken",t.b.a))}function Jc(t){return t.G().then((function(e){var n=t.isAnonymous;return function(t,e){return ks(t.a,hs,{idToken:e}).then(E(t.zc,t))}(t,e).then((function(){return n||Yc(t,"isAnonymous",!1),e}))}))}function $c(t,e){e[La]&&t.ma!=e[La]&&(Cc(t.b,e),t.dispatchEvent(new Oc("tokenChanged")),Bc(t,e[La]),Yc(t,"refreshToken",t.b.a))}function Zc(t,e){return Jc(t).then((function(){if(q(Wc(t),e))return qc(t).then((function(){throw new $r("provider-already-linked")}))}))}function th(t,e,n){return qr({user:t,credential:To(e),additionalUserInfo:e=xi(e),operationType:n})}function eh(t,e){return $c(t,e),t.reload().then((function(){return t}))}function nh(t,e,n,r,i){if(!Tr())return Zt(new $r("operation-not-supported-in-this-environment"));if(t.h&&!i)return Zt(t.h);var o=Li(n.providerId),a=Dr(t.uid+":::"),s=null;(!Sr()||cr())&&t.o&&n.isOAuthProvider&&(s=Ks(t.o,t.l,t.m,e,n,null,a,ot.SDK_VERSION||null,null,null,t.tenantId));var u=ir(s,o&&o.sa,o&&o.ra);return r=r().then((function(){if(ih(t),!i)return t.G().then((function(){}))})).then((function(){return cc(t.i,u,e,n,a,!!s,t.tenantId)})).then((function(){return new Gt((function(n,r){t.ja(e,null,new $r("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.c=fc(t.i,t,e,u,a)}))})).then((function(t){return u&&rr(u),t?qr(t):null})).s((function(t){throw u&&rr(u),t})),oh(t,r,i)}function rh(t,e,n,r,i){if(!Tr())return Zt(new $r("operation-not-supported-in-this-environment"));if(t.h&&!i)return Zt(t.h);var o=null,a=Dr(t.uid+":::");return r=r().then((function(){if(ih(t),!i)return t.G().then((function(){}))})).then((function(){return t.ca=a,qc(t)})).then((function(e){return t.da&&(e=(e=t.da).b.set(uh,t.A(),e.a)),e})).then((function(){return lc(t.i,e,n,a,t.tenantId)})).s((function(e){if(o=e,t.da)return ch(t.da);throw o})).then((function(){if(o)throw o})),oh(t,r,i)}function ih(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new $r("internal-error");throw new $r("auth-domain-config-required")}}function oh(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),Zt(t.h)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Oc("userInvalidated")),t.h=e),e}))}(t,e,n);return t.I.push(r),r.ka((function(){j(t.I,r)})),r}function ah(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[La]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-S())/1e3;var r=new Mc(e,n,t);return t.providerData&&F(t.providerData,(function(t){t&&Qc(r,qr(t))})),t.redirectEventId&&(r.ca=t.redirectEventId),r}function sh(t){this.a=t,this.b=Au()}mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},mc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(bc(this,!0,null,t.a),$t()):e.Ba(n,r)?function(t,e,n){n=n.Ba(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.R(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){bc(t,s,e,null)})).s((function(e){bc(t,s,null,e)}))}(this,t,e):Zt(new $r("invalid-auth-event")):(bc(this,!1,null,null),$t())}else Zt(new $r("invalid-auth-event"))},mc.prototype.oa=function(){var t=this;return new Gt((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new $r("timeout");t.a&&t.a.cancel(),t.a=ln(uc.get()).then((function(){t.b||(t.g=!0,bc(t,!0,null,e))}))}(t))}))},wc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ja(t.c,null,t.a,t.b),$t()):e.Ba(n,r)?function(t,e){var n=t.b,r=t.c;e.Ba(r,n)(t.g,t.f,t.R(),t.i).then((function(t){e.ja(r,t,null,n)})).s((function(t){e.ja(r,null,t,n)}))}(t,e):Zt(new $r("invalid-auth-event"))}else Zt(new $r("invalid-auth-event"))},Ec.prototype.confirm=function(t){return t=wo(this.verificationId,t),this.a(t)},Nc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=ln(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=a.document,e=null;return Or()||!t?$t():new Gt((function(n){e=function(){Or()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},Nc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Ac.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Ac.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Zt(new $r("user-token-expired")):t||!this.b||S()>this.c-3e4?this.a?kc(this,{grant_type:"refresh_token",refresh_token:this.a}):$t(null):$t({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},_c.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},N(Oc,xe),N(Mc,an),Mc.prototype.ua=function(t){this.ga=t,Va(this.a,t)},Mc.prototype.ha=function(){return this.ga},Mc.prototype.Ca=function(){return G(this.P)},Mc.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},Vr(Mc.prototype,"providerId","firebase"),(t=Mc.prototype).reload=function(){var t=this;return oh(this,Gc(this).then((function(){return Jc(t).then((function(){return qc(t)})).then(Kc)})))},t.dc=function(t){return this.G(t).then((function(t){return new Sc(t)}))},t.G=function(t){var e=this;return oh(this,Gc(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new $r("internal-error");return t.accessToken!=e.ma&&(Bc(e,t.accessToken),e.dispatchEvent(new Oc("tokenChanged"))),Yc(e,"refreshToken",t.refreshToken),t.accessToken})))},t.zc=function(t){if(!(t=t.users)||!t.length)throw new $r("internal-error");zc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?V(t,(function(t){return new Rc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Qc(this,e[n]);Yc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.Ac=function(t){return Ur("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},t.hb=function(t){var e=this,n=null;return oh(this,t.f(this.a,this.uid).then((function(t){return $c(e,t),n=th(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.rc=function(t){return Ur("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},t.fb=function(t){var e=this,n=null;return oh(this,Zc(this,t.providerId).then((function(){return e.G()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=th(e,t,"link"),eh(e,t)})).then((function(){return n})))},t.sc=function(t,e){var n=this;return oh(this,Zc(this,"phone").then((function(){return Ic(Uc(n),t,e,E(n.fb,n))})))},t.Bc=function(t,e){var n=this;return oh(this,$t().then((function(){return Ic(Uc(n),t,e,E(n.hb,n))})),!0)},t.rb=function(t){var e=this;return oh(this,this.G().then((function(n){return e.a.rb(n,t)})).then((function(t){return $c(e,t),e.reload()})))},t.Sc=function(t){var e=this;return oh(this,this.G().then((function(n){return t.b(e.a,n)})).then((function(t){return $c(e,t),e.reload()})))},t.sb=function(t){var e=this;return oh(this,this.G().then((function(n){return e.a.sb(n,t)})).then((function(t){return $c(e,t),e.reload()})))},t.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Gc(this);var e=this;return oh(this,this.G().then((function(n){return e.a.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return $c(e,t),Yc(e,"displayName",t.displayName||null),Yc(e,"photoURL",t.photoUrl||null),F(e.providerData,(function(t){"password"===t.providerId&&(Vr(t,"displayName",e.displayName),Vr(t,"photoURL",e.photoURL))})),qc(e)})).then(Kc))},t.Qc=function(t){var e=this;return oh(this,Jc(this).then((function(n){return q(Wc(e),t)?function(t,e,n){return ks(t,ss,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return F(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),F(Wc(e),(function(t){n[t]||Hc(e,t)})),n[bo.PROVIDER_ID]||Vr(e,"phoneNumber",null),qc(e)})):qc(e).then((function(){throw new $r("no-such-provider")}))})))},t.delete=function(){var t=this;return oh(this,this.G().then((function(e){return ks(t.a,as,{idToken:e})})).then((function(){t.dispatchEvent(new Oc("userDeleted"))}))).then((function(){for(var e=0;e<t.I.length;e++)t.I[e].cancel("app-deleted");Lc(t,null),Pc(t,null),t.I=[],t.B=!0,Vc(t),Vr(t,"refreshToken",null),t.i&&ac(t.i,t)}))},t.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},t.ja=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?E(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?E(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?E(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?E(this.Cb,this):null},t.tc=function(t){var e=this;return nh(this,"linkViaPopup",t,(function(){return Zc(e,t.providerId).then((function(){return qc(e)}))}),!1)},t.Cc=function(t){return nh(this,"reauthViaPopup",t,(function(){return $t()}),!0)},t.uc=function(t){var e=this;return rh(this,"linkViaRedirect",t,(function(){return Zc(e,t.providerId)}),!1)},t.Dc=function(t){return rh(this,"reauthViaRedirect",t,(function(){return $t()}),!0)},t.Bb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return oh(this,this.G().then((function(n){return Za(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=th(i,t,"link"),eh(i,t)})).then((function(){return o})))},t.Cb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return oh(this,$t().then((function(){return Wi(ts(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=th(i,t,"reauthenticate"),$c(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},t.jb=function(t){var e=this,n=null;return oh(this,this.G().then((function(e){return n=e,void 0===t||Q(t)?{}:Ti(new li(t))})).then((function(t){return e.a.jb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.toJSON=function(){return this.A()},t.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&X(t,this.metadata.A()),F(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),t};var uh={name:"redirectUser",C:"session"};function ch(t){return ku(t.b,uh,t.a)}function hh(t){this.a=t,this.b=Au(),this.c=null,this.f=function(t){var e=ph("local"),n=ph("session"),r=ph("none");return function(t,e,n){var r=Du(e,n),i=Cu(t,e.C);return t.get(e,n).then((function(o){var s=null;try{s=Cr(a.localStorage.getItem(r))}catch(t){}if(s&&!o)return a.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(fh,t.a).then((function(t){return t?ph(t):e}))}))}))})).then((function(e){return t.c=e,lh(t,e.C)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(ph("local"),this.a,E(this.g,this))}function lh(t,e){var n,r=[];for(n in Su)Su[n]!==e&&r.push(ku(t.b,ph(Su[n]),t.a));return r.push(ku(t.b,fh,t.a)),function(t){return new Gt((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)te(t[s],I(o,s),a);else e(i)}))}(r)}hh.prototype.g=function(){var t=this,e=ph("local");yh(this,(function(){return $t().then((function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null})).then((function(n){if(n)return lh(t,"local").then((function(){t.c=e}))}))}))};var fh={name:"persistence",C:"session"};function ph(t){return{name:"authUser",C:t}}function dh(t,e){return yh(t,(function(){return t.b.set(t.c,e.A(),t.a)}))}function mh(t){return yh(t,(function(){return ku(t.b,t.c,t.a)}))}function gh(t,e){return yh(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),ah(t||{})}))}))}function yh(t,e){return t.f=t.f.then(e,e),t.f}function vh(t){if(this.l=!1,Vr(this,"settings",new Tc),Vr(this,"app",t),!Ah(this).options||!Ah(this).options.apiKey)throw new $r("invalid-api-key");t=ot.SDK_VERSION?yr(ot.SDK_VERSION):null,this.b=new Oa(Ah(this).options&&Ah(this).options.apiKey,_i(Di),t),this.O=[],this.m=[],this.J=[],this.Ub=ot.INTERNAL.createSubscribe(E(this.oc,this)),this.W=void 0,this.Vb=ot.INTERNAL.createSubscribe(E(this.pc,this)),Sh(this,null),this.h=new hh(Ah(this).options.apiKey+":"+Ah(this).name),this.w=new sh(Ah(this).options.apiKey+":"+Ah(this).name),this.Y=_h(this,function(t){var e=Ah(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(uh,t.a).then((function(t){return t&&e&&(t.authDomain=e),ah(t||{})}))}(t.w,Ah(t).options.authDomain).then((function(e){return(t.B=e)&&(e.da=t.w),ch(t.w)}));return _h(t,e)}(t).then((function(){return gh(t.h,e)})).then((function(e){return e?(e.da=t.w,t.B&&(t.B.ca||null)==(e.ca||null)?e:e.reload().then((function(){return dh(t.h,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:mh(t.h)}))):null})).then((function(e){Sh(t,e||null)}));return _h(t,n)}(this)),this.i=_h(this,function(t){return t.Y.then((function(){return Eh(t)})).s((function(){})).then((function(){if(!t.l)return t.ma()})).s((function(){})).then((function(){if(!t.l){t.ga=!0;var e=t.h;e.b.addListener(ph("local"),e.a,t.ma)}}))}(this)),this.ga=!1,this.ma=E(this.Nc,this),this.ub=E(this.aa,this),this.wa=E(this.bc,this),this.xa=E(this.mc,this),this.Ja=E(this.nc,this),this.a=null,function(t){var e=Ah(t).options.authDomain,n=Ah(t).options.apiKey;e&&Tr()&&(t.Tb=t.Y.then((function(){if(!t.l){if(t.a=dc(e,n,Ah(t).name),oc(t.a,t),Ch(t)&&jc(Ch(t)),t.B){jc(t.B);var r=t.B;r.ua(t.ha()),Lc(r,t),xc(r=t.B,t.I),Pc(r,t),t.B=null}return t.a}})))}(this),this.INTERNAL={},this.INTERNAL.delete=E(this.delete,this),this.INTERNAL.logFramework=E(this.vc,this),this.o=0,an.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}(this),this.I=[]}function bh(t){xe.call(this,"languageCodeChanged"),this.g=t}function wh(t){xe.call(this,"frameworkChanged"),this.c=t}function Th(t){return t.Tb||Zt(new $r("auth-domain-config-required"))}function Eh(t){if(!Tr())return Zt(new $r("operation-not-supported-in-this-environment"));var e=Th(t).then((function(){return t.a.oa()})).then((function(t){return t?qr(t):null}));return _h(t,e)}function Ih(t,e){var n={};return n.apiKey=Ah(t).options.apiKey,n.authDomain=Ah(t).options.authDomain,n.appName=Ah(t).name,t.Y.then((function(){return function(t,e,n,r){var i=new Mc(t,e);return n&&(i.da=n),r&&xc(i,r),i.reload().then((function(){return i}))}(n,e,t.w,t.Ca())})).then((function(e){return Ch(t)&&e.uid==Ch(t).uid?(Xc(Ch(t),e),t.aa(e)):(Sh(t,e),jc(e),t.aa(e))})).then((function(){kh(t)}))}function Sh(t,e){Ch(t)&&(function(t,e){z(t.O,(function(t){return t==e}))}(Ch(t),t.ub),Xe(Ch(t),"tokenChanged",t.wa),Xe(Ch(t),"userDeleted",t.xa),Xe(Ch(t),"userInvalidated",t.Ja),Vc(Ch(t))),e&&(e.O.push(t.ub),Qe(e,"tokenChanged",t.wa),Qe(e,"userDeleted",t.xa),Qe(e,"userInvalidated",t.Ja),0<t.o&&Fc(e)),Vr(t,"currentUser",e),e&&(e.ua(t.ha()),Lc(e,t),xc(e,t.I),Pc(e,t))}function Nh(t,e){var n=null,r=null;return _h(t,e.then((function(e){return n=To(e),r=xi(e),Ih(t,e)})).then((function(){return qr({user:Ch(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Ah(t){return t.app}function Ch(t){return t.currentUser}function Dh(t){return Ch(t)&&Ch(t)._lat||null}function kh(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](Dh(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](Dh(t))}}function _h(t,e){return t.O.push(e),e.ka((function(){j(t.O,e)})),e}function Rh(){}function Oh(){this.a={},this.b=1e12}hh.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new $r("invalid-persistence-type"),n=new $r("unsupported-persistence-type");t:{for(r in Su)if(Su[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(lr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!wr()&&"none"!==t)throw n}}(t),yh(this,(function(){return t!=n.c.C?n.b.get(n.c,n.a).then((function(r){return e=r,lh(n,t)})).then((function(){if(n.c=ph(t),e)return n.b.set(n.c,e,n.a)})):$t()}))},N(vh,an),N(bh,xe),N(wh,xe),(t=vh.prototype).mb=function(t){return _h(this,t=this.h.mb(t))},t.ua=function(t){this.Z===t||this.l||(this.Z=t,Va(this.b,this.Z),this.dispatchEvent(new bh(this.ha())))},t.ha=function(){return this.Z},t.Tc=function(){var t=a.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.vc=function(t){this.I.push(t),Ba(this.b,ot.SDK_VERSION?yr(ot.SDK_VERSION,this.I):null),this.dispatchEvent(new wh(this.I))},t.Ca=function(){return G(this.I)},t.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},t.R=function(){return this.P},t.toJSON=function(){return{apiKey:Ah(this).options.apiKey,authDomain:Ah(this).options.authDomain,appName:Ah(this).name,currentUser:Ch(this)&&Ch(this).A()}},t.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ja=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?E(this.ac,this):null},t.ac=function(t,e,n,r){var i=this;t={requestUri:t,postBody:r,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=$a(i.b,t).then((function(t){return o=To(t),a=xi(t),t}));return _h(this,t=i.Y.then((function(){return s})).then((function(t){return Ih(i,t)})).then((function(){return qr({user:Ch(i),credential:o,additionalUserInfo:a,operationType:"signIn"})})))},t.Lc=function(t){if(!Tr())return Zt(new $r("operation-not-supported-in-this-environment"));var e=this,n=Li(t.providerId),r=Dr(),i=null;(!Sr()||cr())&&Ah(this).options.authDomain&&t.isOAuthProvider&&(i=Ks(Ah(this).options.authDomain,Ah(this).options.apiKey,Ah(this).name,"signInViaPopup",t,null,r,ot.SDK_VERSION||null,null,null,this.R()));var o=ir(i,n&&n.sa,n&&n.ra);return _h(this,n=Th(this).then((function(n){return cc(n,o,"signInViaPopup",t,r,!!i,e.R())})).then((function(){return new Gt((function(t,n){e.ja("signInViaPopup",null,new $r("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.c=fc(e.a,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&rr(o),t?qr(t):null})).s((function(t){throw o&&rr(o),t})))},t.Mc=function(t){if(!Tr())return Zt(new $r("operation-not-supported-in-this-environment"));var e=this;return _h(this,Th(this).then((function(){return function(t){return yh(t,(function(){return t.b.set(fh,t.c.C,t.a)}))}(e.h)})).then((function(){return lc(e.a,"signInViaRedirect",t,void 0,e.R())})))},t.oa=function(){var t=this;return Eh(this).then((function(e){return t.a&&yc(t.a.b),e})).s((function(e){throw t.a&&yc(t.a.b),e}))},t.Rc=function(t){if(!t)return Zt(new $r("null-user"));if(this.P!=t.tenantId)return Zt(new $r("tenant-id-mismatch"));var e=this,n={};n.apiKey=Ah(this).options.apiKey,n.authDomain=Ah(this).options.authDomain,n.appName=Ah(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var i=t.b,o={};return o[La]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-S())/1e3,e=new Mc(e,o),n&&(e.da=n),r&&xc(e,r),Xc(e,t),e}(t,n,e.w,e.Ca());return _h(this,this.i.then((function(){if(Ah(e).options.apiKey!=t.l)return r.reload()})).then((function(){return Ch(e)&&t.uid==Ch(e).uid?(Xc(Ch(e),t),e.aa(t)):(Sh(e,r),jc(r),e.aa(r))})).then((function(){kh(e)})))},t.pb=function(){var t=this;return _h(this,this.i.then((function(){return t.a&&yc(t.a.b),Ch(t)?(Sh(t,null),mh(t.h).then((function(){kh(t)}))):$t()})))},t.Nc=function(){var t=this;return gh(this.h,Ah(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=Ch(t)&&e){n=Ch(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Xc(Ch(t),e),Ch(t).G();(Ch(t)||e)&&(Sh(t,e),e&&(jc(e),e.da=t.w),t.a&&oc(t.a,t),kh(t))}}))},t.aa=function(t){return dh(this.h,t)},t.bc=function(){kh(this),this.aa(Ch(this))},t.mc=function(){this.pb()},t.nc=function(){this.pb()},t.oc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(Ch(e))}))},t.pc=function(t){var e=this;!function(t,e){t.J.push(e),_h(t,t.i.then((function(){!t.l&&q(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Dh(t)))})))}(this,(function(){t.next(Ch(e))}))},t.xc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){g(t)?t(Ch(r)):g(t.next)&&t.next(Ch(r))})),this.Ub(t,e,n)},t.wc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){r.W=r.getUid(),g(t)?t(Ch(r)):g(t.next)&&t.next(Ch(r))})),this.Vb(t,e,n)},t.cc=function(t){var e=this;return _h(this,this.i.then((function(){return Ch(e)?Ch(e).G(t).then((function(t){return{accessToken:t}})):null})))},t.Hc=function(t){var e=this;return this.i.then((function(){return Nh(e,ks(e.b,Ss,{token:t}))})).then((function(t){var n=t.user;return Yc(n,"isAnonymous",!1),e.aa(n),t}))},t.Ic=function(t,e){var n=this;return this.i.then((function(){return Nh(n,ks(n.b,Ns,{email:t,password:e}))}))},t.Xb=function(t,e){var n=this;return this.i.then((function(){return Nh(n,ks(n.b,is,{email:t,password:e}))}))},t.Sa=function(t){var e=this;return this.i.then((function(){return Nh(e,t.na(e.b))}))},t.Gc=function(t){return Ur("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},t.ob=function(){var t=this;return this.i.then((function(){var e=Ch(t);if(e&&e.isAnonymous){var n=qr({providerId:null,isNewUser:!1});return qr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Nh(t,t.b.ob()).then((function(e){var n=e.user;return Yc(n,"isAnonymous",!0),t.aa(n),e}))}))},t.getUid=function(){return Ch(this)&&Ch(this).uid||null},t.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&Ch(this)&&Fc(Ch(this))},t.Ec=function(t){var e=this;F(this.m,(function(n){n==t&&e.o--})),0>this.o&&(this.o=0),0==this.o&&Ch(this)&&Vc(Ch(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),_h(this,this.i.then((function(){e.l||q(e.m,t)&&t(Dh(e))})))},t.removeAuthTokenListener=function(t){z(this.m,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h).b.removeListener(ph("local"),t.a,this.ma),this.a&&(ac(this.a,this),yc(this.a.b)),Promise.resolve()},t.$b=function(t){return _h(this,function(t,e){return ks(t,os,{identifier:e,continueUri:Er()?tr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.b,t))},t.qc=function(t){return!!mo(t)},t.lb=function(t,e){var n=this;return _h(this,$t().then((function(){var t=new li(e);if(!t.c)throw new $r("argument-error",di+" must be true when sending sign in link to email");return Ti(t)})).then((function(e){return n.b.lb(t,e)})).then((function(){})))},t.Uc=function(t){return this.Ma(t).then((function(t){return t.data.email}))},t.ab=function(t,e){return _h(this,this.b.ab(t,e).then((function(){})))},t.Ma=function(t){return _h(this,this.b.Ma(t).then((function(t){return new zr(t)})))},t.Ya=function(t){return _h(this,this.b.Ya(t).then((function(){})))},t.kb=function(t,e){var n=this;return _h(this,$t().then((function(){return void 0===e||Q(e)?{}:Ti(new li(e))})).then((function(e){return n.b.kb(t,e)})).then((function(){})))},t.Kc=function(t,e){return _h(this,Ic(this,t,e,E(this.Sa,this)))},t.Jc=function(t,e){var n=this;return _h(this,$t().then((function(){var r=e||tr(),i=po(t,r);if(!(r=mo(r)))throw new $r("argument-error","Invalid email link!");if(r.tenantId!==n.R())throw new $r("tenant-id-mismatch");return n.Sa(i)})))},Rh.prototype.render=function(){},Rh.prototype.reset=function(){},Rh.prototype.getResponse=function(){},Rh.prototype.execute=function(){};var Mh=null;function Lh(t,e){return(e=xh(e))&&t.a[e]||null}function xh(t){return(t=void 0===t?1e12:t)?t.toString():null}function Ph(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=zn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Qe(this.f,"click",this.i)}function Uh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Fh(){}Oh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Ph(t,e),this.b++},Oh.prototype.reset=function(t){var e=Lh(this,t);t=xh(t),e&&t&&(e.delete(),delete this.a[t])},Oh.prototype.getResponse=function(t){return(t=Lh(this,t))?t.getResponse():null},Oh.prototype.execute=function(t){(t=Lh(this,t))&&t.execute()},Ph.prototype.getResponse=function(){return Uh(this),this.b},Ph.prototype.execute=function(){Uh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Ph.prototype.delete=function(){Uh(this),this.g=!0,clearTimeout(this.a),this.a=null,Xe(this.f,"click",this.i)},Fh.prototype.g=function(){return Mh||(Mh=new Oh),$t(Mh)},Fh.prototype.c=function(){};var Vh=null;function Bh(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var qh=new J(tt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),jh=new Rr(3e4,6e4);Bh.prototype.g=function(t){var e=this;return new Gt((function(n,r){var i=setTimeout((function(){r(new $r("network-request-failed"))}),jh.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new $r("internal-error"));delete a[e.a]},$t(Na(it(qh,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new $r("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(a.grecaptcha))}))},Bh.prototype.c=function(){this.b--};var zh=null;function Kh(t,e,n,r,i,o,s){if(Vr(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,s?(Vh||(Vh=new Fh),s=Vh):(zh||(zh=new Bh),s=zh),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Qh])throw new $r("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Hh],!a.document)throw new $r("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!zn(e)||!this.i&&zn(e).hasChildNodes())throw new $r("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Oa(t,o||null,i||null),this.v=r||function(){return null};var u=this;this.l=[];var c=this.a[Gh];this.a[Gh]=function(t){if(Yh(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=br(c,a);"function"==typeof e&&e(t)}};var h=this.a[Wh];this.a[Wh]=function(){if(Yh(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=br(h,a);"function"==typeof t&&t()}}}var Gh="callback",Wh="expired-callback",Qh="sitekey",Hh="size";function Yh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Xh(t,e){return t.h.push(e),e.ka((function(){j(t.h,e)})),e}function Jh(t){if(t.B)throw new $r("internal-error","RecaptchaVerifier instance has been destroyed.")}function $h(t,e,n){var r=!1;try{this.b=n||ot.app()}catch(t){throw new $r("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new $r("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ca()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=ot.SDK_VERSION?yr(ot.SDK_VERSION,o):null,Kh.call(this,n,t,e,(function(){try{var t=i.b.auth().ha()}catch(e){t=null}return t}),o,_i(Di),r)}function Zh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new $r("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].N(n[i])&&!o){if(e=e[i],0>i||i>=tl.length)throw new $r("internal-error","Argument validator received an unsupported number of arguments.");n=tl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}r=null}}if(r)throw new $r("argument-error",t+" failed: "+r)}(t=Kh.prototype).Da=function(){var t=this;return this.f?this.f:this.f=Xh(this,$t().then((function(){if(Er()&&!hr())return sr();throw new $r("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.v())})).then((function(e){return t.g=e,ks(t.o,ms,{})})).then((function(e){t.a[Qh]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},t.render=function(){Jh(this);var t=this;return Xh(this,this.Da().then((function(){if(null===t.c){var e=t.u;if(!t.i){var n=zn(e);e=Wn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Jh(this);var t=this;return Xh(this,this.render().then((function(e){return new Gt((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){z(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Jh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Jh(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=zn(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},N($h,Kh);var tl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function el(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:s}}function nl(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:u}}function rl(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:y}}function il(t,e){return{name:t||"",M:"a function",optional:!!e,N:g}}function ol(t,e){return{name:t||"",M:"null",optional:!!e,N:p}}function al(t){return{name:t?t+"Credential":"credential",M:t?"a valid "+t+" credential":"a valid credential",optional:!1,N:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.na||!n)}}}function sl(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&s(t.type)&&g(t.verify))}}}function ul(t,e,n,r){return{name:n||"",M:t.M+" or "+e.M,optional:!!r,N:function(n){return t.N(n)||e.N(n)}}}function cl(t,e){for(var n in e){var r=e[n].name;t[r]=fl(r,t[n],e[n].j)}}function hl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){Zh(t,[n],[r],!0),this[e]=r}),r,n,e[n].Za),enumerable:!0})}}function ll(t,e,n,r){t[e]=fl(e,n,r)}function fl(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Zh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}cl(vh.prototype,{Ya:{name:"applyActionCode",j:[el("code")]},Ma:{name:"checkActionCode",j:[el("code")]},ab:{name:"confirmPasswordReset",j:[el("code"),el("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[el("email"),el("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[el("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[el("emailLink")]},wc:{name:"onAuthStateChanged",j:[ul(rl(),il(),"nextOrObserver"),il("opt_error",!0),il("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[ul(rl(),il(),"nextOrObserver"),il("opt_error",!0),il("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[el("email"),ul(rl("opt_actionCodeSettings",!0),ol(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[el("email"),rl("actionCodeSettings")]},mb:{name:"setPersistence",j:[el("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[al()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[al()]},Hc:{name:"signInWithCustomToken",j:[el("token")]},Ic:{name:"signInWithEmailAndPassword",j:[el("email"),el("password")]},Jc:{name:"signInWithEmailLink",j:[el("email"),el("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[el("phoneNumber"),sl()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[ul({name:"user",M:"an instance of Firebase User",optional:!1,N:function(t){return!!(t&&t instanceof Mc)}},ol(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[el(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[el("code")]}}),hl(vh.prototype,{lc:{name:"languageCode",Za:ul(el(),ol(),"languageCode")},ti:{name:"tenantId",Za:ul(el(),ol(),"tenantId")}}),vh.Persistence=Su,vh.Persistence.LOCAL="local",vh.Persistence.SESSION="session",vh.Persistence.NONE="none",cl(Mc.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[nl("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[nl("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[al()]},fb:{name:"linkWithCredential",j:[al()]},sc:{name:"linkWithPhoneNumber",j:[el("phoneNumber"),sl()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[al()]},hb:{name:"reauthenticateWithCredential",j:[al()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[el("phoneNumber"),sl()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[ul(rl("opt_actionCodeSettings",!0),ol(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[el(null,!0)]},Qc:{name:"unlink",j:[el("provider")]},rb:{name:"updateEmail",j:[el("email")]},sb:{name:"updatePassword",j:[el("password")]},Sc:{name:"updatePhoneNumber",j:[al("phone")]},tb:{name:"updateProfile",j:[rl("profile")]}}),cl(Oh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),cl(Rh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),cl(Gt.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),hl(Tc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:nl("appVerificationDisabledForTesting")}}),cl(Ec.prototype,{confirm:{name:"confirm",j:[el("verificationCode")]}}),ll(Gi,"fromJSON",(function(t){t=s(t)?JSON.parse(t):t;for(var e,n=[$i,lo,yo,Yi],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[ul(el(),rl(),"json")]),ll(fo,"credential",(function(t,e){return new ho(t,e)}),[el("email"),el("password")]),cl(ho.prototype,{A:{name:"toJSON",j:[el(null,!0)]}}),cl(no.prototype,{ya:{name:"addScope",j:[el("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),ll(no,"credential",ro,[ul(el(),rl(),"token")]),ll(fo,"credentialWithLink",po,[el("email"),el("emailLink")]),cl(io.prototype,{ya:{name:"addScope",j:[el("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),ll(io,"credential",oo,[ul(el(),rl(),"token")]),cl(ao.prototype,{ya:{name:"addScope",j:[el("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),ll(ao,"credential",so,[ul(el(),ul(rl(),ol()),"idToken"),ul(el(),ol(),"accessToken",!0)]),cl(uo.prototype,{Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),ll(uo,"credential",co,[ul(el(),rl(),"token"),el("secret",!0)]),cl(eo.prototype,{ya:{name:"addScope",j:[el("scope")]},credential:{name:"credential",j:[ul(el(),ul(rl(),ol()),"optionsOrIdToken"),ul(el(),ol(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),cl(Xi.prototype,{A:{name:"toJSON",j:[el(null,!0)]}}),cl(Qi.prototype,{A:{name:"toJSON",j:[el(null,!0)]}}),ll(bo,"credential",wo,[el("verificationId"),el("verificationCode")]),cl(bo.prototype,{Wa:{name:"verifyPhoneNumber",j:[el("phoneNumber"),sl()]}}),cl(go.prototype,{A:{name:"toJSON",j:[el(null,!0)]}}),cl($r.prototype,{toJSON:{name:"toJSON",j:[el(null,!0)]}}),cl(ko.prototype,{toJSON:{name:"toJSON",j:[el(null,!0)]}}),cl(Do.prototype,{toJSON:{name:"toJSON",j:[el(null,!0)]}}),cl($h.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),ll(ni,"parseLink",hi,[el("link")]),function(){if(void 0===ot||!ot.INTERNAL||!ot.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Kr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:vh,AuthCredential:Gi,Error:$r};ll(t,"EmailAuthProvider",fo,[]),ll(t,"FacebookAuthProvider",no,[]),ll(t,"GithubAuthProvider",io,[]),ll(t,"GoogleAuthProvider",ao,[]),ll(t,"TwitterAuthProvider",uo,[]),ll(t,"OAuthProvider",eo,[el("providerId")]),ll(t,"SAMLAuthProvider",to,[el("providerId")]),ll(t,"PhoneAuthProvider",bo,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof vh)}}]),ll(t,"RecaptchaVerifier",$h,[ul(el(),{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),rl("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof ot.app.App)}}]),ll(t,"ActionCodeURL",ni,[]),ot.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new vh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),ot.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:E((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:E(t.cc,t),addAuthTokenListener:E(t.Wb,t),removeAuthTokenListener:E(t.Ec,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),ot.registerVersion("@firebase/auth","0.13.3"),ot.INTERNAL.extendNamespace({User:Mc})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _l=n(19),Rl=n(21),Ol=st.auth();Ol.onAuthStateChanged((function(t){return t?t.getIdTokenResult().then(Pl).then((function(t){return _l.a.dispatch({type:Rl.a,user:t})})):_l.a.dispatch({type:Rl.b})}));var Ml=new r.auth.GoogleAuthProvider,Ll=function(){return Ol.signInWithPopup(Ml)},xl=function(){return Ol.signOut()};function Pl(t){return{displayName:Ol.currentUser.displayName,photoURL:Ol.currentUser.photoURL,email:Ol.currentUser.email,uid:Ol.currentUser.uid,isStaff:(null==t?void 0:t.claims.staff)||!1,isAdmin:(null==t?void 0:t.claims.admin)||!1}}var Ul="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MzMuNSA1NDQuMyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTMzLjUgNTQ0LjM7IiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7ZmlsbDojNDI4NUY0O30gLnN0MXtmaWxsOiMzNEE4NTM7fSAuc3Qye2ZpbGw6I0ZCQkMwNDt9IC5zdDN7ZmlsbDojRUE0MzM1O308L3N0eWxlPjxtZXRhZGF0YT48c2Z3PjxzbGljZXM+PC9zbGljZXM+PHNsaWNlU291cmNlQm91bmRzICBib3R0b21MZWZ0T3JpZ2luPSJ0cnVlIiBoZWlnaHQ9IjU0NC4zIiB3aWR0aD0iNTMzLjUiIHg9IjAuMSIgeT0iMTEwLjEiPjwvc2xpY2VTb3VyY2VCb3VuZHM+PC9zZnc+PC9tZXRhZGF0YT48Zz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNTMzLjUsMjc4LjRjMC0xOC41LTEuNS0zNy4xLTQuNy01NS4zSDI3Mi4xdjEwNC44aDE0N2MtNi4xLDMzLjgtMjUuNyw2My43LTU0LjQsODIuN3Y2OGg4Ny43IEM1MDMuOSw0MzEuMiw1MzMuNSwzNjEuMiw1MzMuNSwyNzguNHoiLz48cGF0aCBjbGFzcz0ic3QxIiBkPSJNMjcyLjEsNTQ0LjNjNzMuNCwwLDEzNS4zLTI0LjEsMTgwLjQtNjUuN2wtODcuNy02OGMtMjQuNCwxNi42LTU1LjksMjYtOTIuNiwyNmMtNzEsMC0xMzEuMi00Ny45LTE1Mi44LTExMi4zIEgyOC45djcwLjFDNzUuMSw0ODYuMywxNjkuMiw1NDQuMywyNzIuMSw1NDQuM3oiLz48cGF0aCBjbGFzcz0ic3QyIiBkPSJNMTE5LjMsMzI0LjNjLTExLjQtMzMuOC0xMS40LTcwLjQsMC0xMDQuMlYxNTBIMjguOWMtMzguNiw3Ni45LTM4LjYsMTY3LjUsMCwyNDQuNEwxMTkuMywzMjQuM3oiLz48cGF0aCBjbGFzcz0ic3QzIiBkPSJNMjcyLjEsMTA3LjdjMzguOC0wLjYsNzYuMywxNCwxMDQuNCw0MC44bDAsMGw3Ny43LTc3LjdDNDA1LDI0LjYsMzM5LjctMC44LDI3Mi4xLDBDMTY5LjIsMCw3NS4xLDU4LDI4LjksMTUwIGw5MC40LDcwLjFDMTQwLjgsMTU1LjYsMjAxLjEsMTA3LjcsMjcyLjEsMTA3Ljd6Ii8+PC9nPjwvc3ZnPgo=",Fl=n(50),Vl=n.n(Fl);function Bl(){var t=Object(a.b)((function(t){return t.auth.user}));return null==t?Object(i.h)("div",null,Object(i.h)("div",{class:"text"},Object(i.h)("span",null,"Hey, welcome random stranger."),Object(i.h)("br",null),Object(i.h)("span",null,"You aren't suppose to be here"),Object(i.h)("br",null),Object(i.h)("span",null,"BUT if you wanna continue you need to login first."),Object(i.h)("br",null)),Object(i.h)("button",{class:Vl.a.loginBtn,onClick:Ll},Object(i.h)("img",{src:Ul}),Object(i.h)("span",null,"Sign in with Google"))):Object(i.h)("div",{class:"text"},Object(i.h)("div",null,"Editor"),t.isAdmin?Object(i.h)("div",null,Object(i.h)("button",{onClick:function(){return Object(o.route)("/editor/".concat(kl()))}},"Create new a Blog")):Object(i.h)("div",null,":( Too bad you not an admin."),Object(i.h)("button",{onClick:xl},"Sign out"))}n.d(e,"default",(function(){return Bl})),s.setOptions({gfm:!0,highlight:function(t,e){return Object(u.highlightAuto)(t,e).value},smartLists:!0,smartypants:!0})}};